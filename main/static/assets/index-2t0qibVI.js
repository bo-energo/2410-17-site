import{r as i,d as rt,u as B,b as v,j as e,B as o,I as it,n as $,Y as Gs,a6 as Bs,z as Y,a7 as ct,a8 as Fs,a9 as ze,aa as dt,ab as Yt,N as ut,ac as Ke,ad as qe,ae as Xe,af as Ns,ag as Zs,ah as Us,ai as Qs,aj as Ws,L as Pe,ak as Vs,T as ue,m as Ce,k as ae,l as Jt,al as Ys,am as Js,an as Ks,ao as Kt,ap as qs,aq as et,ar as yt,as as Ue,e as Oe,at as vt,f as ie,C as wt,H as se,S as qt,c as Xs,a as ea,Z as I,au as tt,i as Xt,av as ta,O as sa,M as es,aw as aa,y as na,E as la,K as oa,ax as ra,ay as ia,az as re,a5 as ca,aA as da,aB as ua,aC as ha,aD as ga,aE as fa,aF as xa,aG as ba,aH as ma}from"./vendor-Dg9ap9Na.js";import{s as A,f as _,g as ts,F as R,T as F,a as Me,d as pa,w as ya,b as Ye,c as ss,e as _e,h as je,i as as,j as ns,k as ot,l as va,m as ce,G as O,n as M,C as wa,o as ja,p as De,I as de,q as J,B as ke,r as ls,t as ht,u as os,L as z,S as rs,v as is,x as Ta,y as Ca,D as cs,z as Sa,A as La,E as Ge,H as Da,J as Be,K as za,M as ds,N as gt,O as ka,V as us,P as he,Q as Ea,R as Ra,U as hs,W as Ha,X as Ia,Y as Ma,Z as Aa,_ as _a,$ as Pa,a0 as gs,a1 as $a,a2 as Je,a3 as fs,a4 as Oa,a5 as ft,a6 as xt,a7 as Qe,a8 as $e,a9 as xs,aa as bs,ab as ms,ac as ps,ad as ys,ae as vs,af as ws,ag as js,ah as Ts,ai as Cs,aj as Ss,ak as Ls,al as Ds,am as zs,an as ks,ao as Ga,ap as Ba,aq as Fa,ar as Na,as as Za,at as Ua,au as Qa,av as Wa,aw as Va,ax as Ya,ay as Ja,az as Ka,aA as qa,aB as Xa,aC as en,aD as tn,aE as sn,aF as an,aG as nn,aH as ln,aI as on,aJ as rn,aK as K,aL as Ee,aM as ge,aN as Re,aO as fe,aP as cn,aQ as dn,aR as un,aS as hn,aT as gn,aU as fn,aV as xn,aW as bn,aX as mn,aY as pn,aZ as yn,a_ as vn,a$ as wn,b0 as jn,b1 as Tn,b2 as Cn,b3 as Sn,b4 as Ln,b5 as Dn,b6 as zn,b7 as kn,b8 as jt,b9 as st,ba as En,bb as Rn,bc as Hn,bd as Tt,be as Ct,bf as In,bg as Mn,bh as An,bi as _n,bj as Pn,bk as $n,bl as St,bm as Lt,bn as On,bo as Gn,bp as Bn,bq as Dt,br as zt,bs as Fn,bt as Nn,bu as Zn,bv as kt,bw as Et,bx as Un,by as Qn,bz as Wn,bA as Rt,bB as Ht,bC as Vn,bD as Yn,bE as Jn,bF as It,bG as Mt,bH as Kn,bI as qn,bJ as Xn,bK as At,bL as _t,bM as el,bN as tl,bO as sl,bP as al,bQ as nl,bR as ll,bS as Pt,bT as $t,bU as ol,bV as rl,bW as il,bX as Ot,bY as Gt,bZ as cl,b_ as dl,b$ as ul,c0 as Bt,c1 as Ft,c2 as hl,c3 as Es,c4 as gl,c5 as Nt,c6 as Rs,c7 as Hs,c8 as Is,c9 as Ae,ca as Zt,cb as fl,cc as xl,cd as bl,ce as ml,cf as pl,cg as yl,ch as vl,ci as wl,cj as jl,ck as Tl,cl as Cl,cm as Sl,cn as Ll,co as Dl,cp as zl,cq as kl,cr as El,cs as Rl,ct as Hl,cu as Il,cv as Ml,cw as Al,cx as _l,cy as Pl,cz as $l,cA as Ol,cB as Gl,cC as Bl,cD as Fl,cE as Nl,cF as Zl,cG as Ul,cH as Ql,cI as Wl,cJ as Vl,cK as Yl}from"./components-z-RTrsFf.js";(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))g(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&g(c)}).observe(document,{childList:!0,subtree:!0});function a(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function g(t){if(t.ep)return;t.ep=!0;const r=a(t);fetch(t.href,r)}})();const Jl="_box_eda9k_1",Kl="_wobble_eda9k_1",ql="_cardContent_eda9k_11",Xl="_cardAnim_eda9k_1",Ut={box:Jl,wobble:Kl,cardContent:ql,cardAnim:Xl},eo=({item:s,index:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const x=window.matchMedia(A);return x.addEventListener("change",j=>_(g,j.matches)),()=>x.removeEventListener("change",_)},[]);const t=rt(),r=B(),c=v(ts),[b,p]=i.useState(null);i.useLayoutEffect(()=>{setTimeout(()=>{p(e.jsx(o,{sx:{margin:"1%",padding:"2px",border:"2px solid #003274",borderRadius:"5px",boxShadow:"2px 2px 2px gray",...R,fontSize:a?"0.8em":"1.1em","&:hover":{transform:"scale(1.01)",...F,cursor:"pointer"},"&:active":{transform:"scale(0.99)",boxShadow:"0px 0px 0px gray",...F}},className:Ut.box,onClick:()=>l(s),children:e.jsxs(o,{className:Ut.cardContent,children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(it,{src:s.level===Me.dangerousTitle?pa:ya,width:20,height:20}),e.jsxs(o,{children:[s.asset," ",s.substation]})]}),e.jsx(o,{children:s.date.replace("T"," ").replace("Z","").split(".")[0]}),e.jsx(o,{children:s.msg})]})},$()))},u*150)},[]);const l=x=>{r(Ye({asset:x.asset,elementId:x.asset_id,elementType:x.asset_type,substId:x.substId}));const j=c.find(n=>n.id===x.substId);r(ss({assets:j.assets,subst_id:j.id,name:j.name})),r(_e(x.id_tab)),r(je("charts")),r(as(x.signals)),r(ns(`${new Date(x.date).addHours(4).toLocaleDateString().split(".").reverse().join("-")}T${new Date(x.date).addHours(4).toLocaleTimeString()}`)),r(ot(`${new Date(x.date).addHours(-4).toLocaleDateString().split(".").reverse().join("-")}T${new Date(x.date).addHours(-4).toLocaleTimeString()}`)),t(`/substation/${x.substId}/${x.asset_type}/${x.asset_id}/charts`)};return e.jsx(e.Fragment,{children:b})},to=({height:s})=>{const[u,a]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const n=window.matchMedia(A);return n.addEventListener("change",w=>_(a,w.matches)),()=>n.removeEventListener("change",_)},[]);const g=i.useRef(),t=94,r=v(va),c=v(ce),b=v(O),[p,l]=i.useState(),[x,j]=i.useState();if(i.useEffect(()=>{try{if(r){let n=r.map((w,C)=>e.jsx(eo,{item:w,index:C},$()));l(n),j(n.length)}}catch(n){console.log("EVENTS ERROR"),console.log(n)}},[r,c]),b)return e.jsxs(o,{ref:g,sx:{width:"100%",height:"100%",color:"#003274"},children:[e.jsxs(o,{sx:{...M,fontSize:u?"0.9em":"1.2em",display:"flex",alignItems:"center"},children:[b.eventsLabel,e.jsx(Gs,{color:"gray",variant:"filled",styles:{root:{margin:"5px",border:"50%"}},children:x})]}),e.jsx(Bs,{h:s/100*t,children:e.jsx(o,{sx:{marginRight:"2%"},children:p})})]})},bt=()=>{const[s,u]=i.useState(window.matchMedia("(min-height:600px) and (max-height:900px)").matches);return i.useEffect(()=>{const a=window.matchMedia("(min-height:600px) and (max-height:900px)"),g=t=>u(t);return a.addEventListener("change",t=>g(t.matches)),()=>{a.removeEventListener("change",g)}},[]),s?"md":"lg"},so=i.memo(()=>{const s=v(O),u=bt(),a=i.useMemo(()=>{const g=[];return wa.forEach(t=>{g.push(e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(o,{sx:{width:u=="md"?"10px":"18px",height:u=="md"?"10px":"18px",background:t.color}}),e.jsx(o,{sx:{...R,marginLeft:"5px",fontSize:u=="md"?"0.6em":"0.9em"},children:t.impotantLevel})]},$()))}),g},[]);return e.jsxs(o,{sx:{...F},children:[e.jsx(o,{sx:{...M,fontSize:u=="md"?"0.8em":"1em"},children:s.importanceLevelsLabel}),a]})}),ao=i.memo(()=>{const s=bt(),u=v(ja),a=v(O),g=i.useMemo(()=>{try{if(u)return Object.keys(u).map(r=>e.jsxs(o,{sx:{fontSize:s=="md"?"0.6em":"0.9em",...R},children:[r," - ",u[r].length]},$()))}catch(t){console.log("ERROR INFO MAP"),console.log(t)}},[u]);return e.jsxs(o,{sx:{color:"#003274",fontSize:"1em"},children:[e.jsx(o,{sx:{...M,fontSize:s=="md"?"0.8em":"1em"},children:a.totalLabel}),g]})}),no=()=>{const s=bt(),u=v(ce),a=v(O),g=v(ts),[t,r]=i.useState(),[c,b]=i.useState();if(i.useEffect(()=>{try{let x=[];if(g){const j=g.map(n=>n.assets).flat();x.push({name:"Dangerous",count:j.filter(n=>n.status==Me.dangerousTitle).length,color:De.dangerousColor}),x.push({name:"Warning",count:j.filter(n=>n.status==Me.warningTitle).length,color:De.warningColor}),x.push({name:"Good",count:j.filter(n=>n.status==Me.goodTitle).length,color:De.goodColor}),x.push({name:"Undefined",count:j.filter(n=>n.status==Me.undefinedTitle).length,color:De.undefinedColor}),x=x.filter(n=>n.count!=0)}var p=[{values:x.map(j=>j.count),labels:x.map(j=>j.name),domain:{column:0},name:"",hole:.4,type:"pie",marker:{colors:x.map(j=>j.color)},textinfo:"value",hoverinfo:"none"}],l={height:s=="md"?100:150,width:s=="md"?200:300,showlegend:!1,margin:{t:0,r:0,b:0,l:0}};b(p),r(l)}catch(x){console.log("INFO MAP ERROR"),console.log(x)}},[g,u]),a)return e.jsxs(o,{sx:{marginLeft:"1%",display:"flex",height:"100%"},children:[e.jsx(so,{}),e.jsxs(o,{sx:{textAlign:"center",...M,...F,fontSize:s=="md"?"0.8em":"1em"},children:[e.jsx(o,{children:a==null?void 0:a.currentStateLabel}),e.jsx(Y,{data:structuredClone(c),layout:structuredClone(t),config:{displayModeBar:!1,scrollZoom:!1,scale:1,displaylogo:!1}})]}),e.jsx(ao,{})]})},lo="data:image/svg+xml,%3csvg%20width='512'%20height='512'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3ctitle%3eLayer%201%3c/title%3e%3cpath%20stroke='%23000'%20fill='rgba(1,%2050,%2032,%200.8)'%20d='m256.00001,3c-90.84788,0%20-164.50002,66.44962%20-164.50002,148.4134c0,81.98356%20164.50002,358.58655%20164.50002,358.58655s164.50002,-276.60299%20164.50002,-358.58655c0,-81.96377%20-73.63021,-148.4134%20-164.50002,-148.4134zm0,219.33521c-43.40608,0%20-78.60908,-31.74068%20-78.60908,-70.92181s35.203,-70.92181%2078.60908,-70.92181s78.60908,31.76047%2078.60908,70.92181s-35.203,70.92181%20-78.60908,70.92181z'%20id='svg_1'%20stroke-width='2'/%3e%3c/g%3e%3c/svg%3e",oo="data:image/svg+xml,%3csvg%20width='512'%20height='512'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3ctitle%3eLayer%201%3c/title%3e%3cpath%20stroke='%23000'%20fill='rgba(0,%20128,%200,%200.8)'%20d='m256.00001,3c-90.84788,0%20-164.50002,66.44962%20-164.50002,148.4134c0,81.98356%20164.50002,358.58655%20164.50002,358.58655s164.50002,-276.60299%20164.50002,-358.58655c0,-81.96377%20-73.63021,-148.4134%20-164.50002,-148.4134zm0,219.33521c-43.40608,0%20-78.60908,-31.74068%20-78.60908,-70.92181s35.203,-70.92181%2078.60908,-70.92181s78.60908,31.76047%2078.60908,70.92181s-35.203,70.92181%20-78.60908,70.92181z'%20id='svg_1'%20stroke-width='2'/%3e%3c/g%3e%3c/svg%3e",ro="data:image/svg+xml,%3csvg%20width='512'%20height='512'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3ctitle%3eLayer%201%3c/title%3e%3cpath%20stroke='%23000'%20fill='rgba(144,%20238,%20144,%200.8)'%20d='m256.00001,3c-90.84788,0%20-164.50002,66.44962%20-164.50002,148.4134c0,81.98356%20164.50002,358.58655%20164.50002,358.58655s164.50002,-276.60299%20164.50002,-358.58655c0,-81.96377%20-73.63021,-148.4134%20-164.50002,-148.4134zm0,219.33521c-43.40608,0%20-78.60908,-31.74068%20-78.60908,-70.92181s35.203,-70.92181%2078.60908,-70.92181s78.60908,31.76047%2078.60908,70.92181s-35.203,70.92181%20-78.60908,70.92181z'%20id='svg_1'%20stroke-width='2'/%3e%3c/g%3e%3c/svg%3e",io="data:image/svg+xml,%3csvg%20width='512'%20height='512'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3ctitle%3eLayer%201%3c/title%3e%3cpath%20stroke='%23000'%20fill='rgba(255,%20255,%200,%200.8)'%20d='m256.00001,3c-90.84788,0%20-164.50002,66.44962%20-164.50002,148.4134c0,81.98356%20164.50002,358.58655%20164.50002,358.58655s164.50002,-276.60299%20164.50002,-358.58655c0,-81.96377%20-73.63021,-148.4134%20-164.50002,-148.4134zm0,219.33521c-43.40608,0%20-78.60908,-31.74068%20-78.60908,-70.92181s35.203,-70.92181%2078.60908,-70.92181s78.60908,31.76047%2078.60908,70.92181s-35.203,70.92181%20-78.60908,70.92181z'%20id='svg_1'%20stroke-width='2'/%3e%3c/g%3e%3c/svg%3e",co="data:image/svg+xml,%3csvg%20width='512'%20height='512'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3ctitle%3eLayer%201%3c/title%3e%3cpath%20stroke='%23000'%20fill='rgba(255,%20187,%2015,%200.8)'%20d='m256.00001,3c-90.84788,0%20-164.50002,66.44962%20-164.50002,148.4134c0,81.98356%20164.50002,358.58655%20164.50002,358.58655s164.50002,-276.60299%20164.50002,-358.58655c0,-81.96377%20-73.63021,-148.4134%20-164.50002,-148.4134zm0,219.33521c-43.40608,0%20-78.60908,-31.74068%20-78.60908,-70.92181s35.203,-70.92181%2078.60908,-70.92181s78.60908,31.76047%2078.60908,70.92181s-35.203,70.92181%20-78.60908,70.92181z'%20id='svg_1'%20stroke-width='2'/%3e%3c/g%3e%3c/svg%3e",uo="data:image/svg+xml,%3csvg%20width='512'%20height='512'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3ctitle%3eLayer%201%3c/title%3e%3cpath%20stroke='%23000'%20fill='rgba(255,%20165,%200,%200.8)'%20d='m256.00001,3c-90.84788,0%20-164.50002,66.44962%20-164.50002,148.4134c0,81.98356%20164.50002,358.58655%20164.50002,358.58655s164.50002,-276.60299%20164.50002,-358.58655c0,-81.96377%20-73.63021,-148.4134%20-164.50002,-148.4134zm0,219.33521c-43.40608,0%20-78.60908,-31.74068%20-78.60908,-70.92181s35.203,-70.92181%2078.60908,-70.92181s78.60908,31.76047%2078.60908,70.92181s-35.203,70.92181%20-78.60908,70.92181z'%20id='svg_1'%20stroke-width='2'/%3e%3c/g%3e%3c/svg%3e",ho="data:image/svg+xml,%3csvg%20width='512'%20height='512'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3ctitle%3eLayer%201%3c/title%3e%3cpath%20stroke='%23000'%20fill='rgba(255,%20104,%200,%200.8)'%20d='m256.00001,3c-90.84788,0%20-164.50002,66.44962%20-164.50002,148.4134c0,81.98356%20164.50002,358.58655%20164.50002,358.58655s164.50002,-276.60299%20164.50002,-358.58655c0,-81.96377%20-73.63021,-148.4134%20-164.50002,-148.4134zm0,219.33521c-43.40608,0%20-78.60908,-31.74068%20-78.60908,-70.92181s35.203,-70.92181%2078.60908,-70.92181s78.60908,31.76047%2078.60908,70.92181s-35.203,70.92181%20-78.60908,70.92181z'%20id='svg_1'%20stroke-width='2'/%3e%3c/g%3e%3c/svg%3e",go="data:image/svg+xml,%3csvg%20width='512'%20height='512'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3ctitle%3eLayer%201%3c/title%3e%3cpath%20stroke='%23000'%20fill='rgba(222,%2049,%2099,%200.8)'%20d='m256.00001,3c-90.84788,0%20-164.50002,66.44962%20-164.50002,148.4134c0,81.98356%20164.50002,358.58655%20164.50002,358.58655s164.50002,-276.60299%20164.50002,-358.58655c0,-81.96377%20-73.63021,-148.4134%20-164.50002,-148.4134zm0,219.33521c-43.40608,0%20-78.60908,-31.74068%20-78.60908,-70.92181s35.203,-70.92181%2078.60908,-70.92181s78.60908,31.76047%2078.60908,70.92181s-35.203,70.92181%20-78.60908,70.92181z'%20id='svg_1'%20stroke-width='2'/%3e%3c/g%3e%3c/svg%3e",fo="data:image/svg+xml,%3csvg%20width='512'%20height='512'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3ctitle%3eLayer%201%3c/title%3e%3cpath%20stroke='%23000'%20fill='rgba(255,%2036,%200,%200.8)'%20d='m256.00001,3c-90.84788,0%20-164.50002,66.44962%20-164.50002,148.4134c0,81.98356%20164.50002,358.58655%20164.50002,358.58655s164.50002,-276.60299%20164.50002,-358.58655c0,-81.96377%20-73.63021,-148.4134%20-164.50002,-148.4134zm0,219.33521c-43.40608,0%20-78.60908,-31.74068%20-78.60908,-70.92181s35.203,-70.92181%2078.60908,-70.92181s78.60908,31.76047%2078.60908,70.92181s-35.203,70.92181%20-78.60908,70.92181z'%20id='svg_1'%20stroke-width='2'/%3e%3c/g%3e%3c/svg%3e",xo="data:image/svg+xml,%3csvg%20width='512'%20height='512'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3ctitle%3eLayer%201%3c/title%3e%3cpath%20stroke='%23000'%20fill='rgba(155,%2045,%2048,%200.8)'%20d='m256.00001,3c-90.84788,0%20-164.50002,66.44962%20-164.50002,148.4134c0,81.98356%20164.50002,358.58655%20164.50002,358.58655s164.50002,-276.60299%20164.50002,-358.58655c0,-81.96377%20-73.63021,-148.4134%20-164.50002,-148.4134zm0,219.33521c-43.40608,0%20-78.60908,-31.74068%20-78.60908,-70.92181s35.203,-70.92181%2078.60908,-70.92181s78.60908,31.76047%2078.60908,70.92181s-35.203,70.92181%20-78.60908,70.92181z'%20id='svg_1'%20stroke-width='2'/%3e%3c/g%3e%3c/svg%3e",bo=s=>new ct({fill:new Fs({color:"#dbdbdb"}),stroke:new ze({color:"black",width:2}),text:new dt({font:"18px Inter-Regular",justify:"center",color:"white",text:`${(s==null?void 0:s.get("name"))??""}`,stroke:new ze({color:"black",width:.5})})}),mo=(s,u)=>{var t;const a=Ms(s==null?void 0:s.get("position")),g=((t=We.find(r=>(s==null?void 0:s.get("status"))<=r.max&&(s==null?void 0:s.get("status"))>=r.min))==null?void 0:t.icon)??We[0].icon;return new ct({stroke:new ze({color:"rgba(18, 55, 204, 0.26)",width:4}),text:new dt({font:"18px Inter-Regular",justify:"center",color:"white",offsetX:a.x,offsetY:a.y,text:(s==null?void 0:s.get("always_show"))=="true"?`${(s==null?void 0:s.get("name"))??"-"}`:u<550?`${(s==null?void 0:s.get("name"))??"-"}`:"",stroke:new ze({color:"black",width:.5})}),image:new Yt({src:g,anchor:[.5,1],scale:.08})})},po=(s,u)=>{var t;const a=((t=We.find(r=>(s==null?void 0:s.get("status"))<=r.max&&(s==null?void 0:s.get("status"))>=r.min))==null?void 0:t.icon)??We[0].icon,g=Ms(s==null?void 0:s.get("position"));return new ct({stroke:new ze({color:"rgba(18, 55, 204, 0.26)",width:4}),text:new dt({font:"18px Inter-Regular",justify:"center",color:"white",offsetX:g.x,offsetY:g.y,text:(s==null?void 0:s.get("always_show"))=="true"?`${(s==null?void 0:s.get("name"))??"-"}`:u<550?`${(s==null?void 0:s.get("name"))??"-"}`:"",stroke:new ze({color:"black",width:.5})}),image:new Yt({src:a,anchor:[.5,1],scale:.09})})},Ms=s=>{switch(s){case"top":return{y:-30,x:0};case"top-right":return{y:-10,x:50};case"bottom":return{y:35,x:0};case"right":return{y:0,x:40};case"left":return{y:0,x:-35};default:return{x:0,y:0}}},We=[{max:100,min:91,name:"Dark green",color:"rgba(1, 50, 32, 0.8)",icon:lo},{max:90,min:81,name:"Green",color:"rgba(0, 128, 0, 0.8)",icon:oo},{max:80,min:71,name:"Light green",color:"rgba(144, 238, 144, 0.8)",icon:ro},{max:70,min:61,name:"Light yellow",color:"rgba(255, 255, 0, 0.8)",icon:io},{max:60,min:51,name:"Yellow",color:"rgba(255, 187, 15, 0.8)",icon:co},{max:50,min:41,name:"Orange",color:"rgba(255, 165, 0, 0.8)",icon:uo},{max:40,min:31,name:"Light orange",color:"rgba(255, 104, 0, 0.8)",icon:ho},{max:30,min:21,name:"Light cherry",color:"rgba(222, 49, 99, 0.8)",icon:go},{max:20,min:11,name:"Crimson",color:"rgba(255, 36, 0, 0.8)",icon:fo},{max:10,min:1,name:"Maroon",color:"rgba(155, 45, 48, 0.8)",icon:xo}],yo=({RefPopup:s,PopupParams:u})=>{var b;const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const p=window.matchMedia(A);return p.addEventListener("change",l=>_(g,l.matches)),()=>p.removeEventListener("change",_)},[]);const t=v(O);let r=[],c={};if(u!=null){c={annotations:[{font:{size:12},showarrow:!1,text:((b=u.assets)==null?void 0:b.length)??0,x:.5,y:.5}],height:100,width:100,showlegend:!1,margin:{t:0,r:0,b:0,l:0}};let p=null;u.assets!==null&&u.assets!==void 0&&(p=[{title:"Dangerous",count:u.assets.filter(l=>l.status==="Dangerous").length,color:de.find(l=>l.title==="Dangerous").color},{title:"Warning",count:u.assets.filter(l=>l.status==="Warning").length,color:de.find(l=>l.title==="Warning").color},{title:"Good",count:u.assets.filter(l=>l.status==="Good").length,color:de.find(l=>l.title==="Good").color},{title:"Undefined",count:u.assets.filter(l=>l.status==="Undefined").length,color:de.find(l=>l.title==="Undefined").color}],r=[{values:p.map(l=>{if(l.count>0)return l.count}),labels:p.map(l=>{if(l.count>0)return l.title}),domain:{column:0},hoverinfo:"none",hole:.4,type:"pie",textinfo:"value",marker:{colors:p.map(l=>{if(l.count>0)return l.color})}}])}if(t)return e.jsx(o,{ref:s,sx:{border:"1px solid black",borderRadius:"5px",background:"white",marginLeft:"10px"},children:e.jsxs(o,{sx:{margin:"5px",textAlign:"center"},children:[e.jsx(o,{sx:{...M,fontSize:a?"0.9em":"1em",...F},children:u==null?void 0:u.name}),e.jsx(o,{children:r.length===0?e.jsx(o,{sx:{...M,fontSize:a?"0.9em":"1em",...F},children:t.notDataLabel}):e.jsx(Y,{useResizeHandler:!0,data:r,layout:c,config:J.GetConfig()})}),e.jsx(ut,{to:`substation/${u==null?void 0:u.subst_id}`,style:{...ke(a),...R,fontSize:a?"1em":"1.2em",color:"white",textDecoration:"none",borderRadius:"5px"},children:t.viewLabel})]})})},vo=({height:s,width:u,mapGeoJson:a,linesGeoJson:g,substGeoJson:t,settings:r})=>{const c=i.useRef(),b=v(O),[p,l]=i.useState(),x=i.useRef(),[j,n]=i.useState(),w=new Ke().readFeatures(a),C=new qe({title:"subjects",visible:!0,source:new Xe({features:w}),background:"transparent",style:bo}),y=new Ke().readFeatures(g),T=new qe({title:"powerLinesSubjects",visible:!0,source:new Xe({features:y}),background:"transparent"}),h=new Ke().readFeatures(t),m=new qe({title:"substation",visible:!0,source:new Xe({features:h}),background:"transparent",style:(f,d)=>mo(f,d)});return i.useEffect(()=>{try{const f=new Ns({element:c.current,autoPan:{animation:{duration:250}}}),d=new Zs({target:x.current,layers:[C,T,m],controls:[],overlays:[f],view:new Us({rotation:r.rotation,center:[r.center[0],r.center[1]],zoom:r.zoom,minZoom:r.min_zoom,maxZoom:r.max_zoom}),interactions:Qs().extend([new Ws({layers:[m],condition:function(D){return D.type==="pointermove"},style:(D,L)=>po(D,L)})])});d.on("singleclick",function(D){const L=d.getEventPixel(D.originalEvent),S=d.forEachFeatureAtPixel(L,function(Z,V){return{feature:Z,layer:V}});if(S!==void 0){if(S.layer.values_.title==="subjects")d.getView().fit(S.feature.getGeometry(),{duration:1e3}),f.setPosition(void 0);else if(S.layer.values_.title==="substation"){const Z=S.feature.getGeometry().getCoordinates();d.getView().animate({center:Z,duration:500,zoom:r.max_zoom}),f.get("position")?f.setPosition(void 0):setTimeout(()=>{const W=S.feature.getGeometry().getCoordinates();f.setPosition(W),l({assets:S.feature.values_.assets,subst_id:S.feature.values_.subst_id,name:S.feature.values_.name,countAsset:`${b.totalLabel} ${S.feature.values_.hasOwnProperty("assets")?S.feature.values_.assets.length:0}`})},500)}}else f.setPosition(void 0)}),n(d)}catch(f){console.log(f)}},[]),i.useEffect(()=>{j&&j.updateSize()},[s,u]),e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:x,className:"map-container",style:{height:`${s}px`}}),e.jsx(yo,{RefPopup:c,PopupParams:p})]})};function Fe(s){const[u,a]=i.useState(window.innerWidth),[g,t]=i.useState(window.innerHeight);i.useEffect(()=>(s!==null&&s.current!==null&&s.current.offsetWidth!==null&&(a(s.current.offsetWidth),t(s.current.offsetHeight),window.addEventListener("resize",r)),()=>window.removeEventListener("resize",r)),[s.current]);const r=()=>{a(s.current.offsetWidth),t(s.current.offsetHeight)};return{width:u,height:g}}const wo=()=>{const u=B(),a=v(ls),g=v(ce),t=v(O),[r,c]=i.useState(null),[b,p]=i.useState(null),[l,x]=i.useState(null),[j,n]=i.useState(null),[w,C]=i.useState(null),y=async()=>Vs("myDatabase",1,{upgrade(Z){Z.objectStoreNames.contains("items")||Z.createObjectStore("items",{keyPath:"id"})}}),T=async Z=>{await(await y()).put("items",Z)},h=async Z=>{await(await y()).delete("items",Z)},m=async()=>await(await y()).getAll("items"),f=Z=>{const V={id:"map",data:{areas:Z.data.find(W=>W.name=="Areas"),lines:Z.data.find(W=>W.name=="Lines"),substations:Z.data.find(W=>W.name=="Substations"),settings:Z.settings,hash:Z.hash}};T(V)},d=()=>{u(is()).unwrap().then(Z=>{m().then(V=>{let W=null;V.length!==0&&(W=V.find(U=>U.id==="map").data),u(Ta(V.length>0?{hash:W.hash}:"")).unwrap().then(U=>{var X,ee,k,N,E,P;if(U.status[0]==="Error"){C(U.status);return}if(V.length===0){f(U),n(U.settings),c((X=U.data)==null?void 0:X.find(G=>G.name=="Areas")),p((ee=U.data)==null?void 0:ee.find(G=>G.name=="Lines"));let Q=(k=U.data)==null?void 0:k.find(G=>G.name=="Substations");Z.substations.forEach(G=>{let H=Q.features.find(te=>te.properties.subst_id==G.id);H&&(H.properties={...H==null?void 0:H.properties,...G})}),x(Q)}else if(U.hash===W.hash){console.log("Hash Equal"),n(W.settings),c(W.areas),p(W.lines);let Q=W.substations;Z.substations.forEach(G=>{let H=Q.features.find(te=>te.properties.subst_id==G.id);H&&(H.properties={...H==null?void 0:H.properties,...G})}),x(Q)}else if(console.log("Hash Not equal"),h("map").catch(console.error),U.data.length>0){f(U),n(U.settings),c((N=U.data)==null?void 0:N.find(G=>G.name=="Areas")),p((E=U.data)==null?void 0:E.find(G=>G.name=="Lines"));let Q=(P=U.data)==null?void 0:P.find(G=>G.name=="Substations");Z.substations.forEach(G=>{let H=Q.features.find(te=>te.properties.subst_id==G.id);H&&(H.properties={...H==null?void 0:H.properties,...G})}),x(Q)}})})})};i.useEffect(()=>{d()},[g,u]);const D=v(ht);os(()=>{d()},D);const L=i.useRef(null),S=Fe(L);return a===z.loading?e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Pe,{color:"#003274"}),e.jsx(o,{sx:M,children:t.loadLabel})]})}):a===z.error?e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:e.jsx(o,{sx:{display:"flex",alignItems:"center"},children:e.jsx(o,{sx:M,children:"Ошибка загрузки данных"})})}):e.jsxs(o,{sx:{display:"flex",height:"100%"},children:[e.jsx(o,{sx:{width:"15%",height:"100%"},children:e.jsx(rs,{})}),e.jsxs(o,{ref:L,sx:{width:"60%",height:"100%"},children:[w!==null?e.jsx(o,{sx:{width:"100%",height:"68vh",display:"flex",justifyContent:"center",alignItems:"center"},children:w[1].map(Z=>e.jsx(o,{children:Z}))}):r!==null?e.jsx(vo,{height:S.height/100*75,width:S.width,mapGeoJson:r,linesGeoJson:b,substGeoJson:l,settings:j}):e.jsx(o,{sx:{width:"100%",height:"68vh",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(Pe,{color:"#003274"})}),e.jsx(o,{sx:{height:`${S.height/100*24}px`},children:e.jsx(no,{})})]}),e.jsx(o,{sx:{width:"25%",height:"100%"},children:e.jsx(to,{height:S.height})})]})},jo=({isOpenPData:s,setIsOpenPData:u,assetName:a,substName:g,elementId:t})=>{const r=B(),c=v(O),b=v(Ca),[p,l]=i.useState([]);return i.useEffect(()=>{try{if(b!==null){const x=b.categories.map(j=>e.jsxs(o,{sx:{marginBottom:"10px",marginTop:"10px"},children:[e.jsx(o,{sx:{color:F.color,...M},children:j.title}),e.jsxs(ue,{striped:!0,withColumnBorders:!0,withBorder:!0,children:[e.jsx("thead",{}),e.jsx("tbody",{children:j.values.map(n=>e.jsxs("tr",{style:{color:F.color,...R},children:[e.jsxs("td",{style:{width:"35%"},children:[n.signal," ",n.unit!==null?`, ${n.unit}`:""]}),e.jsx("td",{style:{width:"65%"},children:n.value})]},$()))})]})]},$()));l(x)}}catch(x){console.error("PDataTable"),console.log(x)}},[]),e.jsx(Ce,{opened:s,onClose:()=>u(!1),styles:{header:{...M,...F}},title:e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[`${c.pDataLabel}: ${a} ${g}`,e.jsx(o,{sx:{marginLeft:"15px",border:"1px solid #003274",borderRadius:"5px",background:"#003274","&:hover":{transform:"scale(1.1)"},"&:active":{transform:"scale(0.9)"}},onClick:x=>r(cs({placeTheCall:"passpowrtData",id:t})),children:e.jsx(ae,{label:c.saveReportLabel,color:"#003274",position:"top",withArrow:!0,children:e.jsx(Jt,{stroke:2,color:"white"})})})]}),centered:!0,size:"50%",overlayProps:{color:"black",opacity:.7,blur:5},children:e.jsx(o,{children:e.jsx(o,{children:p})})})},To=({isOpenSettings:s,setIsOpenSettings:u,assetName:a,substName:g,elementId:t})=>{const r=B(),c=v(O),b=v(Sa),[p,l]=i.useState([]);return i.useEffect(()=>{try{if(b!==null){const x=b.categories.map(j=>e.jsxs(o,{sx:{marginBottom:"10px",marginTop:"10px"},children:[e.jsx(o,{sx:{color:F.color,...M},children:j.title}),e.jsxs(ue,{striped:!0,withColumnBorders:!0,withBorder:!0,children:[e.jsx("thead",{}),e.jsx("tbody",{children:j.values.map(n=>e.jsxs("tr",{style:{color:F.color,...R},children:[e.jsxs("td",{style:{width:"35%"},children:[n.signal," ",n.unit!==null?`, ${n.unit}`:""]}),e.jsx("td",{style:{width:"65%"},children:n.value})]},$()))})]})]},$()));l(x)}}catch(x){console.error("ModelSettings"),console.log(x)}},[]),e.jsx(Ce,{opened:s,onClose:()=>u(!1),styles:{header:{...M,...F}},title:e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[`${c.constLimsLabel}: ${a} ${g}`,e.jsx(o,{sx:{marginLeft:"15px",border:"1px solid #003274",borderRadius:"5px",background:"#003274","&:hover":{transform:"scale(1.1)"},"&:active":{transform:"scale(0.9)"}},onClick:x=>r(cs({placeTheCall:"modelsSettings",id:t})),children:e.jsx(ae,{label:c.saveReportLabel,color:"#003274",position:"top",withArrow:!0,children:e.jsx(Jt,{stroke:2,color:"white"})})})]}),centered:!0,size:"50%",overlayProps:{color:"black",opacity:.7,blur:5},children:e.jsx(o,{children:e.jsx(o,{children:p})})})},Co=()=>{const[s,u]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const y=window.matchMedia(A);return y.addEventListener("change",T=>_(u,T.matches)),()=>y.removeEventListener("change",_)},[]);const a=B(),g=v(La),t=v(Ge),r=v(O),c=v(Da),b=v(Be),[p,l]=i.useState(!g.gasesUnit.includes("(ppm)")),[x,j]=i.useState(!1),[n,w]=i.useState(!1),C=y=>{a(za(y)),l(y)};return e.jsxs(o,{sx:{width:"100%",display:"flex",alignItems:"center",border:"1px solid rgba(191, 191, 191, 0.8)",borderRadius:"5px",overflow:"hidden"},children:[e.jsxs(o,{sx:{display:"flex",width:"80%",alignItems:"center"},children:[e.jsxs(o,{sx:So(s),children:[e.jsxs(o,{children:[r.substNavLabel,": ",(b==null?void 0:b.name)??""]}),e.jsxs(o,{children:[r.assetLabel,": ",(t==null?void 0:t.asset)??""]})]}),e.jsx(ae,{label:r.pDataLabel,color:"#003274",position:"bottom",withArrow:!0,style:R,children:e.jsx(o,{sx:{margin:"0 1%","&:hover":{transform:"scale(1.1)",cursor:"pointer"},"&:active":{transform:"scale(0.9)"}},onClick:()=>j(!0),children:e.jsx(Ys,{stroke:2,color:"#003274"})})}),e.jsx(ae,{label:r.constLimsLabel,color:"#003274",position:"bottom",withArrow:!0,style:R,children:e.jsx(o,{sx:{margin:"0 1%","&:hover":{transform:"scale(1.1)",cursor:"pointer"},"&:active":{transform:"scale(0.9)"}},onClick:()=>w(!0),children:e.jsx(Js,{stroke:2,color:"#003274"})})}),e.jsx(ae,{label:r.chartsLabel,color:"#003274",position:"bottom",withArrow:!0,style:R,children:e.jsx(ut,{to:"charts",style:{display:"flex",justifyContent:"center",alignItems:"center",width:"30px",height:"30px",margin:"0 1%"},children:e.jsx(o,{sx:{"&:hover":{transform:"scale(1.1)",cursor:"pointer"},"&:active":{transform:"scale(0.9)"}},children:e.jsx(Ks,{stroke:2,color:"#003274"})})})}),e.jsxs(o,{sx:{...F,...M},children:[r.health,": ",c??""]})]}),e.jsx(o,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",width:"20%",paddingRight:"1%"},children:e.jsx(Kt,{styles:{trackLabel:{fontSize:"1.5em",cursor:"pointer"},track:{cursor:"pointer"}},size:"md",onLabel:"%",offLabel:"%",checked:p,onChange:y=>C(y.currentTarget.checked)})}),e.jsx(jo,{isOpenPData:x,setIsOpenPData:j,assetName:t==null?void 0:t.asset,substName:b==null?void 0:b.name,elementId:t==null?void 0:t.elementId}),e.jsx(To,{isOpenSettings:n,setIsOpenSettings:w,assetName:t==null?void 0:t.asset,substName:b==null?void 0:b.name,elementId:t==null?void 0:t.elementId})]})},So=s=>({...M,color:"#003274",fontSize:s?"1em":"1.2em",margin:"1%"}),mt=[{name:"ppm",calc:s=>(s*1e4).toFixed(4)},{name:"percent",calc:s=>s==null?s:(s/1e4).toFixed(4)},{name:"nf",calc:s=>s==null?s:(s/1e4).toFixed(4)}],Te=({text:s})=>e.jsx(o,{sx:{margin:"5px",...M,...F,borderBottom:ds.borderColor,cursor:"pointer",userSelect:"none",background:"aliceblue"},children:s}),As=i.forwardRef(({style:s,className:u,onMouseDown:a,onMouseUp:g,onTouchEnd:t,children:r,...c},b)=>{const p=v(gt);return e.jsxs(o,{style:{...s},className:u,ref:b,onMouseDown:a,onMouseUp:g,onTouchEnd:t,children:[e.jsx(Te,{text:c.data.name}),e.jsx(ue,{children:e.jsx("tbody",{children:c.data.values.map(l=>{let x=null,j=null,n=null,w=null,C=null;return l.measure_unit.length>1&&p?(x=l.measure_unit[1].name,j=mt.find(y=>y.name===l.measure_unit[1].code),n=j.calc(l.dz),w=j.calc(l.pdz),C=j.calc(l.value)):(x=l.measure_unit[0].name,n=l.dz,w=l.pdz,C=l.value),e.jsxs("tr",{children:[e.jsx("td",{style:{width:`${c.data.widthFirstColumn}%`,...M,...F,border:"0px solid transparent"},children:l.name+` (${x})`},$()),e.jsx("td",{style:{margin:"0",display:"flex",alignItems:"center",border:"0px solid transparent"},children:e.jsx(ka,{dz:n,pdz:w,borderRadius:10,value:C},$())},$())]},$())})})}),r]})}),_s=i.forwardRef(({style:s,className:u,onMouseDown:a,onMouseUp:g,onTouchEnd:t,children:r,...c},b)=>{var j;const p=[{code:"t_en",icons:e.jsx(et,{stroke:2})},{code:"t_tp",icons:e.jsxs(o,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(o,{sx:{marginBottom:"-15px"},children:e.jsx(yt,{stroke:2})}),e.jsx(et,{stroke:2})]})},{code:"t_bt",icons:e.jsxs(o,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(o,{sx:{marginTop:"15px",marginBottom:"-15px"},children:e.jsx(et,{stroke:2})}),e.jsx(yt,{stroke:2})]})}],[l,x]=i.useState(0);return i.useEffect(()=>{const w=Math.floor(b.current.clientWidth/100);c.data.values.length-w,x(w)},[c["data-grid"],(j=b==null?void 0:b.current)==null?void 0:j.clientWidth]),e.jsxs(o,{style:{...s},className:u,ref:b,onMouseDown:a,onMouseUp:g,onTouchEnd:t,children:[e.jsx(Te,{text:c.data.name}),e.jsx(qs,{cols:l,spacing:"xs",verticalSpacing:"xs",children:c.data.values.map(n=>{var w;return e.jsx(ae,{label:n.name,withArrow:!0,styles:{tooltip:{background:"RGB(0, 50, 116)",color:"white"}},children:e.jsxs(o,{sx:{display:"flex",justifyContent:n.icon===null||n.icon===void 0||n.icon.length===0?"center":"space-between",alignItems:"center"},children:[(w=p.find(C=>C.code===n.icon))==null?void 0:w.icons,e.jsxs(o,{sx:{...F,...R,fontWeight:"bold"},children:[n.value," "," "+n.measure_unit[0].name]},$())]},$())},$())})}),r]})}),Ps=i.forwardRef(({style:s,className:u,onMouseDown:a,onMouseUp:g,onTouchEnd:t,children:r,...c},b)=>{const p=v(gt);return e.jsxs(o,{style:{...s},className:u,ref:b,onMouseDown:a,onMouseUp:g,onTouchEnd:t,children:[e.jsx(Te,{text:c.data.name}),e.jsxs(ue,{striped:!0,withColumnBorders:!0,children:[e.jsx("thead",{children:e.jsx("tr",{children:c.data.values[0].map((l,x)=>e.jsx("td",{style:{width:`${x==0?c.data.widthFirstColumn:""}%`,...M,...F,textAlign:"center"},children:l.content},$()))},$())}),e.jsx("tbody",{children:c.data.values.map((l,x)=>{if(x!=0)return e.jsx("tr",{children:l.map((j,n)=>{let w=null,C=null,y=null;return l[0].measure_unit.length>1&&p?(w=l[0].measure_unit[1].name,C=mt.find(T=>T.name==l[0].measure_unit[1].code),y=C.calc(j.content)):(w=l[0].measure_unit[0].name,y=j.content),e.jsx("td",{style:{width:`${n==0?c.data.widthFirstColumn:""}%`,...M,textAlign:n==0?"":"center",color:j.status!==0?"white":F.color,background:j.status!==0?us.find(T=>T.levelState===j.status).color:"transparent"},children:n==0?`${j.content} (${w})`:y},$())})},$())})})]}),r]})}),pt=i.forwardRef(({style:s,className:u,onMouseDown:a,onMouseUp:g,onTouchEnd:t,children:r,...c},b)=>{var h,m,f,d;const p=v(O),l=v(gt);let x=!1;const j=i.useMemo(()=>{let D=[];switch(c.chartType){case"chartPanel":const L=[],S=[];c.data.values.forEach(X=>{L.push(X[0]),S.push(X[1])}),D.push({x:L,y:S,mode:"lines",fill:"tozeroy",line:{color:"green"},type:"scatter"});break;case"boxChart":D=c.data.values.map(X=>{const ee=X.timestamp.split(".");let k=null;if(c.data.measure_unit.length>1&&l){let N=mt.find(E=>E.name===c.data.measure_unit[1].code);k=X.values.map(E=>N.calc(E))}else k=X.values;return x=!!(k!=null&&k.find(N=>N<1e-4)),{y:k,marker:{color:"rgb(0,128,0)"},type:"box",name:`${ee[2]}.${ee[1]}`,hoverinfo:"none"}});break;case"triangleChart":const Z={name:"",showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"markers",line:{color:"black"},a:c.data.values.CH4,b:c.data.values.C2H2,c:c.data.values.C2H4,marker:{color:c.data.values.dates.map((X,ee)=>ee),size:14,line:{width:1,color:"black"}},text:c.data.values.dates.map(X=>X.replace("T"," ")),hovertemplate:"<i>C2H4: %{c} </i><br><i>CH4: %{a} </i><br><i>C2H2: %{b} </i><br><i>%{text}</i>"};let V=[{name:p.lowEnergySparkDischargeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[.01,13,13,77],c:[0,0,23,23],a:[0,87,64,0],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#005686"},{name:p.highEnergySparkDischargeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[77,13,13,29,29],c:[23,23,40,40,71],a:[0,64,47,31,0],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#7fc7e2"},{name:p.compositionOfElectricalAndThermalDefectsLabel,hoverinfo:"text",showlegend:!1,type:"scatterternary",mode:"lines",line:{color:"black"},b:[29,29,13,13,4,4,15,15],c:[71,40,40,0,0,50,50,85],a:[0,31,47,87,96,46,35,0],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#dccfe2"},{name:p.thermalDefectInHighTemperatureRangeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[15,15,0,0],c:[85,50,50,100],a:[0,35,50,0],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#c89c82"},{name:p.thermalDefectInMiddleTemperatureRangeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[4,0,0,4],c:[50,50,20,20],a:[46,50,80,76],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#f0cac1"},{name:p.thermalDefectInLowTemperatureRangeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[4,0,0,2,4],c:[20,20,2,0,0],a:[76,80,98,98,96],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#f4ecea"},{name:p.pdLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[2,0,0],c:[0,2,0],a:[98,98,100],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#9b8fa4"}];V.push(Z),D.push(...V);break;case"pentagonChart":const W={x:c.data.values.x,y:c.data.values.y,showlegend:!1,mode:"markers",marker:{color:c.data.values.dates.map((X,ee)=>ee),size:14,line:{width:1,color:"black"}},text:c.data.values.dates.map((X,ee)=>`H2: ${c.data.values.h2[ee]}<br>CH4: ${c.data.values.ch4[ee]}<br>C2H6: ${c.data.values.c2h6[ee]}<br>C2H4: ${c.data.values.c2h4[ee]}<br>C2H2: ${c.data.values.c2h2[ee]} <br>${X.replace("T"," ")}`),hoverinfo:"text"};let U=[{x:[-35,0,0,-1,-1,0,0,-38,-35],y:[3,1.5,24.5,24.5,33,33,40,12.4,3],fill:"toself",fillcolor:"#90af9d",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:p.mineralOilGassingLabel,hoverinfo:"text"},{x:[-22.5,-6,-1,0,-35,-23.5,-22.5],y:[-32.4,-4,-2,1.5,3,-32.4,-32.4],fill:"toself",fillcolor:"#f4ecea",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:p.thermalDefectInLowTemperatureRangeLabel,hoverinfo:"text"},{x:[0,38,32,4,0,0],y:[40,12,-6,16,1.5,40],fill:"toself",fillcolor:"#005686",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:p.lowEnergySparkDischargeLabel,hoverinfo:"text"},{x:[0,0,-1,-1,0],y:[24.5,33,33,24.5,24.5],fill:"toself",fillcolor:"#9b8fa4",hoveron:"points+fills",mode:"lines",line:{color:"black",width:1},text:p.pdLabel,hoverinfo:"text"},{x:[1,-6,-22.5,1],y:[-32.4,-4,-32.4,-32.4],fill:"toself",fillcolor:"#f0cac1",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:p.thermalDefectInMiddleTemperatureRangeLabel,hoverinfo:"text"},{x:[24,-1,-6,1,23.5,24],y:[-30,-2,-4,-32.4,-32.4,-30],fill:"toself",fillcolor:"#c89c82",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:p.thermalDefectInHighTemperatureRangeLabel,hoverinfo:"text"},{x:[4,32,24,-1,4],y:[16,-6,-30,-2,16],fill:"toself",fillcolor:"#7fc7e2",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:p.highEnergySparkDischargeLabel,hoverinfo:"text"},{x:["0","41"],y:["0","13"],showlegend:!1,mode:"lines",marker:{color:he},text:["","40% C2H2"],textposition:"top left",hoverinfo:"text"},{x:["0","48"],y:["0","16"],showlegend:!1,mode:"text",marker:{color:he},text:["","40% C2H2"],textposition:"top left",hoverinfo:"text"},{x:["0","0"],y:["0","41"],showlegend:!1,mode:"lines+text",marker:{color:he},text:["","40% H2"],textposition:"top",hoverinfo:"text"},{x:["0","-41"],y:["0","13.5"],showlegend:!1,mode:"lines",marker:{color:he},text:["","40% C2H6"],textposition:"top right",hoverinfo:"text"},{x:["0","-45"],y:["0","16"],showlegend:!1,mode:"text",marker:{color:he},text:["","40% C2H6"],textposition:"top right",hoverinfo:"text"},{x:["0","-25.5"],y:["0","-35"],showlegend:!1,mode:"lines+text",marker:{color:he},text:["","40% CH4"],textposition:"bottom",hoverinfo:"text"},{x:["0","25.5"],y:["0","-35"],showlegend:!1,mode:"lines+text",marker:{color:he},text:["","40% C2H4"],textposition:"bottom",hoverinfo:"text"}];U.push(W),D.push(...U);break}return D},[c.chartType,c.data,p,l]),n=i.useMemo(()=>{switch(c.chartType){case"chartPanel":return{grid:{rows:1,columns:1,pattern:"independent"},xaxis:{type:"date",tickformat:"%d-%m-%y %H:%M",tickfont:{size:0,color:"transparent",family:M.fontFamily}},yaxis:{tickfont:{size:12,color:F.color,family:M.fontFamily}},autosize:!1,margin:{l:30,r:10,b:50,t:0,pad:4}};case"boxChart":return{showlegend:!1,margin:{l:60,r:10,b:80,t:0,pad:4},hoverlabel:{font:{family:R.fontFamily,size:12,color:"white"}},yaxis:{tickformat:x&&l?".4f":".f"}};case"triangleChart":return{...Ra,margin:{b:100,t:5},annotations:[]};case"pentagonChart":return{...Ea,margin:{t:0,b:50,l:0,r:0},annotations:[],paper_bgcolor:"transparent",plot_bgcolor:"transparent"}}},[c.chartType,p,l]),[w,C]=i.useState(0),[y,T]=i.useState(0);return i.useEffect(()=>{setTimeout(()=>{b!==null&&b.current!==null&&b.current.clientWidth!==null&&(C(b.current.clientWidth),T(b.current.clientHeight))},500)},[(h=b==null?void 0:b.current)==null?void 0:h.clientWidth,(m=b==null?void 0:b.current)==null?void 0:m.clientHeight]),e.jsxs(o,{style:{...s},className:u,ref:b,onMouseDown:a,onMouseUp:g,onTouchEnd:t,children:[c.chartType==="boxChart"?e.jsx(Te,{text:`${c.data.name} ${(f=c.data)!=null&&f.measure_unit&&l?`(${c.data.measure_unit[1].name})`:`(${c.data.measure_unit[0].name})`}`}):e.jsx(Te,{text:`${c.data.name} ${(d=c.data)!=null&&d.measure_unit?`(${c.data.measure_unit[0].name})`:""}`}),e.jsx(Y,{useResizeHandler:!0,data:j,layout:{...structuredClone(n),width:w,height:y,dragmode:!1},config:{...J.GetConfig(),scrollZoom:!1}}),r]})});i.memo(pt);const Lo=({group:s,width:u,height:a})=>{const g=v(O),[t,r]=i.useState(null);return i.useLayoutEffect(()=>{const c=s.sensors.map(b=>{var p;return e.jsx(ae,{withArrow:!0,arrowSize:15,label:e.jsxs(o,{children:[e.jsx(o,{children:`${s.name}`}),e.jsx(o,{children:`${b.name}: ${b.value} ${b.measure_unit}`}),b.dz===null?null:e.jsx(o,{children:g.lim0Label+`: ${b.dz} ${b.measure_unit}`}),b.pdz===null?null:e.jsx(o,{children:g.lim1Label+`: ${b.pdz} ${b.measure_unit}`})]}),children:e.jsx(o,{sx:{width:"100%",height:"100%",border:"1px solid black",borderRadius:"50%",background:((p=us.find(l=>l.levelState===b.status))==null?void 0:p.color)??"rgba(39, 114, 245, 0.8)"}},$())},$())});r(c)},[]),e.jsx(o,{sx:{position:"absolute",left:`${s.x}%`,top:`${s.y}%`,display:"flex",width:`${t!==null?t.length:0}%`,height:"2%"},children:t},$())},$s=({imageUrl:s,cbGetSize:u})=>(i.useEffect(()=>{const a=new Image;a.onload=()=>{u({width:a.width,height:a.height})},a.src=s},[s]),e.jsx("img",{src:s,alt:"Loaded",style:{width:"100%",height:"100%",objectFit:"contain"}})),Ve=i.forwardRef(({style:s,className:u,onMouseDown:a,onMouseUp:g,onTouchEnd:t,children:r,...c},b)=>{const[p,l]=i.useState(c.data.value),[x,j]=i.useState(null),[n,w]=i.useState(null),[C,y]=i.useState(null);i.useLayoutEffect(()=>{if(c.data.hasOwnProperty("groups")&&c.data.groups.length>0){const L=c.data.groups.map(S=>e.jsx(Lo,{group:S,width:T},$()));y(L)}},[]);const[T,h]=i.useState(0),[m,f]=i.useState(0);i.useEffect(()=>{c.data.hasOwnProperty("groups")&&c.data.groups.length>0&&b!==null&&b.current!==null&&b.current.clientWidth!==null&&(h(b.current.clientWidth),f(b.current.clientHeight),setTimeout(()=>{w({width:b.current.offsetWidth,height:b.current.offsetHeight})},500))},[c.lastValues]);const d=()=>{let L,S,Z=x.width/x.height,V=n.width/n.height;return Z>V?(L=n.width,S=x.height*(n.width/x.width)):(S=n.height,L=x.width*(n.height/x.height)),{width:L,height:S}};let D=null;return x!==null&&n!==null&&(D=d()),e.jsxs(o,{style:{...s},className:u,ref:b,onMouseDown:a,onMouseUp:g,onTouchEnd:t,sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",overflowY:"auto",position:"relative"},children:[e.jsx($s,{imageUrl:p,cbGetSize:j}),e.jsx(o,{sx:{position:"absolute",width:`${D!==null?D.width:0}px`,height:`${D!==null?D.height:0}px`},children:C}),r]})}),Os=i.forwardRef(({style:s,className:u,onMouseDown:a,onMouseUp:g,onTouchEnd:t,children:r,...c},b)=>e.jsxs(o,{style:{...s},className:u,ref:b,onMouseDown:a,onMouseUp:g,onTouchEnd:t,children:[e.jsx(Te,{text:c.data.name}),c.data.values.map(p=>e.jsx(o,{sx:{...M,...F},children:p},$())),r]})),Do=Ue.WidthProvider(Ue.Responsive),xe={overflow:"hidden"},zo=i.forwardRef(({style:s,className:u,onMouseDown:a,onMouseUp:g,onTouchEnd:t,children:r,...c},b)=>{const p=B(),l=v(hs),x=n=>{const w=l.find(C=>+C.i===n.id);switch(n.typeDisplay){case"textField":return e.jsx(Os,{data:n,"data-grid":w,style:xe},`${n.id}`);case"limitsBar":return e.jsx(As,{data:n,"data-grid":w,style:xe},`${n.id}`);case"wrapPanel":return e.jsx(_s,{data:n,"data-grid":w,style:xe},`${n.id}`);case"linearTable":return e.jsx(Ps,{data:n,"data-grid":w,style:xe},`${n.id}`);case"pentagonChart":case"triangleChart":case"boxChart":case"chartPanel":return e.jsx(pt,{data:n,"data-grid":w,style:xe,chartType:n.typeDisplay},`${n.id}`);case"img":return e.jsx(Ve,{className:"titlebar",data:n,"data-grid":w,style:xe},`${n.id}`);case"img&ind":return e.jsx(Ve,{className:"titlebar",data:n,"data-grid":w,style:xe},`${n.id}`)}},j=n=>{const w=n.map(C=>({i:C.i,x:C.x,y:C.y,w:C.w,h:C.h}));p(Ha(w))};return e.jsxs(o,{style:{...s},className:u,ref:b,onMouseDown:a,onMouseUp:g,onTouchEnd:t,children:[e.jsx(Do,{className:"layout",layouts:{lg:l},breakpoints:{lg:1200},cols:{lg:12},width:1200,rowHeight:30,onDragStop:n=>j(n),onResizeStop:n=>j(n),children:c.data.parts.map(n=>x(n))}),r]})}),ko=Ue.WidthProvider(Ue.Responsive),be={border:ds.borderColor,borderRadius:"5px",overflow:"hidden"},Eo=()=>{const s=B(),u=i.useRef(null),a=Fe(u),g=v(hs),t=v(Ia),r=v(Ma),[c,b]=i.useState(null),[p,l]=i.useState({lg:[]}),x=n=>{s(_a(n))};i.useEffect(()=>{try{if(t!==null&&r!==null){const n=r.map(w=>w.hasOwnProperty("parts")?e.jsxs(o,{sx:{border:"1px solid rgba(191, 191, 191, 0.8)",borderRadius:"5px",overflow:"hidden"},children:[e.jsx(o,{className:"titlebar",children:e.jsx(Te,{text:w.name})}),e.jsx(o,{className:"content",children:e.jsx(zo,{data:w})})]},w.id):j(w));b(n),l({lg:t})}}catch(n){console.log(n)}},[t,r,g]),i.useEffect(()=>()=>{try{t!==null&&s(Aa())}catch(n){console.error("SAVETRANSFORM DATA ERROR"),console.error(n)}},[]);const j=n=>{const w=t.find(C=>+C.i===n.id);switch(n.typeDisplay){case"textFields":return e.jsx(Os,{data:n,"data-grid":w,style:be},`${n.id}`);case"limitsBar":return e.jsx(As,{data:n,"data-grid":w,style:be},`${n.id}`);case"wrapPanel":return e.jsx(_s,{data:n,"data-grid":w,style:be},`${n.id}`);case"linearTable":return e.jsx(Ps,{data:n,"data-grid":w,style:be},`${n.id}`);case"pentagonChart":case"triangleChart":case"boxChart":case"chartPanel":return e.jsx(pt,{data:n,"data-grid":w,style:be},`${n.id}`);case"img":return e.jsx(Ve,{className:"titlebar",data:n,"data-grid":w,style:be},`${n.id}`);case"img&ind":return e.jsx(Ve,{className:"titlebar",data:n,"data-grid":w,style:be},`${n.id}`)}};return t===null?e.jsx(o,{ref:u,sx:{height:"100%"},children:"Empty"}):e.jsx(o,{ref:u,sx:{height:"100%",paddingBottom:"1%"},children:e.jsx(ko,{className:"layout",layouts:p,breakpoints:{lg:1200},cols:{lg:12},width:a.width,draggableCancel:".content",draggableHandle:".titlebar",rowHeight:30,onDragStop:n=>x(n),onResizeStop:n=>x(n),isDraggable:!0,isResizable:!0,children:c})})},Qt=i.memo(()=>{const s=Oe(),u=B(),a=v(O),g=v(Pa);v(ht);const[t,r]=i.useState(!1);return i.useLayoutEffect(()=>{(g===z.idle||g===z.error)&&u(gs({id:s.assetid,isTimer:!1}))},[g]),g===z.error?e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:e.jsx(o,{sx:{display:"flex",alignItems:"center"},children:e.jsx(o,{sx:M,children:"Ошибка загрузки данных"})})}):e.jsxs(o,{children:[g===z.loading?e.jsxs(o,{sx:{display:"flex",alignItems:"flex-end",justifyContent:"center",width:"100%",height:"50vh"},children:[e.jsx(Pe,{color:"#003274"}),e.jsx(o,{sx:M,children:a.loadLabel})]}):e.jsxs(o,{sx:{height:"calc(90% - 2px)"},children:[e.jsx(o,{sx:{paddingTop:"5px",marginLeft:"10px",marginRight:"10px"},children:e.jsx(Co,{})}),e.jsx(Eo,{})]}),e.jsxs(o,{sx:{background:"white",width:"100%",height:"70%",position:"fixed",left:0,bottom:t?"2.5%":"-67.5%",transition:"bottom 0.3s ease-in-out","&:hover":{cursor:"pointer"}},children:[e.jsxs(o,{sx:{background:F.color,color:"white",display:"flex",alignItems:"center",justifyContent:"center",height:"4%"},onClick:()=>{r(!t)},children:[e.jsx(o,{sx:{transform:t?"":"rotate(180deg)"},children:e.jsx(vt,{stroke:2})}),e.jsx(o,{sx:{margin:"0 15px"},children:a.diagMsgLabel}),e.jsx(o,{sx:{transform:t?"":"rotate(180deg)"},children:e.jsx(vt,{stroke:2})})]}),e.jsx($a,{})]})]})}),Ro=[{name:"humidity",values:["charts","hysteresis"]},{name:"gases",values:["charts","rdTable","stoTable","rdnomogram","triangle","pentagon"]}];function q(s=null){const u=Oe(),a=B(),g=v(Ge),t=v(Je),r=v(fs),c=v(ce),b=v(Oa),p=v(ft),l=v(xt),x=v(O),[j,n]=i.useState(null);return i.useEffect(()=>{var w;try{((w=Ro.find(h=>h.name===t))==null?void 0:w.values.includes(r))||a(je("charts"));const y=g===null?u.assetId:g.elementId,T=p==null&&l==null?`${Qe}/asset/${y}/meterings/${t}/${r}?lng=${c.value}`:`${Qe}/asset/${y}/meterings/${t}/${r}?lng=${c.value}&dateStart=${p}&dateEnd=${l}&signals=${b}`;n(T)}catch(C){console.log(C)}},[t,r,g,c,b,p,l]),{url:j,translations:x,codeTab:t,codeSubTab:r,addonData:s}}const He="black",Ho=()=>{const[s,u]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const y=window.matchMedia(A);return y.addEventListener("change",T=>_(u,T.matches)),()=>y.removeEventListener("change",_)},[]);const a=B(),g=q(),t=v(O),r=v(Ge),c=v(ft),b=v(xt),p=v(Je),l=v(fs),x=v(Be),j=[{tab:"gases",subTab:"charts",cb:Ga},{tab:"gases",subTab:"triangle",cb:Ba},{tab:"gases",subTab:"pentagon",cb:Fa},{tab:"humidity",subTab:"hysteresis",cb:Na},{tab:"humidity",subTab:"charts",cb:Za},{tab:"overvoltage",subTab:"charts",cb:Ua},{tab:"power",subTab:"charts",cb:Qa},{tab:"loadcapacity",subTab:"charts",cb:Wa},{tab:"temperature",subTab:"charts",cb:Va},{tab:"bushing",subTab:"charts",cb:Ya},{tab:"wear",subTab:"charts",cb:Ja},{tab:"its",subTab:"charts",cb:Ka},{tab:"pd",subTab:"charts",cb:qa},{tab:"sf6",subTab:"charts",cb:Xa},{tab:"ltc",subTab:"charts",cb:en}];t.lowEnergySparkDischargeLabel,t.highEnergySparkDischargeLabel,t.compositionOfElectricalAndThermalDefectsLabel,t.thermalDefectInHighTemperatureRangeLabel,t.thermalDefectInMiddleTemperatureRangeLabel,t.thermalDefectInLowTemperatureRangeLabel,t.pdLabel,t.mineralOilGassingLabel,t.thermalDefectInLowTemperatureRangeLabel,t.lowEnergySparkDischargeLabel,t.pdLabel,t.thermalDefectInMiddleTemperatureRangeLabel,t.thermalDefectInHighTemperatureRangeLabel,t.highEnergySparkDischargeLabel;const n=y=>{a(ot(y))},w=y=>{new Date(c)>new Date(y)&&a(ot(y)),a(ns(y))},C=()=>{a(as(null)),p==="gases"&&l==="charts"?a(xs(g)):p=="humidity"&&l==="charts"?a(bs(g)):p=="humidity"&&l==="hysteresis"?a(ms(g)):p=="overvoltage"?a(ps(g)):p=="power"?a(ys(g)):p=="loadcapacity"?a(vs(g)):p=="temperature"?a(ws(g)):p==="gases"&&l=="triangle"?a(js(g)):p==="gases"&&l=="pentagon"?a(Ts(g)):p=="bushing"?a(Cs(g)):p=="wear"?a(Ss(g)):p=="its"?a(Ls(g)):p=="pd"?a(Ds(g)):p=="sf6"?a(zs(g)):p=="ltc"&&a(ks(g)),j.filter(y=>y.tab!=p).forEach(y=>a(y.cb(z.idle))),j.filter(y=>y.subTab!==l).forEach(y=>a(y.cb(z.idle)))};return e.jsxs(o,{sx:{width:"100%",display:"flex",justifyContent:"space-between"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",width:"50%"},children:[e.jsx($e,{label:t.fromLabel,dateValue:c,getValue:n,limitDate:b}),e.jsx($e,{label:t.toLabel,dateValue:b,getValue:w,limitDate:Date.now()}),e.jsx(ie,{styles:{root:{...ke(s)},label:{...R}},onClick:()=>C(),children:t.applyLabel})]}),e.jsxs(o,{sx:{...Io(s),display:"flex",flexDirection:"column"},children:[e.jsxs(o,{children:[t.substNavLabel,": ",(x==null?void 0:x.name)??""]}),e.jsxs(o,{children:[t.assetLabel,": ",(r==null?void 0:r.asset)??""]})]})]})},Io=s=>({...M,color:"#003274",fontSize:s?"1em":"1.2em"}),ne=({limitVisibleHandler:s,isDisplayDz:u,isDisplayPdz:a})=>{const[g,t]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const c=window.matchMedia(A);return c.addEventListener("change",b=>_(t,b.matches)),()=>c.removeEventListener("change",_)},[]);const r=v(O);return e.jsxs(o,{sx:{width:"15%",display:"flex",justifyContent:"space-around"},children:[e.jsx(wt,{label:r.lim0Label,checked:u,styles:{label:{...R,fontSize:g?"0.8em":"1em"}},onChange:c=>{s("dz",c.currentTarget.checked)}}),e.jsx(wt,{label:r.lim1Label,checked:a,styles:{label:{...R,fontSize:g?"0.8em":"1em"}},onChange:c=>{s("pdz",c.currentTarget.checked)}})]})},Mo=({SwitcherHandler:s,isVol:u})=>{const a=v(O);return e.jsx(Kt,{label:a.volLabel,checked:u,onChange:g=>s(g.currentTarget.checked)})},le=s=>{let a=0;for(const g in s)g.includes("yaxis")&&s[g].visible&&(s[g].position=.04*a,a++);s.xaxis.domain=[.04*a,1]},oe=(s,u)=>{const a=s.curveNumber,g=s.data.filter(b=>b.yaxis===s.data[a].yaxis&&!b.hasOwnProperty("customType")&&b.mode!=="none"),t=g.filter(b=>b.visible===!0).length,r=g[0].yaxis.replace("y","yaxis");Object.keys(u).forEach(b=>{b==r&&(u[b].visible=t!==0)})},Wt=(s,u)=>{let a=structuredClone(u);return Object.keys(a).forEach(g=>{g.includes("yaxis")&&(a[g].visible=s[g].visible,a[g].position=s[g].position)}),a.xaxis.domain=s.xaxis.domain,a},Ao=({isOpen:s,cbClose:u})=>{const a=v(O),[g,t]=i.useState(new Date),[r,c]=i.useState(""),[b,p]=i.useState(""),[l,x]=i.useState(""),[j,n]=i.useState(""),[w,C]=i.useState(""),[y,T]=i.useState(""),[h,m]=i.useState("");return e.jsxs(Ce,{styles:{content:{borderRadius:"15px"},body:{overflowY:"hidden"},header:{color:"#003274",...M},title:{fontSize:"1.2em",fontWeight:"bold"}},opened:s,onClose:()=>u(!1),title:a.offlineMeasureHARGLabel,size:"30%",children:[e.jsxs(o,{children:[e.jsx($e,{dateValue:g,getValue:t,label:a.dateLabel,colorLable:"#003274"}),e.jsx(se,{styles:{root:{...me}},placeholder:`${a.concentrationLabel} H2`,value:r,onChange:f=>c(f.currentTarget.value)}),e.jsx(se,{styles:{root:{...me}},placeholder:`${a.concentrationLabel} CO`,value:b,onChange:f=>p(f.currentTarget.value)}),e.jsx(se,{styles:{root:{...me}},placeholder:`${a.concentrationLabel} CO2`,value:l,onChange:f=>x(f.currentTarget.value)}),e.jsx(se,{styles:{root:{...me}},placeholder:`${a.concentrationLabel} CH4`,value:j,onChange:f=>n(f.currentTarget.value)}),e.jsx(se,{styles:{root:{...me}},placeholder:`${a.concentrationLabel} C2H2`,value:w,onChange:f=>C(f.currentTarget.value)}),e.jsx(se,{styles:{root:{...me}},placeholder:`${a.concentrationLabel} C2H4`,value:y,onChange:f=>T(f.currentTarget.value)}),e.jsx(se,{styles:{root:{...me}},placeholder:`${a.concentrationLabel} C2H6`,value:h,onChange:f=>m(f.currentTarget.value)})]}),e.jsx(ie,{styles:{root:{zIndex:1,margin:"1%",background:"linear-gradient(to top, #003274, #416eb1)",border:"1px solid #003274",boxShadow:"3px 3px 3px gray","&:active":{boxShadow:"3px 3px 3px transparent"}},label:{...R}},onClick:()=>{console.log("Send data"),t(new Date),c(""),p(""),x(""),n(""),C(""),T(""),m("")},children:a.sendLabel})]})},me={margin:"1% 0"},_o=({isOpen:s,closeCb:u})=>{const a=v(O),g=v(tn),[t,r]=i.useState(),[c,b]=i.useState(null),[p,l]=i.useState(null),[x,j]=i.useState(null),n=i.useRef(null),w=Fe(n);i.useLayoutEffect(()=>{try{if(g!=null){const y=g.filter(T=>T.code!="i"&&T.code!="temp").map(T=>({value:T.code,label:T.code}));r(y)}}catch{}},[g]);const C=y=>{b(y);const T={margin:{l:0,r:0,b:0,t:0},scene:{xaxis:{title:g.find(m=>m.code=="i").name},yaxis:{title:g.find(m=>m.code=="temp").name},zaxis:{title:g.find(m=>m.code==y).name},camera:{center:{x:0,y:0,z:0},eye:{x:1.25,y:1.25,z:1.25},up:{x:0,y:0,z:1}}}};l(T);const h={type:"mesh3d",x:g.find(m=>m.code=="i").values,y:g.find(m=>m.code=="temp").values,z:g.find(m=>m.code==y).values,intensity:g.find(m=>m.code==y).values,colorscale:[[0,"green"],[.5,"orange"],[1,"red"]]};j(h)};return e.jsxs(Ce,{opened:s,onClose:()=>u(!1),title:a.volumeForecastLabel,styles:{content:{overflow:"hidden"},header:{...M,color:"#003274"},title:{fontSize:"1.2em"}},size:"50%",children:[e.jsx(o,{sx:{display:"flex",alignItems:"end"},children:e.jsx(qt,{styles:{label:{...F,...M},item:{...F,...R},input:{...F,...R}},label:a.gasesLabel,placeholder:a.gasesLabel,data:t,value:c,onChange:y=>C(y)})}),e.jsx(o,{ref:n,sx:{width:"100%",height:"60vh"},children:e.jsx(Y,{useResizeHandler:!0,data:[structuredClone(x)],layout:{...structuredClone(p),width:w.width,height:w.height-50},config:J.GetConfig()})})]})},Po=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const k=window.matchMedia(A);return k.addEventListener("change",N=>_(g,N.matches)),()=>k.removeEventListener("change",_)},[]);const t=B(),r=v(sn),c=v(an),b=v(O),p=v(nn),l=v(ln),x=v(on),j=v(rn),[n,w]=i.useState(),[C,y]=i.useState(),[T,h]=i.useState(!1),[m,f]=i.useState(!1);let d=null,D=!1;const L=(k,N)=>{let E=[];if(k==="dz"&&(w(N),E=d.data.filter(P=>P.mode!=="none"&&P.visible===!0).map(P=>`${P.name}_dz`)),k==="pdz"&&(y(N),E=d.data.filter(P=>P.mode!=="none"&&P.visible===!0).map(P=>`${P.name}_pdz`)),d.data.forEach(P=>{E.includes(P.customType)&&(P.visible=N)}),c=="ppm"){let P=structuredClone(j);d.data.forEach(Q=>{let G=P.find(H=>"customType"in H&&H.customType==Q.customType);G&&(G.visible=Q.visible)}),t(Ee(d.data)),t(ge(d.layout)),t(Re(P)),t(fe(x))}else{let P=structuredClone(l);d.data.forEach(Q=>{let G=P.find(H=>"customType"in H&&H.customType==Q.customType);G&&(G.visible=Q.visible)}),t(Re(d.data)),t(fe(d.layout)),t(Ee(P)),t(ge(p))}},S=k=>{if(D)return!1;k.curveNumber!==void 0&&(D=!0,setTimeout(()=>{let N=k.data.filter(E=>E.mode!=="none"&&E.visible===!0&&!E.hasOwnProperty("customType"));try{if(d.data.forEach(E=>{const P=N.find(G=>E.customType===`${G.name}_dz`),Q=N.find(G=>E.customType===`${G.name}_pdz`);P?E.visible=!!(n&&P.visible===!0):Q?E.visible=!!(C&&Q.visible===!0):!P&&!Q&&E.hasOwnProperty("customType")&&(E.visible=!1)}),Z(k),c=="ppm"){t(Ee(d.data)),t(ge(d.layout));const E=structuredClone(j);V(E,N),t(Re(E))}else{t(Re(d.data)),t(fe(d.layout));const E=structuredClone(l);V(E,N),t(Ee(E))}D=!1}catch(E){console.log("GASES TAB ERROR"),console.log(E),D=!1}},500))},Z=k=>{if(oe(k,d.layout),le(d.layout),c==="ppm"){let N=Wt(d.layout,x);t(fe(N))}else{let N=Wt(d.layout,p);t(ge(N))}},V=(k,N)=>{for(let E=0;E<k.length;E++){if(k[E].mode==="none")continue;let P=N.find(Q=>Q.name===k[E].name);if(P){k[E].visible=P.visible;let Q=k.find(H=>H.customType===`${k[E].name}_dz`);Q&&(Q.visible=!!(n&&k[E].visible===!0));let G=k.find(H=>H.customType===`${k[E].name}_pdz`);G&&(G.visible=!!(C&&k[E].visible===!0))}else{if(k[E].hasOwnProperty("customType"))continue;{k[E].visible="legendonly";let Q=k.find(H=>H.customType===`${k[E].name}_dz`);Q&&(Q.visible=!1);let G=k.find(H=>H.customType===`${k[E].name}_pdz`);G&&(G.visible=!1)}}}},W=k=>{t(cn(k?"об.%":"ppm")),t(c==="ppm"?Ee(d.data):Re(d.data)),t(c==="ppm"?ge(d.layout):fe(d.layout))},U=q();i.useEffect(()=>{var k,N,E,P;if(U.url!==null&&U.url.length>0){if(r===z.idle||r===z.error)U.codeTab==="gases"&&U.codeSubTab==="charts"&&t(xs(U));else if(U.codeTab==="gases"&&U.codeSubTab==="charts"){const Q=c==="ppm"?((k=l.find(H=>{var te;return((te=H==null?void 0:H.customType)==null?void 0:te.includes("dz"))&&H.visible===!0}))==null?void 0:k.visible)??!1:((N=j.find(H=>{var te;return((te=H==null?void 0:H.customType)==null?void 0:te.includes("dz"))&&H.visible===!0}))==null?void 0:N.visible)??!1,G=c==="ppm"?((E=l.find(H=>{var te;return((te=H==null?void 0:H.customType)==null?void 0:te.includes("pdz"))&&H.visible===!0}))==null?void 0:E.visible)??!1:((P=j.find(H=>{var te;return((te=H==null?void 0:H.customType)==null?void 0:te.includes("pdz"))&&H.visible===!0}))==null?void 0:P.visible)??!1;w(Q),y(G)}}},[U.url]);const X=k=>{const{autorange:N}=d.layout;if(c==="ppm"){let E=structuredClone(x);E={...E,autorange:N},E.xaxis={...d.layout.xaxis},ee(d.layout,E,"ppmToPercent"),t(ge(d.layout)),t(fe(E))}else{let E=structuredClone(x);E={...E,autorange:N},E.xaxis={...d.layout.xaxis},ee(d.layout,E,"percentToPpm"),t(ge(E)),t(fe(d.layout))}},ee=(k,N,E)=>{E==="percentToPpm"&&Object.keys(k).forEach(P=>{P.includes("yaxis")&&(N[P].autorange=k[P].autorange,N[P].range=[k[P].range[0]*1e4,k[P].range[1]*1e4])}),E==="ppmToPercent"&&Object.keys(k).forEach(P=>{P.includes("yaxis")&&(N[P].autorange=k[P].autorange,N[P].range=[k[P].range[0]/1e4,k[P].range[1]/1e4])})};return r===z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{limitVisibleHandler:L,isDisplayDz:n,isDisplayPdz:C}),e.jsx(Mo,{SwitcherHandler:W,isVol:c!=="ppm"}),e.jsx(ie,{styles:{root:{...ke(a)},label:{...R}},onClick:()=>h(!0),children:b.offlineMeasureHARGLabel}),e.jsx(ie,{styles:{root:{...ke(a)},label:{...R}},onClick:()=>f(!0),children:b.volumeForecastLabel})]}),c=="ppm"?e.jsx(Y,{useResizeHandler:!0,data:structuredClone(l),layout:{...structuredClone(p),width:s,height:u},config:J.GetConfig(),onUpdate:k=>d=k,onLegendClick:k=>S(k),onRelayout:k=>X()}):e.jsx(Y,{useResizeHandler:!0,data:structuredClone(j),layout:{...structuredClone(x),width:s,height:u},config:J.GetConfig(),onUpdate:k=>d=k,onLegendClick:k=>S(k),onRelayout:k=>X()}),e.jsx(Ao,{SendData:()=>console.log("test"),isOpen:T,cbClose:h}),e.jsx(_o,{isOpen:m,closeCb:f})]})},$o=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const x=window.matchMedia(A);return x.addEventListener("change",j=>_(g,j.matches)),()=>x.removeEventListener("change",_)},[]);const t=B(),r=v(dn),c=v(un),b=v(hn),p=v(O),l=q();return i.useEffect(()=>{l.url!==null&&l.url.length>0&&(r===z.idle||r===z.error)&&l.codeTab==="gases"&&l.codeSubTab==="triangle"&&t(js(l))},[l.url]),r==z.loading?e.jsx(K,{height:75}):e.jsxs(o,{sx:{display:"flex"},children:[e.jsxs(o,{sx:{border:"1px solid #003274",borderRadius:"5px",margin:"0 1%",position:"absolute",left:0,top:a?"225px":"250px",zIndex:1e3,fontSize:a?"0.8em":"1em",color:"#003274"},children:[e.jsxs(o,{sx:{...pe,...R},children:[e.jsx(o,{sx:{...ye,background:"#f4ecea"}}),e.jsxs(o,{children:["T1: ",p.thermalDefectInLowTemperatureRangeLabel]})]}),e.jsxs(o,{sx:{...pe,...R},children:[e.jsx(o,{sx:{...ye,background:"#f0cac1"}}),e.jsxs(o,{children:["T2: ",p.thermalDefectInMiddleTemperatureRangeLabel]})]}),e.jsxs(o,{sx:{...pe,...R},children:[e.jsx(o,{sx:{...ye,background:"#c89c82"}}),e.jsxs(o,{children:["T3: ",p.thermalDefectInHighTemperatureRangeLabel]})]}),e.jsxs(o,{sx:{...pe,...R},children:[e.jsx(o,{sx:{...ye,background:"#005686"}}),e.jsxs(o,{children:["D1: ",p.lowEnergySparkDischargeLabel]})]}),e.jsxs(o,{sx:{...pe,...R},children:[e.jsx(o,{sx:{...ye,background:"#7fc7e2"}}),e.jsxs(o,{children:["D2: ",p.highEnergySparkDischargeLabel]})]}),e.jsxs(o,{sx:{...pe,...R},children:[e.jsx(o,{sx:{...ye,background:"#dccfe2"}}),e.jsxs(o,{children:["DT: ",p.compositionOfElectricalAndThermalDefectsLabel]})]}),e.jsxs(o,{sx:{...pe,...R},children:[e.jsx(o,{sx:{...ye,background:"#9b8fa4"}}),e.jsxs(o,{children:["PD: ",p.pdLabel]})]})]}),e.jsx(Y,{useResizeHandler:!0,data:structuredClone(c),layout:{...structuredClone(b),width:s-50,height:u-30},config:J.GetConfig()})]})},pe={display:"flex",alignItems:"center",margin:"0 1%",width:"95%"},ye={width:"15px",height:"15px",margin:"0 1%"},Oo=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const x=window.matchMedia(A);return x.addEventListener("change",j=>_(g,j.matches)),()=>x.removeEventListener("change",_)},[]);const t=B(),r=v(gn),c=v(O),b=v(fn),p=v(xn),l=q();return i.useEffect(()=>{l.url!==null&&l.url.length>0&&(r===z.idle||r===z.error)&&l.codeTab==="gases"&&l.codeSubTab==="pentagon"&&t(Ts(l))},[l.url]),r==z.loading?e.jsx(K,{height:75}):e.jsxs(o,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:[e.jsxs(o,{sx:{border:"1px solid #003274",borderRadius:"5px",margin:"0 1%",position:"absolute",left:0,top:a?"195px":"250px",zIndex:1e3,fontSize:a?"0.7em":"1em",color:"#003274"},children:[e.jsxs(o,{sx:{...ve,...R},children:[e.jsx(o,{sx:{...we,background:"#f4ecea"}}),e.jsxs(o,{children:["T1: ",c.thermalDefectInLowTemperatureRangeLabel]})]}),e.jsxs(o,{sx:{...ve,...R},children:[e.jsx(o,{sx:{...we,background:"#f0cac1"}}),e.jsxs(o,{children:["T2: ",c.thermalDefectInMiddleTemperatureRangeLabel]})]}),e.jsxs(o,{sx:{...ve,...R},children:[e.jsx(o,{sx:{...we,background:"#c89c82"}}),e.jsxs(o,{children:["T3: ",c.thermalDefectInHighTemperatureRangeLabel]})]}),e.jsxs(o,{sx:{...ve,...R},children:[e.jsx(o,{sx:{...we,background:"#005686"}}),e.jsxs(o,{children:["D1: ",c.lowEnergySparkDischargeLabel]})]}),e.jsxs(o,{sx:{...ve,...R},children:[e.jsx(o,{sx:{...we,background:"#7fc7e2"}}),e.jsxs(o,{children:["D2: ",c.highEnergySparkDischargeLabel]})]}),e.jsxs(o,{sx:{...ve,...R},children:[e.jsx(o,{sx:{...we,background:"#90af9d"}}),e.jsxs(o,{children:["S: ",c.mineralOilGassingLabel]})]}),e.jsxs(o,{sx:{...ve,...R},children:[e.jsx(o,{sx:{...we,background:"#9b8fa4"}}),e.jsxs(o,{children:["PD: ",c.pdLabel]})]})]}),e.jsx(o,{sx:{marginLeft:"10%"},children:e.jsx(Y,{useResizeHandler:!0,data:structuredClone(b),layout:{...structuredClone(p),width:s,height:u},config:{...J.GetConfig(),scrollZoom:!1}})})]})},ve={display:"flex",alignItems:"center",margin:"0 1%",width:"95%"},we={width:"15px",height:"15px",margin:"0 1%"},Go={title:{text:""},legend:{xanchor:"right",traceorder:"normal",font:{family:R.fontFamily,size:12,color:"#000"},bgcolor:"#E2E2E2",bordercolor:"rgba(186, 186, 186, 0.8)",borderwidth:2},autosize:!1,paper_bgcolor:"transparent",plot_bgcolor:"transparent",showlegend:!0},Bo=({width:s,height:u})=>{var C;const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const y=window.matchMedia(A);return y.addEventListener("change",T=>_(g,T.matches)),()=>y.removeEventListener("change",_)},[]);const t=B(),r=v(bn),c=v(mn),b=v(ce),p=v(O),[l,x]=i.useState(),[j,n]=i.useState(),w=q();return i.useEffect(()=>{w.url!==null&&w.url.length>0&&(r===z.idle||r===z.error)&&w.codeTab==="gases"&&w.codeSubTab==="rdnomogram"&&t(pn(w))},[w.url]),i.useLayoutEffect(()=>{c&&(x({x:c.gases,y:c.fact,name:p.factLabel,line:{color:"rgba(39, 123, 245, 0.8)"},legendgroup:"group1"}),n({x:c.gases,y:c.etalon,name:p.etalonLabel,line:{color:"orange"},legendgroup:"group2"}))},[c,b]),r==z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsx(o,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(o,{sx:{...F,margin:"0 1%"},children:((C=c==null?void 0:c.data)==null?void 0:C.split(".")[0].replace("T"," "))??""})}),c===null||Object.keys(c).length===0?e.jsx(o,{sx:{width:"100%",height:"70vh",display:"flex",alignItems:"center",justifyContent:"center",...F,...M},children:p.noDefectsFoundNomogramLabel}):e.jsx(Y,{useResizeHandler:!0,data:[l,j],layout:{...structuredClone(Go),width:s,height:u-30},config:J.GetConfig()}),e.jsx(o,{sx:{...R,color:"#003274",marginLeft:"1%",fontSize:a?"1em":"1.2em"},children:(c==null?void 0:c.message)??""})]})},Fo=[{numberRow:"1",defect:"Нормально","C2H2/C2H4":"<0.1","CH4/H2":"0.1-1","C2H4/C2H6":"≤1",exampels:"Нормальное старение"},{numberRow:"2",defect:"ЧР с низкой плотностью энергии","C2H2/C2H4":"<0.1","CH4/H2":"<0.1","C2H4/C2H6":"≤1",exampels:"Разряды в заполненных газом полостях"},{numberRow:"3",defect:"ЧР с высокой плотностью энергии","C2H2/C2H4":"0.1-3","CH4/H2":"<0.1","C2H4/C2H6":"≤1",exampels:"Разряды в заполненных газом полостях"},{numberRow:"4",defect:"Разряды малой мощности","C2H2/C2H4":">0.1","CH4/H2":"0.1-1","C2H4/C2H6":"1-3",exampels:"Непрерывное искрение в масле"},{numberRow:"5",defect:"Разряды большой мощности","C2H2/C2H4":"0.1-3","CH4/H2":"0.1-1","C2H4/C2H6":"≥3",exampels:"Дуговые разряды"},{numberRow:"6",defect:"Термический дефект низкой температуры (до 150 град.С)","C2H2/C2H4":"<0.1","CH4/H2":"0.1-1","C2H4/C2H6":"1-3",exampels:"Перегрев изолированного проводника"},{numberRow:"7",defect:"Термический дефект в диапазоне низких температур (150-300 град.С)","C2H2/C2H4":"<0.1","CH4/H2":"≥1","C2H4/C2H6":"<1",exampels:"Местный перегрев сердечника"},{numberRow:"8",defect:"Термический дефект в диапазоне средних температур (300-700 град.С)","C2H2/C2H4":"<0.1","CH4/H2":"≥1","C2H4/C2H6":"1-3",exampels:"Местный перегрев сердечника"},{numberRow:"9",defect:"Термический дефект высокой температуры (более 700 град.С)","C2H2/C2H4":"<0.1","CH4/H2":"≥1","C2H4/C2H6":"≥3",exampels:"Горячая точка в сердечнике"}],No=({width:s,height:u})=>{const a=B(),g=v(O),t=v(ce),r=v(yn);let c=v(vn);const[b,p]=i.useState(),l=q();return i.useEffect(()=>{l.url!==null&&l.url.length>0&&(r===z.idle||r===z.error)&&l.codeTab==="gases"&&l.codeSubTab==="rdTable"&&a(wn(l))},[l.url]),i.useEffect(()=>{l.codeSubTab==="rdTable"&&p(c!==null?Uo(c,Fo):[])},[c,t]),r===z.loading?e.jsx(K,{height:75}):e.jsx(o,{sx:{width:"98%",height:`${u}px`,paddingLeft:"1%"},children:e.jsxs(ue,{withColumnBorders:!0,withBorder:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"5%",...Se,...M},children:"№"}),e.jsx("th",{style:{width:"40%",...Se,...M},children:g.defectLabel}),e.jsx("th",{style:{width:"5%",...Se,...M},children:"C2H2/C2H4"}),e.jsx("th",{style:{width:"5%",...Se,...M},children:"CH4/H2"}),e.jsx("th",{style:{width:"5%",...Se,...M},children:"C2H4/C2H6"}),e.jsx("th",{style:{width:"40%",...Se,...M},children:g.typicalExamplesLabel})]})}),e.jsx("tbody",{children:b})]})})},Se={textAlign:"center",...F},Zo=s=>{let u={bg:null,text:null};return s===null?(u.bg="gray",u.text="white"):s===1?(u.bg=De.dangerousColor,u.text="white"):(u.bg="transparent",u.text=F.color),u};function Uo(s,u){return Object.keys(s).map(a=>{const g=Object.keys(s[a]);g.unshift(a);const t=u.find(r=>r.numberRow===a);return t.defect=s[a].defect,t.exampels=s[a].exampels,e.jsx("tr",{children:g.map((r,c)=>{const b=Zo(s[a][r]);return e.jsx("td",{style:{padding:"0 5px",textAlign:[1,5].includes(c)?"":"center",background:[2,3,4].includes(c)?b.bg:"transparent",color:[2,3,4].includes(c)?b.text:F.color},children:c===0?r:t[r]},$())})},$())})}const Qo={statusLoading:z.idle,sourceData:null},Wo=Xs({name:"subTabSTOTableSlice",initialState:Qo,reducers:{setSTOTableStatusLoading:(s,u)=>{s.statusLoading=u.payload}},extraReducers:s=>{s.addCase(Ze.pending,(u,a)=>{u.statusLoading=z.loading}).addCase(Ze.rejected,(u,a)=>{u.statusLoading=z.error}).addCase(Ze.fulfilled,(u,a)=>{u.statusLoading=z.success,u.sourceData=a.payload.values})}}),Ze=ea("subTabSTOTableSlice/SubTabSTOTableQuery",async(s,u)=>await fetch(s.url).then(g=>g.json())),Vo=s=>s.subTabSTO.sourceData,Yo=s=>s.subTabSTO.statusLoading,Jo=Wo.reducer,Ko=[{numberRow:"1",defect:"ЧР","C2H2/C2H4":"-","CH4/H2":"<0.1","C2H4/C2H6":"<0.2"},{numberRow:"2",defect:"Искровые разряды низкой энергии","C2H2/C2H4":">1","CH4/H2":"0.1-0.5","C2H4/C2H6":">1"},{numberRow:"3",defect:"Искровые разряды высокой энергии, дуга","C2H2/C2H4":"0.6-2.5","CH4/H2":"0.1-1","C2H4/C2H6":">2"},{numberRow:"4",defect:"Термический дефект низкой температуры (до 300 град.С)","C2H2/C2H4":"-","CH4/H2":">1","C2H4/C2H6":"<1"},{numberRow:"5",defect:"Термический дефект средней температуры (300-700 град.С)","C2H2/C2H4":"<0.1","CH4/H2":">1","C2H4/C2H6":"1-4"},{numberRow:"6",defect:"Термический дефект высокой температуры (более 700 град.С)","C2H2/C2H4":"<0.2","CH4/H2":">1","C2H4/C2H6":">4"}],qo=({width:s,height:u})=>{const a=B(),g=v(O),t=v(ce),r=v(Yo);let c=v(Vo);const[b,p]=i.useState(),l=q();return i.useEffect(()=>{l.url!==null&&l.url.length>0&&(r===z.idle||r===z.error)&&l.codeTab==="gases"&&l.codeSubTab==="stoTable"&&a(Ze(l))},[l.url]),i.useLayoutEffect(()=>{l.codeSubTab==="stoTable"&&p(c!==null?er(c,Ko):[])},[c,t]),r===z.loading?e.jsx(K,{height:75}):e.jsx(o,{sx:{width:"98%",height:`${u}px`,paddingLeft:"1%"},children:e.jsxs(ue,{withColumnBorders:!0,withBorder:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"5%",...Ie,...M},children:"№"}),e.jsx("th",{style:{width:"40%",...Ie,...M},children:g.defectLabel}),e.jsx("th",{style:{width:"5%",...Ie,...M},children:"C2H2/C2H4"}),e.jsx("th",{style:{width:"5%",...Ie,...M},children:"CH4/H2"}),e.jsx("th",{style:{width:"5%",...Ie,...M},children:"C2H4/C2H6"})]})}),e.jsx("tbody",{children:b})]})})},Ie={textAlign:"center",...F},Xo=s=>{let u={bg:null,text:null};return s===null?(u.bg="gray",u.text="white"):s===1?(u.bg=De.dangerousColor,u.text="white"):(u.bg="transparent",u.text=F.color),u};function er(s,u){return Object.keys(s).map(a=>{const g=Object.keys(s[a]);g.unshift(a);const t=u.find(r=>r.numberRow===a);return e.jsx("tr",{children:g.map((r,c)=>{const b=Xo(s[a][r]);return e.jsx("td",{style:{padding:"0 5px",textAlign:[1,5].includes(c)?"":"center",background:[2,3,4].includes(c)?b.bg:"transparent",color:[2,3,4].includes(c)?b.text:F.color},children:c===0?r:t[r]},$())})},$())})}const tr=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const l=window.matchMedia(A);return l.addEventListener("change",x=>_(g,x.matches)),()=>l.removeEventListener("change",_)},[]);const t=B(),r=v(O),[c,b]=i.useState("charts"),p=l=>{t(je(l)),b(l)};return e.jsxs(I,{value:c,onTabChange:l=>p(l),styles:{root:{marginTop:"2px"},tab:{...R,fontSize:a?"0.8em":"1em",color:"#003274","&:hover":{background:"#003274",color:"white"}}},children:[e.jsxs(I.List,{children:[e.jsx(ae,{label:r.chartsLabel,color:"#003274",withArrow:!0,position:"top",children:e.jsx(I.Tab,{value:"charts",children:r.chartsLabel})}),e.jsx(ae,{label:r.methodRelationKeyGasesRDLabel,color:"#003274",withArrow:!0,position:"top",children:e.jsx(I.Tab,{value:"rdTable",children:r.rdTabelLabel})}),e.jsx(ae,{label:r.methodDiagrammGasesRdLabel,color:"#003274",withArrow:!0,position:"top",children:e.jsx(I.Tab,{value:"rdnomogram",children:r.rdNomogrammLabel})}),e.jsx(ae,{label:r.duvaleTriangleByMEKLabel,color:"#003274",withArrow:!0,position:"top",children:e.jsxs(I.Tab,{value:"triangle",children:["△ ",r.duvaleLabel]})}),e.jsx(ae,{label:r.duvalePentagonLabel,color:"#003274",withArrow:!0,position:"top",children:e.jsxs(I.Tab,{value:"pentagon",children:["⬠ ",r.duvaleLabel]})})]}),e.jsx(I.Panel,{value:"charts",pt:"xs",children:e.jsx(Po,{width:s,height:u-50})}),e.jsx(I.Panel,{value:"rdTable",pt:"xs",children:e.jsx(No,{width:s,height:u-50})}),e.jsx(I.Panel,{value:"stoTable",pt:"xs",children:e.jsx(qo,{height:u-50})}),e.jsx(I.Panel,{value:"rdnomogram",pt:"xs",children:e.jsx(Bo,{width:s,height:u-70})}),e.jsx(I.Panel,{value:"triangle",pt:"xs",children:e.jsx($o,{width:s,height:u-50})}),e.jsx(I.Panel,{value:"pentagon",pt:"xs",children:e.jsx(Oo,{width:s-Math.abs(u-s)+50,height:u-50})})]})},at=({values:s,isFirst:u})=>{const[a,g]=i.useState(null);return i.useLayoutEffect(()=>{const t=[];for(let r=1;r<s.length;r++){const c=s[r].map(b=>e.jsx("td",{style:{padding:"0 2px",border:"1px solid black",borderLeft:u?"1px solid black":"0px solid black",textAlign:"center",background:b.hasOwnProperty("status")?jn.find(p=>p.title===b.status).color:""},children:b.value??"-"},$()));t.push(e.jsx("tr",{children:c},$()))}g(t)},[]),e.jsxs(o,{children:[e.jsx(o,{sx:{textAlign:"center",borderTop:"1px solid black",borderLeft:u?"1px solid black":"0px solid black",borderRight:"1px solid black"},children:s[0][0].value}),e.jsx(ue,{children:e.jsx("tbody",{children:a})})]})},sr=({width:s,height:u})=>{const a=B(),g=v(Tn);v(Cn);const t=v(Sn),r=v(Ln),c=v(Dn),[b,p]=i.useState(null),l=v(zn),x=v(kn),[j,n]=i.useState(),[w,C]=i.useState();let y=null;const T=(d,D)=>{let L=[];d==="dz"&&(n(D),L=y.data.filter(S=>S.mode!=="none"&&S.visible===!0).map(S=>`${S.name}_dz`)),d==="pdz"&&(C(D),L=y.data.filter(S=>S.mode!=="none"&&S.visible===!0).map(S=>`${S.name}_pdz`)),y.data.forEach(S=>{L.includes(S.customType)&&(S.visible=D)}),a(jt(y.data)),a(st(y.layout))},h=d=>{let D=d.data.find(L=>L.name===d.node.childNodes[0].innerHTML);D==null&&(D=d.layout.shapes[d.curveNumber]),D.hasOwnProperty("group")?setTimeout(()=>{try{y.layout.shapes.forEach(L=>{L.group==D.group&&(L.visible=D.visible)}),console.log(y),a(st(y.layout))}catch(L){console.log("OVERVOLTAGE ERROR LAYOUT"),console.log(L)}},500):setTimeout(()=>{try{let L=d.data[d.curveNumber];m(d),y.data.forEach(S=>{S.customType===`${L.name}_dz`&&(S.visible=!!(j&&L.visible===!0)),S.customType===`${L.name}_pdz`&&(S.visible=!!(w&&L.visible===!0))}),a(jt(y.data)),a(st(y.layout))}catch(L){console.log("Overvoltage TAB ERROR"),console.log(L)}},500)},m=d=>{oe(d,y.layout),le(y.layout)},f=q();return i.useEffect(()=>{var d,D;f.url!==null&&f.url.length>0&&(g===z.idle||g===z.error?f.codeTab==="overvoltage"&&a(ps(f)):f.codeTab==="overvoltage"&&(n(((d=x.find(L=>{var S;return((S=L==null?void 0:L.customType)==null?void 0:S.includes("dz"))&&L.visible===!0}))==null?void 0:d.visible)??!1),C(((D=x.find(L=>{var S;return((S=L==null?void 0:L.customType)==null?void 0:S.includes("pdz"))&&L.visible===!0}))==null?void 0:D.visible)??!1)))},[f.url]),i.useLayoutEffect(()=>{const d=[];t&&d.push(e.jsx(at,{values:t,isFirst:!0},$())),r&&d.push(e.jsx(at,{values:r,isFirst:!1},$())),c&&d.push(e.jsx(at,{values:c,isFirst:!1},$())),p(d)},[t,r,c]),g===z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{limitVisibleHandler:T,isDisplayDz:j,isDisplayPdz:w}),e.jsx(o,{sx:{display:"flex",width:"100%",...R},children:b})]}),e.jsx(o,{sx:{width:"100%",display:"flex"},children:e.jsx(Y,{useResizeHandler:!0,data:structuredClone(x),layout:{...structuredClone(l),width:s,height:u},config:J.GetConfig(),onUpdate:d=>y=d,onLegendClick:d=>h(d)})})]})},ar=({isOpen:s,cbClose:u})=>{const a=v(O),[g,t]=i.useState(new Date),[r,c]=i.useState(""),[b,p]=i.useState(""),[l,x]=i.useState(""),[j,n]=i.useState("");return e.jsxs(Ce,{styles:{content:{borderRadius:"15px"},body:{overflowY:"hidden"},header:{color:"#003274",...M},title:{fontSize:"1.2em",fontWeight:"bold"}},opened:s,onClose:()=>u(!1),title:a.offlineMeasureFHALabel,size:"30%",children:[e.jsxs(o,{children:[e.jsx($e,{dateValue:g,getValue:t,label:a.dateLabel,colorLable:"#003274",limitDate:Date.now()}),e.jsx(se,{styles:{root:{...Ne}},placeholder:a.acidNumberLabel,value:r,onChange:w=>c(w.currentTarget.value)}),e.jsx(se,{styles:{root:{...Ne}},placeholder:a.moistureLabel,value:b,onChange:w=>p(w.currentTarget.value)}),e.jsx(se,{styles:{root:{...Ne}},placeholder:a.turbidityLabel,value:l,onChange:w=>x(w.currentTarget.value)}),e.jsx(se,{styles:{root:{...Ne}},placeholder:a.viscosityLabel,value:j,onChange:w=>n(w.currentTarget.value)})]}),e.jsx(ie,{styles:{root:{zIndex:1,margin:"1%",background:"linear-gradient(to top, #003274, #416eb1)",border:"1px solid #003274",boxShadow:"3px 3px 3px gray","&:active":{boxShadow:"3px 3px 3px transparent"}},label:{...R}},onClick:()=>{console.log("Data send"),t(new Date),c(""),p(""),x(""),n("")},children:a.sendLabel})]})},Ne={margin:"1% 0"},nr=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const d=window.matchMedia(A);return d.addEventListener("change",D=>_(g,D.matches)),()=>d.removeEventListener("change",_)},[]);const t=B(),r=v(En),c=v(O),b=v(Rn),p=v(Hn),[l,x]=i.useState(),[j,n]=i.useState(),[w,C]=i.useState();let y=null;const T=(d,D)=>{let L=[];d==="dz"&&(x(D),L=y.data.filter(S=>S.mode!=="none"&&S.visible===!0).map(S=>`${S.name}_dz`)),d==="pdz"&&(n(D),L=y.data.filter(S=>S.mode!=="none"&&S.visible===!0).map(S=>`${S.name}_pdz`)),y.data.forEach(S=>{L.includes(S.customType)&&(S.visible=D)}),t(Tt(y.data)),t(Ct(y.layout))},h=d=>{setTimeout(()=>{try{let D=d.data[d.curveNumber];m(d),y.data.forEach(L=>{L.customType===`${D.name}_dz`&&(L.visible=!!(l&&D.visible===!0)),L.customType===`${D.name}_pdz`&&(L.visible=!!(j&&D.visible===!0))}),t(Tt(y.data)),t(Ct(y.layout))}catch(D){console.log("MOISTURE TAB ERROR"),console.log(D)}},500)},m=d=>{oe(d,y.layout),le(y.layout)},f=q();return i.useEffect(()=>{var d,D;f.url!==null&&f.url.length>0&&(r===z.idle||r===z.error?f.codeTab==="humidity"&&t(bs(f)):f.codeTab==="humidity"&&(x(((d=p.find(L=>{var S;return((S=L==null?void 0:L.customType)==null?void 0:S.includes("dz"))&&L.visible===!0}))==null?void 0:d.visible)??!1),n(((D=p.find(L=>{var S;return((S=L==null?void 0:L.customType)==null?void 0:S.includes("pdz"))&&L.visible===!0}))==null?void 0:D.visible)??!1)))},[f.url]),r===z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{limitVisibleHandler:T,isDisplayDz:l,isDisplayPdz:j}),e.jsx(ie,{styles:{root:{...ke(a)},label:{...R}},onClick:()=>C(!0),children:c.offlineMeasureFHALabel})]}),e.jsx(Y,{useResizeHandler:!0,data:structuredClone(p),layout:{...structuredClone(b),width:s,height:u-30},config:J.GetConfig(),onUpdate:d=>y=d,onLegendClick:d=>h(d)}),e.jsx(ar,{isOpen:w,cbClose:C})]})},lr=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const x=window.matchMedia(A);return x.addEventListener("change",j=>_(g,j.matches)),()=>x.removeEventListener("change",_)},[]);const t=B(),r=v(In),c=v(O),b=v(Mn),p=v(An),l=q();return i.useEffect(()=>{l.url!==null&&l.url.length>0&&(r===z.idle||r===z.error)&&l.codeTab==="humidity"&&l.codeSubTab==="hysteresis"&&t(ms(l))},[l.url]),r===z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsx(o,{sx:{...R,...F,marginLeft:"1%",fontSize:a?"1em":"1.2em"},children:c.hysteresisChartLabel}),e.jsx(Y,{useResizeHandler:!0,data:structuredClone(p),layout:{...structuredClone(b),width:s,height:u-30},config:J.GetConfig()})]})},or=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const l=window.matchMedia(A);return l.addEventListener("change",x=>_(g,x.matches)),()=>l.removeEventListener("change",_)},[]);const t=B(),r=v(O),[c,b]=i.useState("charts"),p=l=>{t(je(l)),b(l)};return e.jsxs(I,{value:c,onTabChange:l=>p(l),styles:{root:{marginTop:"2px"},tab:{...R,fontSize:a?"0.8em":"1em",color:"#003274","&:hover":{background:"#003274",color:"white"}}},children:[e.jsxs(I.List,{children:[e.jsx(ae,{label:r.chartsLabel,color:"#003274",withArrow:!0,position:"top",children:e.jsx(I.Tab,{value:"charts",children:r.chartsLabel})}),e.jsx(ae,{label:r.hysteresisLabel,color:"#003274",withArrow:!0,position:"top",children:e.jsx(I.Tab,{value:"hysteresis",children:r.hysteresisLabel})})]}),e.jsx(I.Panel,{value:"charts",pt:"xs",children:e.jsx(nr,{width:s-20,height:u-50})}),e.jsx(I.Panel,{value:"hysteresis",pt:"xs",children:e.jsx(lr,{width:s-20,height:u-50})})]})},rr=({width:s,height:u})=>{const a=B(),g=v(_n),t=v(Pn),r=v($n),[c,b]=i.useState(!1),[p,l]=i.useState(!1);let x=null;const j=(y,T)=>{let h=[];y==="dz"&&(b(T),h=x.data.filter(m=>m.mode!=="none"&&m.visible===!0).map(m=>`${m.name}_dz`)),y==="pdz"&&(l(T),h=x.data.filter(m=>m.mode!=="none"&&m.visible===!0).map(m=>`${m.name}_pdz`)),x.data.forEach(m=>{h.includes(m.customType)&&(m.visible=T)}),a(St(x.data)),a(Lt(x.layout))},n=y=>{setTimeout(()=>{try{let T=y.data[y.curveNumber];w(y),x.data.forEach(h=>{h.customType===`${T.name}_dz`&&(h.visible=!!(c&&T.visible===!0)),h.customType===`${T.name}_pdz`&&(h.visible=!!(p&&T.visible===!0))}),a(St(x.data)),a(Lt(x.layout))}catch(T){console.log("TEMPERATURE TAB ERROR"),console.log(T)}},500)},w=y=>{oe(y,x.layout),le(x.layout)},C=q();return i.useEffect(()=>{var y,T;C.url!==null&&C.url.length>0&&(g===z.idle||g===z.error?C.codeTab==="temperature"&&a(ws(C)):C.codeTab==="temperature"&&(b(((y=r.find(h=>{var m;return((m=h==null?void 0:h.customType)==null?void 0:m.includes("dz"))&&h.visible===!0}))==null?void 0:y.visible)??!1),l(((T=r.find(h=>{var m;return((m=h==null?void 0:h.customType)==null?void 0:m.includes("pdz"))&&h.visible===!0}))==null?void 0:T.visible)??!1)))},[C.url]),g===z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsx(o,{sx:{display:"flex",alignItems:"center"},children:e.jsx(ne,{limitVisibleHandler:j,isDisplayDz:c,isDisplayPdz:p})}),e.jsx(Y,{useResizeHandler:!0,data:structuredClone(r),layout:{...structuredClone(t),width:s,height:u},config:J.GetConfig(),onUpdate:y=>x=y,onLegendClick:y=>n(y)})]})},ir=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const h=window.matchMedia(A);return h.addEventListener("change",m=>_(g,m.matches)),()=>h.removeEventListener("change",_)},[]);const t=B(),r=v(On),c=v(Gn),b=v(Bn),[p,l]=i.useState(),[x,j]=i.useState();let n=null;const w=(h,m)=>{let f=[];h==="dz"&&(l(m),f=n.data.filter(d=>d.mode!=="none"&&d.visible===!0).map(d=>`${d.name}_dz`)),h==="pdz"&&(j(m),f=n.data.filter(d=>d.mode!=="none"&&d.visible===!0).map(d=>`${d.name}_pdz`)),n.data.forEach(d=>{f.includes(d.customType)&&(d.visible=m)}),t(Dt(n.data)),t(zt(n.layout))},C=h=>{setTimeout(()=>{let m=h.data[h.curveNumber];try{y(h),n.data.forEach(f=>{f.customType===`${m.name}_dz`&&(f.visible=!!(p&&m.visible===!0)),f.customType===`${m.name}_pdz`&&(f.visible=!!(x&&m.visible===!0))})}catch(f){console.log("GASES TAB ERROR"),console.log(f)}t(Dt(n.data)),t(zt(n.layout))},500)},y=h=>{oe(h,n.layout),le(n.layout)},T=q();return i.useEffect(()=>{var h,m;T.url!==null&&T.url.length>0&&(r===z.idle||r===z.error?T.codeTab==="its"&&t(Ls(T)):T.codeTab==="its"&&(l(((h=b.find(f=>{var d;return((d=f==null?void 0:f.customType)==null?void 0:d.includes("dz"))&&f.visible===!0}))==null?void 0:h.visible)??!1),j(((m=b.find(f=>{var d;return((d=f==null?void 0:f.customType)==null?void 0:d.includes("pdz"))&&f.visible===!0}))==null?void 0:m.visible)??!1)))},[T.url]),r===z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsx(o,{sx:{display:"flex",alignItems:"center"},children:e.jsx(ne,{limitVisibleHandler:w,isDisplayDz:p,isDisplayPdz:x})}),e.jsx(Y,{useResizeHandler:!0,data:structuredClone(b),layout:{...structuredClone(c),width:s,height:u},config:J.GetConfig(),onUpdate:h=>n=h,onLegendClick:h=>C(h)})]})},cr=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const h=window.matchMedia(A);return h.addEventListener("change",m=>_(g,m.matches)),()=>h.removeEventListener("change",_)},[]);const t=B(),r=v(Fn),c=v(Nn),b=v(Zn),[p,l]=i.useState(),[x,j]=i.useState();let n=null;const w=(h,m)=>{let f=[];h==="dz"&&(l(m),f=n.data.filter(d=>d.mode!=="none"&&d.visible===!0).map(d=>`${d.name}_dz`)),h==="pdz"&&(j(m),f=n.data.filter(d=>d.mode!=="none"&&d.visible===!0).map(d=>`${d.name}_pdz`)),n.data.forEach(d=>{f.includes(d.customType)&&(d.visible=m)}),t(kt(n.data)),t(Et(n.layout))},C=h=>{setTimeout(()=>{try{let m=h.data[h.curveNumber];y(h),n.data.forEach(f=>{f.customType===`${m.name}_dz`&&(f.visible=!!(p&&m.visible===!0)),f.customType===`${m.name}_pdz`&&(f.visible=!!(x&&m.visible===!0))}),t(kt(n.data)),t(Et(n.layout))}catch(m){console.log("WEAR TAB ERROR"),console.log(m)}},500)},y=h=>{oe(h,n.layout),le(n.layout)},T=q();return i.useEffect(()=>{var h,m;T.url!==null&&T.url.length>0&&(r===z.idle||r===z.error?T.codeTab==="wear"&&t(Ss(T)):T.codeTab==="wear"&&(l(((h=b.find(f=>{var d;return((d=f==null?void 0:f.customType)==null?void 0:d.includes("dz"))&&f.visible===!0}))==null?void 0:h.visible)??!1),j(((m=b.find(f=>{var d;return((d=f==null?void 0:f.customType)==null?void 0:d.includes("pdz"))&&f.visible===!0}))==null?void 0:m.visible)??!1)))},[T.url]),r===z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsx(o,{sx:{display:"flex",alignItems:"center"},children:e.jsx(ne,{limitVisibleHandler:w,isDisplayDz:p,isDisplayPdz:x})}),e.jsx(Y,{useResizeHandler:!0,data:structuredClone(b),layout:{...structuredClone(c),width:s,height:u-30},config:J.GetConfig(),onUpdate:h=>n=h,onLegendClick:h=>C(h)})]})},dr=({isOpen:s,cbClose:u})=>{const a=v(O),[g,t]=i.useState(new Date),[r,c]=i.useState(""),[b,p]=i.useState(""),[l,x]=i.useState(""),[j,n]=i.useState(""),[w,C]=i.useState(""),[y,T]=i.useState("");return e.jsxs(Ce,{styles:{content:{borderRadius:"15px"},body:{overflowY:"hidden"},header:{color:"#003274",...M},title:{fontSize:"1.2em",fontWeight:"bold"}},opened:s,onClose:()=>u(!1),title:a.offlineMeasureBushing,size:"30%",children:[e.jsxs(o,{children:[e.jsx($e,{dateValue:g,getValue:t,label:a.dateLabel,colorLable:"#003274",limitDate:Date.now()}),e.jsx(o,{children:a.phaseALabel}),e.jsx(se,{styles:{root:{...Le}},placeholder:a.capacityLabel,value:r,onChange:h=>c(h.currentTarget.value)}),e.jsx(se,{styles:{root:{...Le}},placeholder:a.tgdLabel,value:b,onChange:h=>p(h.currentTarget.value)}),e.jsx(o,{children:a.phaseBLabel}),e.jsx(se,{styles:{root:{...Le}},placeholder:a.capacityLabel,value:l,onChange:h=>x(h.currentTarget.value)}),e.jsx(se,{styles:{root:{...Le}},placeholder:a.tgdLabel,value:j,onChange:h=>n(h.currentTarget.value)}),e.jsx(o,{children:a.phaseCLabel}),e.jsx(se,{styles:{root:{...Le}},placeholder:a.capacityLabel,value:w,onChange:h=>C(h.currentTarget.value)}),e.jsx(se,{styles:{root:{...Le}},placeholder:a.tgdLabel,value:y,onChange:h=>T(h.currentTarget.value)})]}),e.jsx(ie,{styles:{root:{zIndex:1,margin:"1%",background:"linear-gradient(to top, #003274, #416eb1)",border:"1px solid #003274",boxShadow:"3px 3px 3px gray","&:active":{boxShadow:"3px 3px 3px transparent"}},label:{...R}},onClick:()=>{console.log("Send data"),t(new Date),c(""),x(""),C(""),p(""),n(""),T("")},children:a.sendLabel})]})},Le={margin:"1% 0"},ur=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const d=window.matchMedia(A);return d.addEventListener("change",D=>_(g,D.matches)),()=>d.removeEventListener("change",_)},[]);const t=B(),r=v(Un),c=v(O),b=v(Qn),p=v(Wn),[l,x]=i.useState(),[j,n]=i.useState(),[w,C]=i.useState(!1);let y=null;const T=(d,D)=>{let L=[];d==="dz"&&(x(D),L=y.data.filter(S=>S.mode!=="none"&&S.visible===!0).map(S=>`${S.name}_dz`)),d==="pdz"&&(n(D),L=y.data.filter(S=>S.mode!=="none"&&S.visible===!0).map(S=>`${S.name}_pdz`)),y.data.forEach(S=>{L.includes(S.customType)&&(S.visible=D)}),t(Rt(y.data)),t(Ht(y.layout))},h=d=>{setTimeout(()=>{try{let D=d.data[d.curveNumber];m(d),y.data.forEach(L=>{L.customType===`${D.name}_dz`&&(L.visible=!!(l&&D.visible===!0)),L.customType===`${D.name}_pdz`&&(L.visible=!!(j&&D.visible===!0))}),t(Rt(y.data)),t(Ht(y.layout))}catch(D){console.log("BUSHING TAB ERROR"),console.log(D)}},500)},m=d=>{oe(d,y.layout),le(y.layout)},f=q();return i.useEffect(()=>{var d,D;f.url!==null&&f.url.length>0&&(r===z.idle||r===z.error?f.codeTab==="bushing"&&t(Cs(f)):f.codeTab==="bushing"&&(x(((d=p.find(L=>{var S;return((S=L==null?void 0:L.customType)==null?void 0:S.includes("dz"))&&L.visible===!0}))==null?void 0:d.visible)??!1),n(((D=p.find(L=>{var S;return((S=L==null?void 0:L.customType)==null?void 0:S.includes("pdz"))&&L.visible===!0}))==null?void 0:D.visible)??!1)))},[f.url]),r===z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{limitVisibleHandler:T,isDisplayDz:l,isDisplayPdz:j}),e.jsx(ie,{styles:{root:{...ke(a)},label:{...R}},onClick:()=>C(!0),children:c.offlineMeasureBushing})]}),e.jsx(Y,{useResizeHandler:!0,data:structuredClone(p),layout:{...structuredClone(b),width:s,height:u},config:J.GetConfig(),onUpdate:d=>y=d,onLegendClick:d=>h(d)}),e.jsx(dr,{SendData:()=>console.log("test"),isOpen:w,cbClose:C})]})},hr=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const h=window.matchMedia(A);return h.addEventListener("change",m=>_(g,m.matches)),()=>h.removeEventListener("change",_)},[]);const t=B(),r=v(Vn),c=v(Yn),b=v(Jn),[p,l]=i.useState(),[x,j]=i.useState();i.useState();let n=null;const w=(h,m)=>{let f=[];h==="dz"&&(l(m),f=n.data.filter(d=>d.mode!=="none"&&d.visible===!0).map(d=>`${d.name}_dz`)),h==="pdz"&&(j(m),f=n.data.filter(d=>d.mode!=="none"&&d.visible===!0).map(d=>`${d.name}_pdz`)),n.data.forEach(d=>{f.includes(d.customType)&&(d.visible=m)}),t(It(n.data)),t(Mt(n.layout))},C=h=>{h.data[h.curveNumber].mode!=="none"&&setTimeout(()=>{let m=h.data[h.curveNumber];y(h),n.data.forEach(f=>{f.customType===`${m.name}_dz`&&(f.visible=!!(p&&m.visible===!0)),f.customType===`${m.name}_pdz`&&(f.visible=!!(x&&m.visible===!0))}),t(It(n.data)),t(Mt(n.layout))},500)},y=h=>{oe(h,n.layout),le(n.layout)},T=q();return i.useEffect(()=>{var h,m;T.url!==null&&T.url.length>0&&(r===z.idle||r===z.error?T.codeTab==="pd"&&t(Ds(T)):T.codeTab==="pd"&&(l(((h=b.find(f=>{var d;return((d=f==null?void 0:f.customType)==null?void 0:d.includes("dz"))&&f.visible===!0}))==null?void 0:h.visible)??!1),j(((m=b.find(f=>{var d;return((d=f==null?void 0:f.customType)==null?void 0:d.includes("pdz"))&&f.visible===!0}))==null?void 0:m.visible)??!1)))},[T.url]),r===z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsx(o,{sx:{display:"flex",alignItems:"center"},children:e.jsx(ne,{limitVisibleHandler:w,isDisplayDz:p,isDisplayPdz:x})}),e.jsx(Y,{useResizeHandler:!0,data:structuredClone(b),layout:{...structuredClone(c),width:s,height:u-30},config:J.GetConfig(),onUpdate:h=>n=h,onLegendClick:h=>C(h)})]})},gr=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const h=window.matchMedia(A);return h.addEventListener("change",m=>_(g,m.matches)),()=>h.removeEventListener("change",_)},[]);const t=B(),r=v(Kn),c=v(qn),b=v(Xn),[p,l]=i.useState(),[x,j]=i.useState();let n=null;const w=(h,m)=>{let f=[];h==="dz"&&(l(m),f=n.data.filter(d=>d.mode!=="none"&&d.visible===!0).map(d=>`${d.name}_dz`)),h==="pdz"&&(j(m),f=n.data.filter(d=>d.mode!=="none"&&d.visible===!0).map(d=>`${d.name}_pdz`)),n.data.forEach(d=>{f.includes(d.customType)&&(d.visible=m)}),t(At(n.data)),t(_t(n.layout))},C=h=>{h.data[h.curveNumber].mode!=="none"&&setTimeout(()=>{let m=h.data[h.curveNumber];y(h),n.data.forEach(f=>{f.customType===`${m.name}_dz`&&(f.visible=!!(p&&m.visible===!0)),f.customType===`${m.name}_pdz`&&(f.visible=!!(x&&m.visible===!0))}),t(At(n.data)),t(_t(n.layout))},500)},y=h=>{oe(h,n.layout),le(n.layout)},T=q();return i.useEffect(()=>{var h,m;T.url!==null&&T.url.length>0&&(r===z.idle||r===z.error?T.codeTab==="sf6"&&t(zs(T)):T.codeTab==="sf6"&&(l(((h=b.find(f=>{var d;return((d=f==null?void 0:f.customType)==null?void 0:d.includes("dz"))&&f.visible===!0}))==null?void 0:h.visible)??!1),j(((m=b.find(f=>{var d;return((d=f==null?void 0:f.customType)==null?void 0:d.includes("pdz"))&&f.visible===!0}))==null?void 0:m.visible)??!1)))},[T.url]),r===z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsx(o,{sx:{display:"flex",alignItems:"center"},children:e.jsx(ne,{limitVisibleHandler:w,isDisplayDz:p,isDisplayPdz:x})}),e.jsx(Y,{useResizeHandler:!0,data:structuredClone(b),layout:{...structuredClone(c),width:s,height:u-30},config:J.GetConfig(),onUpdate:h=>n=h,onLegendClick:h=>C(h)})]})},fr=()=>{const[s,u]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const l=window.matchMedia(A);return l.addEventListener("change",x=>{_(u,x.matches)}),()=>l.removeEventListener("change",_)},[]);const a=v(el),g=v(tl),t=v(sl),[r,c]=i.useState(),[b,p]=i.useState(null);return i.useLayoutEffect(()=>{try{if(a){console.log(a);const l=[],x=structuredClone(a);x.shift().forEach((j,n)=>{l.push(e.jsx(tt.Col,{span:n==0?4:8,style:{border:"1px solid black",borderLeft:n==0?"1px solid black":"0",padding:"0",textAlign:"center",...R},children:j.value},$()))}),x.forEach((j,n)=>{l.push(j.map((w,C)=>e.jsx(tt.Col,{span:C==0?4:1,style:{borderTop:n==0?"":"1px solid black",borderLeft:C==0?"1px solid black":"0",borderBottom:x.length-1==n?"1px solid black":"0",borderRight:"1px solid black",padding:"0",textAlign:"center",background:w.hasOwnProperty("selected")&&w.selected>0?"rgb(34, 139, 230)":"transparent",...R},children:w.value},$())))}),c(l)}if(t){const l=t.map(x=>e.jsx("tr",{children:x.map((j,n)=>e.jsx("td",{style:{border:"1px solid black",textAlign:n>0?"center":"",...R},children:j.value==null||j.value==null?"-":j.value},$()))},$()));p(l)}}catch(l){console.log("COEFLOADCAPACITYTABLE ERROR"),console.log(l)}},[a,g,t]),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[e.jsx(o,{sx:{...M,textAlign:"center"},children:g}),e.jsx(tt,{style:{width:"99.8%",margin:"2% 0"},children:r}),e.jsxs(ue,{style:{margin:"1% 0"},children:[e.jsx("thead",{}),e.jsx("tbody",{children:b})]})]})},xr=({width:s,height:u})=>{const a=B(),g=v(al),t=v(nl),r=v(ll),[c,b]=i.useState(),[p,l]=i.useState();let x=null;const j=(y,T)=>{let h=[];y==="dz"&&(b(T),h=x.data.filter(m=>m.mode!=="none"&&m.visible===!0).map(m=>`${m.name}_dz`)),y==="pdz"&&(l(T),h=x.data.filter(m=>m.mode!=="none"&&m.visible===!0).map(m=>`${m.name}_pdz`)),x.data.forEach(m=>{h.includes(m.customType)&&(m.visible=T)}),a(Pt(x.data)),a($t(x.layout))},n=y=>{setTimeout(()=>{try{let T=y.data[y.curveNumber];w(y),x.data.forEach(h=>{h.customType===`${T.name}_dz`&&(h.visible=!!(c&&T.visible===!0)),h.customType===`${T.name}_pdz`&&(h.visible=!!(p&&T.visible===!0))}),a(Pt(x.data)),a($t(x.layout))}catch(T){console.log("TEMPERATURE TAB ERROR"),console.log(T)}},500)},w=y=>{oe(y,x.layout),le(x.layout)},C=q();return i.useEffect(()=>{var y,T;C.url!==null&&C.url.length>0&&(g===z.idle||g===z.error?C.codeTab==="loadcapacity"&&a(vs(C)):C.codeTab==="loadcapacity"&&(b(((y=r.find(h=>{var m;return((m=h==null?void 0:h.customType)==null?void 0:m.includes("dz"))&&h.visible===!0}))==null?void 0:y.visible)??!1),l(((T=r.find(h=>{var m;return((m=h==null?void 0:h.customType)==null?void 0:m.includes("pdz"))&&h.visible===!0}))==null?void 0:T.visible)??!1)))},[C.url]),g===z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsx(o,{sx:{display:"flex",alignItems:"center"},children:e.jsx(ne,{limitVisibleHandler:j,isDisplayDz:c,isDisplayPdz:p})}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx(Y,{useResizeHandler:!0,data:structuredClone(r),layout:{...structuredClone(t),width:s/100*69,height:u},config:J.GetConfig(),onUpdate:y=>x=y,onLegendClick:y=>n(y)}),e.jsx(o,{sx:{width:"30%",height:`${u}px`,overflowY:"scroll"},children:e.jsx(fr,{})})]})]})},br=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const h=window.matchMedia(A);return h.addEventListener("change",m=>_(g,m.matches)),()=>h.removeEventListener("change",_)},[]);const t=B(),r=v(ol),c=v(rl),b=v(il),[p,l]=i.useState(),[x,j]=i.useState();let n=null;const w=(h,m)=>{let f=[];h==="dz"&&(l(m),f=n.data.filter(d=>d.mode!=="none"&&d.visible===!0).map(d=>`${d.name}_dz`)),h==="pdz"&&(j(m),f=n.data.filter(d=>d.mode!=="none"&&d.visible===!0).map(d=>`${d.name}_pdz`)),n.data.forEach(d=>{f.includes(d.customType)&&(d.visible=m)}),t(Ot(n.data)),t(Gt(n.layout))},C=h=>{setTimeout(()=>{let m=h.data[h.curveNumber];try{y(h),n.data.forEach(f=>{f.customType===`${m.name}_dz`&&(f.visible=!!(p&&m.visible===!0)),f.customType===`${m.name}_pdz`&&(f.visible=!!(x&&m.visible===!0))})}catch(f){console.log("GASES TAB ERROR"),console.log(f)}t(Ot(n.data)),t(Gt(n.layout))},500)},y=h=>{oe(h,n.layout),le(n.layout)},T=q();return i.useEffect(()=>{var h,m;T.url!==null&&T.url.length>0&&(r===z.idle||r===z.error?T.codeTab==="ltc"&&t(ks(T)):T.codeTab==="ltc"&&(l(((h=b.find(f=>{var d;return((d=f==null?void 0:f.customType)==null?void 0:d.includes("dz"))&&f.visible===!0}))==null?void 0:h.visible)??!1),j(((m=b.find(f=>{var d;return((d=f==null?void 0:f.customType)==null?void 0:d.includes("pdz"))&&f.visible===!0}))==null?void 0:m.visible)??!1)))},[T.url]),r===z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsx(o,{sx:{display:"flex",alignItems:"center"},children:e.jsx(ne,{limitVisibleHandler:w,isDisplayDz:p,isDisplayPdz:x})}),e.jsx(Y,{useResizeHandler:!0,data:structuredClone(b),layout:{...structuredClone(c),width:s,height:u},config:J.GetConfig(),onUpdate:h=>n=h,onLegendClick:h=>C(h)})]})},mr=({width:s,height:u})=>{const[a,g]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const h=window.matchMedia(A);return h.addEventListener("change",m=>_(g,m.matches)),()=>h.removeEventListener("change",_)},[]);const t=B();v(ce);const r=v(cl);v(Ge),v(Je),v(ft),v(xt);const c=v(dl),b=v(ul),[p,l]=i.useState(),[x,j]=i.useState();let n=null;const w=(h,m)=>{let f=[];h==="dz"&&(l(m),f=n.data.filter(d=>d.mode!=="none"&&d.visible===!0).map(d=>`${d.name}_dz`)),h==="pdz"&&(j(m),f=n.data.filter(d=>d.mode!=="none"&&d.visible===!0).map(d=>`${d.name}_pdz`)),n.data.forEach(d=>{f.includes(d.customType)&&(d.visible=m)}),t(Bt(n.data)),t(Ft(n.layout))},C=h=>{setTimeout(()=>{let m=h.data[h.curveNumber];try{y(h),n.data.forEach(f=>{f.customType===`${m.name}_dz`&&(f.visible=!!(p&&m.visible===!0)),f.customType===`${m.name}_pdz`&&(f.visible=!!(x&&m.visible===!0))})}catch(f){console.log("GASES TAB ERROR"),console.log(f)}t(Bt(n.data)),t(Ft(n.layout))},500)},y=h=>{oe(h,n.layout),le(n.layout)},T=q();return i.useEffect(()=>{var h,m;T.url!==null&&T.url.length>0&&(r===z.idle||r===z.error?T.codeTab==="power"&&t(ys(T)):T.codeTab==="power"&&(l(((h=b.find(f=>{var d;return((d=f==null?void 0:f.customType)==null?void 0:d.includes("dz"))&&f.visible===!0}))==null?void 0:h.visible)??!1),j(((m=b.find(f=>{var d;return((d=f==null?void 0:f.customType)==null?void 0:d.includes("pdz"))&&f.visible===!0}))==null?void 0:m.visible)??!1)))},[T.url]),r===z.loading?e.jsx(K,{height:75}):e.jsxs(o,{children:[e.jsx(o,{sx:{display:"flex",alignItems:"center"},children:e.jsx(ne,{limitVisibleHandler:w,isDisplayDz:p,isDisplayPdz:x})}),e.jsx(Y,{useResizeHandler:!0,data:structuredClone(b),layout:{...structuredClone(c),width:s,height:u},config:J.GetConfig(),onUpdate:h=>n=h,onLegendClick:h=>C(h)})]})},pr=()=>{const[s,u]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const C=window.matchMedia(A);return C.addEventListener("change",y=>_(u,y.matches)),()=>C.removeEventListener("change",_)},[]);const a=B(),g=v(O),t=v(hl),r=v(Ge),c=v(Je),[b,p]=i.useState(null),[l,x]=i.useState(null);i.useLayoutEffect(()=>{try{if(t&&r){const C=t.find(y=>y.asset_type===r.elementType).tabs;x(C),c?p(c):t&&(p(C[0]),a(_e(C[0])),a(je("charts")))}}catch(C){console.log("Tabs chart ERROR"),console.log(C)}},[r,c,t]),i.useEffect(()=>()=>{a(_e(null)),a(je(null))},[]);const j=C=>{a(_e(C)),p(C)},n=i.useRef(null),w=Fe(n);return e.jsx(o,{ref:n,sx:{height:"80vh"},children:e.jsxs(I,{value:b,onTabChange:C=>j(C),styles:{root:{marginTop:"2px"},tab:{...R,fontSize:s?"0.8em":"1em",color:"#003274","&:hover":{background:"#003274",color:"white"}}},children:[e.jsxs(I.List,{children:[e.jsx(I.Tab,{style:{display:l&&l.includes("gases")?"block":"none"},value:"gases",children:g.gasesLabel}),e.jsx(I.Tab,{style:{display:l&&l.includes("power")?"block":"none"},value:"power",children:g.powerLabel}),e.jsx(I.Tab,{style:{display:l&&l.includes("overvoltage")?"block":"none"},value:"overvoltage",children:g.overvoltageLabel}),e.jsx(I.Tab,{style:{display:l&&l.includes("loadcapacity")?"block":"none"},value:"loadcapacity",children:g.loadCapacityLabel}),e.jsx(I.Tab,{style:{display:l&&l.includes("humidity")?"block":"none"},value:"humidity",children:g.moistureLabel}),e.jsx(I.Tab,{style:{display:l&&l.includes("temperature")?"block":"none"},value:"temperature",children:g.temperatureLabel}),e.jsx(I.Tab,{style:{display:l&&l.includes("bushing")?"block":"none"},value:"bushing",children:g.bushingLabel}),e.jsx(I.Tab,{style:{display:l&&l.includes("wear")?"block":"none"},value:"wear",children:g.ageingLabel}),e.jsx(I.Tab,{style:{display:l&&l.includes("its")?"block":"none"},value:"its",children:g.health}),e.jsx(I.Tab,{style:{display:l&&l.includes("sf6")?"block":"none"},value:"sf6",children:g.sf6Label}),e.jsx(I.Tab,{style:{display:l&&l.includes("pd")?"block":"none"},value:"pd",children:g.partialDischargeLabel}),e.jsx(I.Tab,{style:{display:l&&l.includes("ltc")?"block":"none"},value:"ltc",children:g.ltcLabel})]}),e.jsx(I.Panel,{value:"gases",pt:"xs",children:e.jsx(tr,{width:w.width,height:w.height-50})}),e.jsx(I.Panel,{value:"power",pt:"xs",children:e.jsx(mr,{width:w.width,height:w.height-50})}),e.jsx(I.Panel,{value:"overvoltage",pt:"xs",children:e.jsx(sr,{width:w.width,height:w.height-80})}),e.jsx(I.Panel,{value:"loadcapacity",pt:"xs",children:e.jsx(xr,{width:w.width,height:w.height-50})}),e.jsx(I.Panel,{value:"humidity",pt:"xs",children:e.jsx(or,{width:w.width,height:w.height-50})}),e.jsx(I.Panel,{value:"temperature",pt:"xs",children:e.jsx(rr,{width:w.width,height:w.height-50})}),e.jsx(I.Panel,{value:"bushing",pt:"xs",children:e.jsx(ur,{width:w.width,height:w.height-50})}),e.jsx(I.Panel,{value:"its",pt:"xs",children:e.jsx(ir,{width:w.width,height:w.height-50})}),e.jsx(I.Panel,{value:"wear",pt:"xs",children:e.jsx(cr,{width:w.width,height:w.height-50})}),e.jsx(I.Panel,{value:"pd",pt:"xs",children:e.jsx(hr,{width:w.width,height:w.height})}),e.jsx(I.Panel,{value:"sf6",pt:"xs",children:e.jsx(gr,{width:w.width,height:w.height})}),e.jsx(I.Panel,{value:"ltc",pt:"xs",children:e.jsx(br,{width:w.width,height:w.height-50})})]})})},Vt=()=>{const s=Oe(),u=B(),a=v(ls);return i.useLayoutEffect(()=>{(a===z.idle||a===z.error)&&u(is()).then(g=>{console.log(g.payload.substations),console.log(s);const t=g.payload.substations.find(c=>c.id==+s.id),r=t.assets.find(c=>c.asset_id==+s.assetid);u(ss({...t,subst_id:t.id})),u(Ye({asset:r.name,elementId:r.asset_id,elementType:r.asset_type,substId:+s.id})),u(gs({id:s.assetid,isTimer:!1})),u(_e("gases")),u(je("charts"))})},[]),a===z.loading?e.jsx(K,{height:90}):e.jsxs(o,{sx:{width:"100%"},children:[e.jsx(o,{sx:{height:"4%",padding:"0 1%"},children:e.jsx(Ho,{})}),e.jsx(pr,{})]})},yr=()=>{const s=B(),u=v(O),a=v(Es),g=v(Be),[t,r]=i.useState(null),[c,b]=i.useState(null),[p,l]=i.useState(null),x=i.useRef(null),j=Fe(x);i.useLayoutEffect(()=>{j!==null&&l({width:j.width,height:j.height})},[j.width,j.height]);const[n,w]=i.useState();i.useEffect(()=>{if(a){const T=g==null?void 0:g.schema;if(T!=null){r(T);const h=a.map(m=>{var f;return e.jsx(ae,{label:m.name,withArrow:!0,position:"right",styles:{tooltip:{background:"#003274",color:"white"}},children:e.jsx(ut,{to:`/substation/${g.subst_id}/${m.asset_type}/${m.asset_id}`,style:{position:"absolute",left:`${m.on_scheme_x}%`,top:`${m.on_scheme_y}%`},onClick:()=>s(Ye({asset:m.name,elementId:m.asset_id,elementType:m.asset_type,substId:g.subst_id})),children:e.jsx(it,{src:(f=de.find(d=>d.title===m.status))==null?void 0:f.icon,width:j.width/100*4,height:j.width/100*4})},$())},$())});w(h)}else r(null)}},[a]);const C=()=>{let T,h,m=c.width/c.height,f=p.width/p.height;return m>f?(T=p.width,h=c.height*(p.width/c.width)):(h=p.height,T=c.width*(p.height/c.height)),{width:T,height:h}};let y=null;return c!==null&&p!==null&&(y=C()),t==null?e.jsx(o,{ref:x,sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",overflowY:"auto"},children:e.jsx(o,{sx:{...F,...M},children:u.substSchemaNotInstalledLabel})}):e.jsxs(o,{ref:x,sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",overflowY:"auto",position:"relative"},children:[e.jsx($s,{imageUrl:t,cbGetSize:b}),e.jsx(o,{sx:{position:"absolute",width:`${y!==null?y.width:0}px`,height:`${y!==null?y.height:0}px`},children:n})]})},vr=()=>{const[s,u]=i.useState(window.matchMedia(A).matches);i.useEffect(()=>{const h=window.matchMedia(A);return h.addEventListener("change",m=>_(u,m.matches)),()=>h.removeEventListener("change",_)},[]);const a=rt(),g=B(),t=v(ce),r=v(O),c=v(Be),b=v(Es),[p,l]=i.useState(["All"]),[x,j]=i.useState([]),[n,w]=i.useState([]),C=i.useRef(null);i.useEffect(()=>{try{const h={showlegend:!1,xaxis:{showgrid:!1,zeroline:!1,showticklabels:!1,type:"date",tickformat:"%Y-%m-%d %H:%M",hoverformat:"%Y-%m-%d %H:%M"},yaxis:{showgrid:!1,zeroline:!1,showticklabels:!1},margin:{l:1,r:1,t:1,b:1}};if(c){const m=b.map(f=>{var Z,V;const d=((Z=C.current)==null?void 0:Z.clientWidth)/100*50,D=((V=C.current)==null?void 0:V.clientHeight)/100*5,L=[{x:f.tci_period.map(W=>W[0]),y:f.tci_period.map(W=>W[1]),type:"scatter",mode:"lines",line:{color:"rgba(28, 165, 26, 0.8)",width:2,shape:"spline",smoothing:.5}}];return{state:f.status,asset:f.name,its:e.jsx(o,{id:"1",sx:{margin:"5px 0px",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(o,{sx:{margin:"0 1%",fontSize:"0.9em",fontFamily:R.fontFamily},children:f.tci_last}),e.jsx(Y,{useResizeHandler:!0,data:L,layout:{...structuredClone(h),width:d,height:D},config:{...J.GetConfig(),scrollZoom:!1,staticPlot:!1,dragmode:""}})]})}),elementType:f.asset_type,elementId:f.asset_id,stateInner:f.status,level:de.find(W=>W.title===f.status).levelState,substId:c.subst_id}}).sort(function(f,d){return f.level>d.level?1:f.level<d.level?-1:0});j(m)}r&&w([{value:"All",label:r.allLabel},{value:"Good",label:r.normalLabel},{value:"Dangerous",label:r.dangerousLabel},{value:"Warning",label:r.warningLabel}])}catch{}},[c,t,b]);const y=i.useMemo(()=>[{accessorKey:"asset",header:r.assetLabel,size:0,enableSorting:!1,Cell:({cell:h})=>e.jsxs(o,{sx:{width:"95%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0",fontSize:"1.1em"},children:[e.jsx(o,{sx:{padding:"5px"},children:h.row.original.asset}),e.jsx(it,{src:de.find(m=>m.title===h.row.original.state).icon,height:30,width:30})]})},{accessorKey:"its",header:r.health,filterFn:"contains",enableSorting:!1}],[t]),T=Xt({columns:y,data:x??[],enablePagination:!1,enableColumnActions:!1,enableFullScreenToggle:!1,enableDensityToggle:!1,enableColumnFilters:!1,localization:r,enableHiding:!1,initialState:{showGlobalFilter:!0},filterFns:{myCustomFilterFn:(h,m,f)=>{if(h.original.asset.toLowerCase().includes(f.toLowerCase()))return h}},globalFilterFn:"myCustomFilterFn",mantinePaperProps:{sx:{height:"calc(100% - 2%)",cursor:"pointer",overflowY:"auto"}},mantineTableProps:{highlightOnHover:!1,withColumnBorders:!1,h:x.length<=1?100:"",sx:{"thead > tr > th":{backgroundColor:"inherit",color:"#003274",...M,fontSize:s?"0.8em":"1em"},"tbody > tr > td":{padding:"0",backgroundColor:"inherit",color:"#003274",...R,fontSize:s?"0.8em":"1em"}}},mantineTableBodyCellProps:({cell:h})=>({onClick:m=>{g(Ye({asset:h.row.original.asset,elementId:h.row.original.elementId,elementType:h.row.original.elementType,substId:h.row.original.substId})),a(`/substation/${h.row.original.substId}/${h.row.original.elementType}/${h.row.original.elementId}`)}}),mantineTableHeadCellProps:{align:"center"},mantineTopToolbarProps:{sx:{".mantine-1knjhw7":{display:"block"}}},mantineSearchTextInputProps:{placeholder:r.serchByAssetLabel,sx:{width:"26vw"}},renderTopToolbarCustomActions:({table:h})=>e.jsxs(o,{sx:{display:"flex",alignItems:"center",marginBottom:"15px",...M,color:"rgb(0, 50, 116)",borderBottom:"1px solid gray"},children:[e.jsx(o,{sx:{marginRight:"5px"},children:r.statusLabel}),e.jsx(ta,{styles:{root:{width:"100%"},item:{color:"rgb(0, 50, 116)",...R},values:{color:"rgb(0, 50, 116)",...R}},transitionProps:{duration:300,transition:"pop-top-left",timingFunction:"ease"},data:n,value:p,onChange:m=>{const d=(m.includes("All")?b:b.filter(D=>m.includes(D.status))).map(D=>({state:D.status,asset:D.name,its:e.jsxs(o,{sx:{textAlign:"center"},children:[e.jsx(o,{children:D.tci_last}),e.jsx(sa,{value:D.tci_last,styles:{root:{background:"gray"}}})]}),elementType:D.asset_type,elementId:D.asset_id,stateInner:D.status,level:de.find(L=>L.title===D.status).levelState,substId:c.subst_id})).sort(function(D,L){return D.level>L.level?1:D.level<L.level?-1:0});j(d),l(m)},variant:"unstyled"})]})});return e.jsxs(o,{ref:C,sx:{width:"100%",height:"calc(100% - 2%)",color:"#003274",padding:"1% 0"},children:[e.jsx(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-around"},children:e.jsx(o,{sx:{...M,fontSize:s?"1em":"1.5em"},children:c==null?void 0:c.name})}),e.jsx(es,{table:T})]})},wr=()=>{const s=Oe(),u=B(),a=v(Be),g=v(gl);i.useLayoutEffect(()=>{(g===z.idle||g===z.error||(a==null?void 0:a.subst_id)!==+s.id)&&u(Nt(+s.id))},[u,s.id]);const t=v(ht);return os(()=>{u(Nt(+s.id))},t),e.jsxs(o,{sx:{display:"flex",height:"100%"},children:[e.jsx(o,{sx:{width:"15%",height:"100%"},children:e.jsx(rs,{})}),e.jsx(o,{sx:{width:"58%",height:"100%"},children:e.jsx(o,{sx:{width:"100%",height:"100%"},children:e.jsx(yr,{})})}),e.jsx(o,{sx:{width:"27%",height:"100%"},children:e.jsx(vr,{})})]})},nt=({productName:s,productLink:u,licenseName:a,licenseLinkText:g,copyrightText:t})=>e.jsx(o,{children:e.jsxs(o,{sx:{margin:"1% 0",color:"#003274",fontSize:"1.2em",textAlign:"center",...R},children:[e.jsxs(o,{children:[s,"  (",e.jsx("a",{target:"_blank",href:u,children:u}),")"]}),e.jsxs(o,{children:[a,"  (",e.jsx("a",{target:"_blank",href:g,children:g}),")"]}),e.jsx(o,{children:t})]})}),jr="2025-03-12T10:32:45.088Z",Tr={buildDate:jr},Cr=()=>{const s=v(O),u=Tr.buildDate.split("T")[0].replaceAll("-","");return e.jsxs(o,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsxs(o,{sx:{color:"#003274",textAlign:"center"},children:[e.jsx(o,{sx:{...M,fontSize:"2em"},children:s.headerLabelText}),e.jsxs(o,{sx:{...R},children:[s.buildLabel,": ",u]})]}),e.jsxs(o,{sx:{margin:"1% 0",...M,color:"#003274",fontSize:"1.2em"},children:[s.useMaterialsLabel,":"]}),e.jsxs(o,{sx:{width:"50%"},children:[e.jsx(nt,{productName:"Mantine",productLink:"https://mantine.dev/",licenseName:"MIT License",licenseLinkText:"https://opensource.org/license/mit",copyrightText:"Copyright (c) 2021 Vitaly Rtishchev"}),e.jsx(nt,{productName:"OpenLayers",productLink:"https://openlayers.org/",licenseName:"BSD 2-Clause License",licenseLinkText:"https://opensource.org/license/bsd-2-clause",copyrightText:"Copyright 2005-present, OpenLayers Contributors All rights reserved"}),e.jsx(nt,{productName:"idb",productLink:"github.com/jakearchibald/idb#readme",licenseName:"ISC License",licenseLinkText:"https://github.com/jakearchibald/idb#ISC-1-ov-file",copyrightText:"Copyright (c) 2016, Jake Archibald <jaffathecake@gmail.com>"})]})]})},Sr=(s,u,a)=>`${Qe}/modelsStats?assetGuid=${s}&dateStart=${u.toJSON()}&dateEnd=${a.toJSON()}`,Lr=(s,u,a,g)=>`${Qe}/modelStats?assetGuid=${s}&modelCode=${u}&dateStart=${a.toJSON()}&dateEnd=${g.toJSON()}`;function Dr(s){const u=v(O),[a,g]=i.useState(null),[t,r]=i.useState(!1),c=v(Rs),b=v(Hs),p=v(Is),l=Ae(()=>fetch(Lr(c,a,b,p)).then(y=>y.json()).then(y=>y.stats),[]),x=[{id:"code",header:u.codeLabel||"Code",accessorFn:y=>y.code!==null?e.jsx(o,{px:2,children:y.diagnostic}):null},{id:"lastStats",header:u.lastStatsLabel||"Status",accessorFn:y=>y.code!==null?e.jsx(o,{px:2,children:e.jsx(aa,{color:y.message?"red":"green"})}):null},{id:"last_message",accessorKey:"message",header:u.errorMessageLabel||"Error Message"},{id:"last_datetime",header:u.datetimeLabel||"Datetime",minSize:75,accessorFn:y=>y.timestamp?Zt(y.timestamp):null},{id:"chart_button",header:u.chartLabel||"Chart",minSize:10,maxSize:30,accessorFn:y=>e.jsx(ie,{onClick:()=>{r(!0),g(y.diagnostic)},sx:{background:"#003274"},children:e.jsx(na,{})})}],j=Xt({columns:x,data:s.modelsStatsApi.data||[],enableExpanding:!1,enableExpandAll:!1,enableColumnActions:!1,enableColumnFilters:!1,enablePagination:!1,enableSorting:!1,state:{density:"compact",showLoadingOverlay:s.modelsStatsApi.loading,showSkeletons:s.modelsStatsApi.loading},striped:!0,mantineTableProps:{striped:!0},enableTopToolbar:!1,enableBottomToolbar:!1,getRowId:y=>y.code,mantineTableBodyCellProps:({})=>({sx:{padding:"0 10px"}}),mantineTableBodyRowProps:({})=>({onClick:()=>{},sx:{cursor:"pointer"}})});i.useEffect(()=>{t&&l.apiCaller()},[t]);const n=i.useRef(null),w=fl(n),C=i.forwardRef((y,T)=>e.jsxs(Ce,{opened:t,onClose:()=>{r(!1)},title:"Запуски модели",centered:!0,size:"calc(100vw - 3rem)",overlayProps:{blur:1},sx:{"& .mantine-Modal-inner":{padding:"5dvh 0"}},children:[l.loading&&e.jsx(Pe,{size:36,sx:{margin:"auto",display:"block"}}),!l.loading&&l.data.length===0&&e.jsx(la,{c:"dimmed",sx:{textAlign:"center"},children:u.notDataLabel||"No data"}),!l.loading&&l.data.length>0&&e.jsx(Y,{useResizeHandler:!0,data:[{x:l.data.map(h=>Zt(h.timestamp))||[],y:l.data.map(h=>h.message==="")||[],text:l.data.map(h=>h.message)||[],mode:"lines+markers",name:"vh",line:{shape:"vh"},type:"scatter"}],layout:{title:`${a}`,width:w.width-100,height:w.height-200,showlegend:!1},config:{...J.GetConfig(),displayModeBar:!1,fluid:!0}})]}));return e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsx(oa,{order:4,my:10,children:u.modelsLabel||"Модели"}),e.jsx(es,{table:j})]})}const zr=()=>{const s=rt(),{tabValue:u}=Oe(),a=B(),g=v(O)||{},t=v(Rs),r=v(Hs),c=v(Is),b=Ae(()=>fetch(wl()).then(w=>w.json()).then(w=>w.assets)),p=Ae(()=>fetch(xl()).then(w=>w.json()).then(w=>w.protocols),[]);i.useEffect(()=>{b.apiCaller(),p.apiCaller()},[]);const l=Ae(()=>fetch(Sr(t,r,c)).then(w=>w.json()).then(w=>w.stats),[]),x=Ae(()=>fetch(bl(t,r,c)).then(w=>w.json()).then(w=>w.devices),[]);i.useEffect(()=>{t&&(l.apiCaller(),x.apiCaller())},[t]),i.useEffect(()=>{u==="models"&&l.apiCaller()},[u]);const j=w=>{a(jl(w)),w!==t&&a(Tl(null))},n=()=>{x.apiCaller(),l.apiCaller()};return e.jsxs(ra,{fluid:!0,sx:{...ml,marginTop:"10px",color:"#003274"},children:[e.jsx(qt,{data:pl(b.data),value:t,onChange:j,miw:250,maw:400,placeholder:g.assetNavLabel||"asset",rightSection:b.loading&&e.jsx(Pe,{size:18}),sx:{padding:"20px 0 0 0"}}),e.jsx(yl,{onApplyClick:n,deviceStatsApi:x}),e.jsxs(I,{value:u,onTabChange:w=>s(`/dataCollect/${w}`),keepMounted:!1,styles:{root:{marginTop:"2px"},tab:{...R,color:"#003274","&:hover":{background:"#003274",color:"white"}}},children:[e.jsxs(I.List,{sx:{color:"#003274"},children:[e.jsx(I.Tab,{value:"signals",children:g.signalsLabel||"Сигналы"}),e.jsx(I.Tab,{value:"models",children:g.modelsLabel||"Модели"})]}),e.jsx(I.Panel,{value:"signals",pt:"xs",pb:"xs",children:e.jsx(vl,{deviceStatsApi:x,protocolsApi:p})}),e.jsx(I.Panel,{value:"models",pt:"xs",pb:"xs",children:e.jsx(Dr,{modelsStatsApi:l})})]})]})},kr=()=>e.jsx(ia,{children:e.jsxs(re,{path:"/",element:e.jsx(Cl,{}),children:[e.jsx(re,{index:!0,element:e.jsx(wo,{})}),e.jsx(re,{path:"substation/:id",element:e.jsx(wr,{})}),e.jsx(re,{path:"substation/:id/transformer/:assetid",element:e.jsx(Qt,{})}),e.jsx(re,{path:"substation/:id/transformer/:assetid/charts",element:e.jsx(Vt,{})}),e.jsx(re,{path:"substation/:id/gis/:assetid",element:e.jsx(Qt,{})}),e.jsx(re,{path:"substation/:id/gis/:assetid/charts",element:e.jsx(Vt,{})}),e.jsx(re,{path:"about",element:e.jsx(Cr,{})}),e.jsxs(re,{path:"dataCollect/",element:e.jsx(ca,{}),children:[e.jsx(re,{index:!0,element:e.jsx(da,{to:"signals",replace:!0})}),e.jsx(re,{path:":tabValue",element:e.jsx(zr,{})})]})]})}),Er=new ua;function Rr(){const s=v(O);try{document.title=s.headerLabelText}catch{console.log("GET TRANSLATIONS ERROR"),console.log(s)}return e.jsx(o,{sx:{width:"100%",height:"100vh"},children:s==null?e.jsx(o,{sx:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",...F,...M},children:"Could not receive translation"}):e.jsxs(ha,{client:Er,children:[e.jsx(ga,{limit:5,autoClose:2e3}),e.jsx(kr,{})]})})}const lt=fa({reducer:{selectedSubstation:Sl,selectedEquipment:Ll,substations:Dl,subChartsTabGases:zl,tabsController:kl,tabMoisture:El,tabOvervoltage:Rl,tabTemperature:Hl,subTabRD:Il,subTabSTO:Jo,subTabRDNomogram:Ml,subTabDuvaleTriangle:Al,subTabDuvalePentagon:_l,tabBushing:Pl,tabWear:$l,tabItc:Ol,tabPD:Gl,tabSF6:Bl,tabHysteresus:Fl,tabLoadCapacity:Nl,tabLTC:Zl,tabPower:Ul,filterStats:Ql,currentLocale:Wl},middleware:s=>s({serializableCheck:!1})}),Hr=xa(document.getElementById("root"));lt.dispatch(Vl()).then(()=>{lt.dispatch(Yl())}).then(()=>{Hr.render(e.jsx(ba,{store:lt,children:e.jsx(ma,{children:e.jsx(Rr,{})})}))});
