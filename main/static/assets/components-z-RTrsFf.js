var da=Object.defineProperty;var rt=e=>{throw TypeError(e)};var ua=(e,t,a)=>t in e?da(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var it=(e,t,a)=>ua(e,typeof t!="symbol"?t+"":t,a),ct=(e,t,a)=>t.has(e)||rt("Cannot "+a);var M=(e,t,a)=>(ct(e,t,"read from private field"),a?a.call(e):t.get(e)),le=(e,t,a)=>t.has(e)?rt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,a);var re=(e,t,a)=>(ct(e,t,"access private method"),a);import{c as w,a as v,r as p,u as ee,b as L,j as n,B as c,N as me,I as ga,n as F,D as ye,T as Ye,d as Ct,e as pa,P as ve,f as A,g as ha,h as ba,i as Je,C as dt,k as xe,l as qe,M as Ke,m as Ze,o as fa,L as te,S as vt,p as de,q as jt,s as ma,A as ut,t as ya,v as xa,w as Se,x as wt,y as Sa,z as La,E as Le,F as gt,G as Xe,H as Dt,J as pe,K as pt,O as Ta,Q as U,R as Ca,U as va,V as ja,W as ht,X as wa,Y as Da,Z as J,_ as Ia,$ as ka,a0 as $a,a1 as Pa,a2 as Ra,a3 as _a,a4 as Ea,a5 as Oa}from"./vendor-Dg9ap9Na.js";const Aa="/static/assets/elIcon-ChwglYO6.png",r={idle:"idle",error:"error",loading:"loading",success:"success"},C="",Fa="http://localhost:8085",Ma=`${C}/admin`,Ba=`${C}/ui/settings`,Ga=(e,t,a,s,o,l,i,u,g,y)=>`${C}/asset/${t}/diagmess?lng=${e}&&dateStart=${a}&&dateEnd=${s}&&diagNumStart=${o}&&diagCount=${l}&&diagType=${i}&&search=${u}&&orderField=${g}&&orderType=${y}`,Ha=()=>`${C}/laser/online`,za=(e,t)=>`${C}/check-diag-settings?dateStart=${e}&asset=${t}`,Na=(e,t,a,s)=>`${C}/laser/read-data?dateStart=${e}&dateEnd=${t}&asset=${a}&ip=${s}`,Ua=()=>`${C}/laser/loadings-info`,Va=e=>`${C}/laser/loaded-data?id=${e}`,Qa=(e,t)=>`${C}/substation/${e}?lng=${t}`,qa={statusLoadingSelectedSubst:r.idle,selectedSubstation:null,psAssets:null},It=w({name:"selectedSubstationSlice",initialState:qa,reducers:{setSelectedPS:(e,t)=>{try{e.selectedSubstation={subst_id:t.payload.subst_id,name:t.payload.name},e.psAssets=t.payload.assets}catch{e.selectedSubstation=null,e.psAssets=null}},setPSAssets:(e,t)=>{e.selectedSubstation=t.payload},setStatusLoadingSelectedSubts:(e,t)=>{e.statusLoadingSelectedSubst=t.payload}},extraReducers:e=>{e.addCase(je.pending,(t,a)=>{t.statusLoadingSelectedSubst=r.loading}).addCase(je.rejected,(t,a)=>{t.statusLoadingSelectedSubst=r.error}).addCase(je.fulfilled,(t,a)=>{t.psAssets=a.payload.assets,t.selectedSubstation={subst_id:a.payload.id,name:a.payload.name,schema:a.payload.scheme},t.statusLoadingSelectedSubst=r.success})}}),je=v("getInfoBySelectedSubstQuery/selectedSubstationSlice",async(e,t)=>{const a=t.getState().currentLocale;return{...await fetch(Qa(e,a.locale.value)).then(o=>o.json())}}),ao=e=>e.selectedSubstation.selectedSubstation,Wa=e=>e.selectedSubstation.psAssets,so=e=>e.selectedSubstation.statusLoadingSelectedSubst,{setSelectedPS:Ya,setPSAssets:no,setStatusLoadingSelectedSubts:Ja}=It.actions,oo=It.reducer,Z="(min-width:800px) and (max-width:1367px)",X=(e,t)=>e(t),kt=e=>`${C}/substations?lng=${e}`,Ka=(e,t)=>`${C}/geomap?lng=${e}&hash=${t}`,$t=e=>`${C}/org-struct?lng=${e}`,Za=e=>`${C}/tabs-list?lng=${e}`,Xa=e=>`${C}/diag-messages/last?lng=${e}`;var ue,z,he,Pt,G,Ce;const B=class B{static ChartComponentFactory(t,a=null,s){let o=0;const l=.04,i=Object.keys(this.groupBy(t,"measure_unit")),u=[],g={autosize:!1,xaxis:{type:"date",tickformat:"%y-%m-%d %H:%M"},legend:{groupclick:"toggleitem",itemdoubleclick:"toggle"},shapes:M(this,Ce).call(this,a)};for(let b=0;b<i.length;b++){let d=!1,f=b===0?"yaxis":`yaxis${b+1}`;t.filter(h=>h.measure_unit===i[b]).forEach(h=>{var E,R;const S=`rgb(${re(this,z,he).call(this,100,255)},${re(this,z,he).call(this,100,200)},${re(this,z,he).call(this,100,200)})`;let x={legendgroup:`${b}`,legendgrouptitle:{text:`${M(this,G).call(this,i[b],20)}`,font:{size:"18"}},y:h.values.length>0?(E=h.values)==null?void 0:E.map(I=>I[1]):[0],x:h.values.length>0?(R=h.values)==null?void 0:R.map(I=>I[0]):[" "],line:re(this,z,Pt).call(this,h.plot_type),name:M(this,G).call(this,h.name).trim(),showlegend:!0,hoverinfo:"all",yaxis:b===0?"y":`y${b+1}`,type:"scatter",visible:h.visible===!1?"legendonly":h.visible,mode:h.mode,hovertemplate:"<i>%{y}</i><br><i>%{x}</i><br>",marker:h.code.includes("_off")?{color:S,symbol:"x",size:12}:{color:S},id:o};if(u.push(x),h.values.length>1&&!h.name.includes("Прогноз")&&!h.name.includes("Forecast")){if(h.dz!==""){let I={customType:M(this,G).call(this,h.name).trim()+"_dz",y:[h.dz,h.dz],x:[h.values[0][0],h.values[h.values.length-1][0]],line:{dash:"dot"},name:`${M(this,G).call(this,h.name)} ${s.lim0Label}`,showlegend:!1,hoverinfo:"all",yaxis:b===0?"y":`y${b+1}`,type:"scatter",visible:!1,mode:"lines+markers",hovertemplate:"<i>%{y}</i><br><i>%{x}</i><br>",marker:{color:S},id:o};u.push(I)}if(h.pdz!==""){let I={customType:M(this,G).call(this,h.name).trim()+"_pdz",y:[h.pdz,h.pdz],x:[h.values[0][0],h.values[h.values.length-1][0]],line:{dash:"dot"},name:`${M(this,G).call(this,h.name)} ${s.lim1Label}`,showlegend:!1,hoverinfo:"all",yaxis:b===0?"y":`y${b+1}`,type:"scatter",visible:!1,mode:"lines+markers",hovertemplate:"<i>%{y}</i><br><i>%{x}</i><br>",marker:{color:S},id:o};u.push(I)}}o++}),g[f]={title:{text:i[b],standoff:0,font:{size:11}},autorange:!0,tickangle:270,tickfont:{size:11},visible:d,automargin:!0,position:l*b},b!==0&&(g[f].overlaying="y")}let y=0;for(const b in g)b.includes("yaxis")&&(g[b].visible?(g[b].position=y===0?0:y*l,y++):g[b].position=1);return g.xaxis.domain=[y*l,1],{layout:g,traces:u}}static ChartComponentFactoryXint(t){const a=[],s={title:null,xaxis:{title:{text:t[0].name_x,font:{size:18,color:"#7f7f7f"}}},yaxis:{title:{text:t[0].name_y,font:{size:18,color:"#7f7f7f"}}}};for(let o=0;o<t.length;o++)a.push({x:t[o].x,y:t[o].y,type:"scatter"});return{layout:s,traces:a}}static GetConfig(){return{responsive:!0,displayModeBar:!1,scrollZoom:!0,scale:1,displaylogo:!1,modeBarButtonsToRemove:["zoom2d","lasso2d","select2d","pan2d","autoScale2d"]}}};ue=new WeakMap,z=new WeakSet,he=function(t,a){return t=Math.ceil(t),a=Math.floor(a),Math.floor(Math.random()*(a-t+1)+t)},Pt=function(t){switch(t){case"stepped":return{shape:"hv"};case"linear":return{shape:"linear"};case"forecast":return{dash:"dash"}}},G=new WeakMap,Ce=new WeakMap,le(B,z),le(B,ue,["rgba(0, 157, 25, 0.7)","rgba(0, 74, 157, 0.7)"]),it(B,"groupBy",function(t,a){return t.reduce((s,o)=>((s[o[a]]=s[o[a]]||[]).push(o),s),{})}),le(B,G,(t,a=35)=>{let s="",o=t.trim().split(" ");for(let l=0;l<o.length;l++)if(s.length===0)s+=o[l]+" ";else{const i=s.split("<br>").length-1;s.length-(s.lastIndexOf("<br>")-i*3)>=a&&(o[l].length===1||o[l].length===2||(s+="<br>")),s+=o[l]+" "}return s}),le(B,Ce,t=>{if(t==null)return null;{const a=[];return t.forEach(s=>{const o=s.values.map((l,i)=>({name:s.name,showlegend:i==0,legendgroup:s.measure_unit,legendgrouptitle:{text:s.measure_unit,font:{size:"18"}},visible:"legendonly",group:s.code.includes("110")?"1.1":"1.25",type:"line",x0:l[0],y0:l[1],x1:l[0],y1:l[2],yref:"paper",line:{color:s.code.includes("110")?M(B,ue)[0]:M(B,ue)[1],width:3,dash:"dot"}}));a.push(...o)}),a}});let k=B;const es={statusLoading:r.idle,allDiagMsg:null,companyStruct:null,mapStatistic:null,substationsInfo:null,tabsList:null},Rt=w({name:"substationsSlice",initialState:es,reducers:{setStatusLoading:(e,t)=>{e.statusLoading=t.payload},addAssetsToTheSubstGeoJson:(e,t)=>{t.payload&&t.payload.forEach(a=>{var o;let s=(o=e.substGeoJson)==null?void 0:o.features.find(l=>l.properties.subst_id==a.id);s&&(s.properties={...s==null?void 0:s.properties,...a})})},setCompanyStruct:(e,t)=>{e.companyStruct=t.payload}},extraReducers:e=>{e.addCase(be.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(be.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(be.fulfilled,(t,a)=>{t.statusLoading=r.success,t.substationsInfo=a.payload.substations,t.mapStatistic=k.groupBy(a.payload.substations.map(s=>s.assets).flat(),"asset_type_name"),t.allDiagMsg=a.payload.diag_msg.map(s=>{var o;return{...s,substId:((o=a.payload.substations.find(l=>l.name===s.substation))==null?void 0:o.id)??""}}),t.companyStruct=a.payload.company_struct,t.tabsList=a.payload.asset_type_tabs})}}),be=v("getSubstationsQuery/substationsSlice",async(e,t)=>{const a=t.getState().currentLocale,s=await fetch(kt(a.locale.value)).then(u=>u.json()),o=await fetch($t(a.locale.value)).then(u=>u.json()),l=await fetch(Xa(a.locale.value)).then(u=>u.json()),i=await fetch(Za(a.locale.value)).then(u=>u.json());return{...s,...o,...l,...i}});v("getOnlySubstationsQuery/substationsSlice",async(e,t)=>{const a=t.getState().currentLocale;return{...await fetch(kt(a.locale.value)).then(o=>o.json())}});const ts=v("companyStruct/substationsSlice",async(e,t)=>{const a=t.getState().currentLocale;await fetch($t(a.locale.value)).then(s=>s.json()).then(s=>{t.dispatch(ns(s.company_struct))})}),lo=v("getMapComponentsQuery/substationsSlice",async(e,t)=>{const a=t.getState().currentLocale;return{...await fetch(Ka(a.locale.value,e.hash)).then(o=>o.json())}}),ro=e=>e.substations.statusLoading,io=e=>e.substations.allDiagMsg,as=e=>e.substations.guideDiagMessages,ss=e=>e.substations.companyStruct,co=e=>e.substations.mapStatistic,uo=e=>e.substations.substationsInfo,go=e=>e.substations.tabsList,{setStatusLoading:po,setCompanyStruct:ns,addAssetsToTheSubstGeoJson:ho}=Rt.actions,bo=Rt.reducer,fo=p.memo(()=>{const[e,t]=p.useState(window.matchMedia(Z).matches);p.useEffect(()=>{const l=window.matchMedia(Z);return l.addEventListener("change",i=>X(t,i.matches)),()=>l.removeEventListener("change",X)},[]);const a=ee(),s=L(ss);p.useLayoutEffect(()=>{s===null&&a(ts())},[]);const o=p.useMemo(()=>{function l(i){const u=[],g=i.filter(b=>b.parentId==null||b.parentId=="");for(let b=0;b<g.length;b++){let d=y([g[b]]);u.push(d)}function y(b){let d=[];for(const f of b)if(f.typePoint==="node")d.push(n.jsxs("details",{open:!0,style:{marginLeft:"10px",color:"white",fontSize:e?"0.8em":"1em"},children:[n.jsx("summary",{children:f.name}),y(i.filter(m=>m.parentId==f.id))]},f.id));else return b.filter(m=>m.parentId===f.parentId).map(m=>n.jsx(me,{to:`/substation/${m.sustId}`,style:{marginLeft:"10px",marginTop:"5px",width:"80%",color:"white",textDecoration:"none",display:"block"},children:n.jsxs(c,{sx:{display:"flex",alignItems:"center","&:hover":{transform:"scale(1.05)"}},children:[n.jsx(ga,{src:Aa,width:15,height:15}),n.jsx(c,{children:m.name})]})},m.id));return d}return u}if(s!==null)return l(s)},[s]);return n.jsx(c,{sx:{background:"#003274",width:"100%",height:"100%",overflowY:"auto"},children:o})}),V={fontFamily:"Roboto-Bold"},P={fontFamily:"Roboto-Regular"},j={color:"#003274"},mo={borderColor:"1px solid rgba(201, 201, 201, 0.8)"},yo=e=>({zIndex:1,height:e?"20px":"",margin:"0 1%",background:"#003274",border:"1px solid #003274","&:hover":{background:"#003274"}}),os={locale:"",allLocales:null,translation:null,lastValuesRefreshIntervalPerSec:300},_t=w({name:"localeSlice",initialState:os,reducers:{setLocale:(e,t)=>{e.locale=t.payload}},extraReducers:e=>{e.addCase(fe.pending,(t,a)=>{t.statusLoadingLocale=r.loading}).addCase(fe.rejected,(t,a)=>{t.statusLoadingLocale=r.error}).addCase(fe.fulfilled,(t,a)=>{t.statusLoadingLocale=r.success;const s=a.payload._allLangs.map(o=>{const l=Object.entries(o);return{value:l[0][0],label:l[0][1]}});t.allLocales=s,t.translation=a.payload._translation,t.locale=s.find(o=>o.value===a.payload._currentLang)}).addCase(we.pending,(t,a)=>{t.statusLoadingSettings=r.loading}).addCase(we.rejected,(t,a)=>{t.statusLoadingSettings=r.error,console.error(`Fetch (getAppSettings) error: ${a.payload}`),console.error("Default values applied")}).addCase(we.fulfilled,(t,a)=>{t.statusLoadingSettings=r.success,t.lastValuesRefreshIntervalPerSec=a.payload.latest_values_refresh_interval})}}),fe=v("localeSlice/GetLocalesInfo",async(e,t)=>{try{const a=await fetch(`${C}/langs`).then(u=>u.json());let s=localStorage.getItem("locale");s==null?s={value:"en",label:"English"}:s=JSON.parse(s);const o=a.langs.map(u=>Object.entries(u)[0][0]);if(!o.includes(s.value)){const u=a.langs.filter(g=>Object.entries(g)[0][0]===o[0]);s={value:o[0],label:u[0][o[0]]}}localStorage.setItem("locale",JSON.stringify(s));const l=await fetch(`${C}/translation/${s.value}`).then(u=>u.json());return{_allLangs:a.langs,_translation:l.translation,_currentLang:l.lang}}catch(a){return console.log(a),t.rejectWithValue("Не удалось получить локализацию от сервера")}}),we=v("localeSlice/getAppSettings",async(e,{rejectWithValue:t})=>await fetch(Ba).then(s=>s.ok?s.json():t(s.status)).catch(s=>t(524))),N=e=>e.currentLocale.locale,ls=e=>e.currentLocale.allLocales,$=e=>e.currentLocale.translation,xo=e=>e.currentLocale.lastValuesRefreshIntervalPerSec,{setLocale:rs}=_t.actions,So=_t.reducer,is="/static/assets/danger-rFNOzrUc.png",cs="/static/assets/warning-D84hLsZW.png",ds="/static/assets/good-DhgS4zZR.png",us="/static/assets/empty-CgdktBB_.png",Lo={undefinedTitle:"Undefined",goodTitle:"Good",warningTitle:"Warning",dangerousTitle:"Dangerous"},To={undefinedColor:"rgba(127, 127, 127, 0.9)",goodColor:"rgba(43, 200, 88, 0.8)",warningColor:"rgba(253, 174, 73, 0.9)",dangerousColor:"rgba(229, 106, 91, 0.9)"},gs=[{title:"Is not designed",icon:"",inerp:"Не расчитано",color:"rgba(39, 144, 245, 0.8)",levelState:0},{title:"Undefined",icon:us,inerp:"Нет данных",color:"gray",levelState:1},{title:"Dangerous",icon:is,inerp:"Опасно",levelState:2,color:"rgb(229, 106, 91)"},{title:"Warning",icon:cs,inerp:"Внимание",color:"#fec600",levelState:3},{title:"Good",icon:ds,inerp:"Нормально",color:"rgba(43, 200, 88, 0.8)",levelState:4}],_=[{title:"нет данных",color:"gray",levelState:null},{title:"нормально",color:"rgba(43, 200, 88, 0.8)",levelState:0},{title:"внимание",color:"#fec600",levelState:1},{title:"опасность",color:"rgb(229, 106, 91)",levelState:2}],Co=[{title:"Undefined",color:"gray"},{title:"Good",color:"transparent"},{title:"Warning",color:"#ffa500"},{title:"Dangerous",color:"#cf6868"}],vo=[{impotantLevel:"91 - 100%",name:"Dark green",color:"rgba(1, 50, 32, 0.8)"},{impotantLevel:"81 - 90%",name:"Green",color:"rgba(0, 128, 0, 0.8)"},{impotantLevel:"71 - 80%",name:"Light green",color:"rgba(144, 238, 144, 0.8)"},{impotantLevel:"61 - 70%",name:"Light yellow",color:"rgba(255, 255, 0, 0.8)"},{impotantLevel:"51 - 60%",name:"Yellow",color:"rgba(255, 187, 15, 0.8)"},{impotantLevel:"41 - 50%",name:"Orange",color:"rgba(255, 165, 0, 0.8)"},{impotantLevel:"31 - 40%",name:"Light orange",color:"rgba(255, 104, 0, 0.8)"},{impotantLevel:"21 - 30%",name:"Light cherry",color:"rgba(222, 49, 99, 0.8)"},{impotantLevel:"11 - 20%",name:"Crimson",color:"rgba(255, 36, 0, 0.8)"},{impotantLevel:"1 - 10%",name:"Maroon",color:"rgba(155, 45, 48, 0.8)"}],ps=(e,t)=>`${C}/asset/${t}/meterings/last?lng=${e}&`,hs=()=>`${C}/blocks/info`,bs=(e,t)=>`${C}/asset/${t}/passport/export/create?lng=${e}`,fs=(e,t)=>`${C}/asset/${t}/diag_settings/export/create?lng=${e}`,ms=(e,t,a,s,o,l,i)=>`${C}/substation/${t}/diagmsg/export/create?lng=${e}&dateStart=${a}&dateEnd=${s}&diagType=${o}&search=${l}&format=${i}`,ys=(e,t)=>`${C}/export/file?lng=${e}&name=${t}`,xs=(e,t)=>`${C}/asset/${t}/3dforecast?lng=${e}`,Ss={statusLoading:r.idle,gasesTrace:null,gasesLayout:null,gasesTracePercent:null,gasesLayoutPercent:null,currentGasesUnit:"ppm",volumeForecast:null},Et=w({name:"subTabChartsOfGasesSlice",initialState:Ss,reducers:{setGasesTrace:(e,t)=>{e.gasesTrace=t.payload},setGasesLayout:(e,t)=>{e.gasesLayout=t.payload},setGasesTracePercent:(e,t)=>{t.payload.forEach(s=>{if(s.mode!="none"){const o=e.gasesTrace.filter(l=>l.id===s.id)[0];s.marker=o.marker}}),e.gasesTracePercent=t.payload},setGasesLayoutPercent:(e,t)=>{e.gasesLayoutPercent=t.payload},setCurrentGasesUnit:(e,t)=>{e.currentGasesUnit=t.payload},setGasesChartsStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(De.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(De.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(De.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.gasesLayout=s.layout,t.gasesTrace=s.traces,t.volumeForecast=a.payload.forecast})}}),Ls=async(e,t)=>{if(console.log("CONVER DATA called"),e.values.length===0)return;const a=new Worker(new URL("/static/assets/worker-CEwgvsRg.js",import.meta.url));a.onmessage=function(s){const o=k.ChartComponentFactory(s.data.values,null,e.translation);t.dispatch(Ts(o.traces)),t.dispatch(Cs(o.layout)),a.terminate()},a.onerror=function(s){console.error("WOKER ERROR"),console.error(s),a.terminate()},a.postMessage(e)},De=v("subChartsTabGasesSlice/SubTabChartsOfGasesQuery",async(e,t)=>{try{const a=await fetch(e.url).then(l=>l.json()),s=await t.getState(),o=await fetch(xs(s.currentLocale.locale.value,s.selectedEquipment.equpment.elementId)).then(l=>l.json());return Ls({values:a.params,translation:e.translations},t),{params:a.params,forecast:o.params,translate:e.translations}}catch(a){console.log(a)}}),jo=e=>e.subChartsTabGases.gasesTrace,wo=e=>e.subChartsTabGases.gasesLayout,Do=e=>e.subChartsTabGases.gasesTracePercent,Io=e=>e.subChartsTabGases.gasesLayoutPercent,ko=e=>e.subChartsTabGases.statusLoading,$o=e=>e.subChartsTabGases.currentGasesUnit,Po=e=>e.subChartsTabGases.volumeForecast,{setGasesTrace:Ro,setGasesLayout:_o,setGasesTracePercent:Ts,setGasesLayoutPercent:Cs,setCurrentGasesUnit:Eo,setGasesChartsStatusLoading:vs}=Et.actions,Oo=Et.reducer,js={statusLoading:r.idle,sourceData:null},Ot=w({name:"subTabRDTableSlice",initialState:js,reducers:{setRDTableStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Ie.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Ie.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Ie.fulfilled,(t,a)=>{t.statusLoading=r.success,t.sourceData=a.payload.values})}}),Ie=v("subTabRDTableSlice/SubTabRDTableQuery",async(e,t)=>await fetch(e.url).then(s=>s.json())),Ao=e=>e.subTabRD.sourceData,Fo=e=>e.subTabRD.statusLoading,{setRDTableStatusLoading:ws}=Ot.actions,Mo=Ot.reducer,Ds={statusLoading:r.idle,data:null},At=w({name:"subTabChartsRDNomogramSlice",initialState:Ds,reducers:{setRDNomogrammStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(ke.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(ke.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(ke.fulfilled,(t,a)=>{t.statusLoading=r.success,t.data=a.payload.values})}}),ke=v("subTabChartsRDNomogramSlice/SubTabChartsRDNomogramQuery",async(e,t)=>await fetch(e.url).then(s=>s.json())),Bo=e=>e.subTabRDNomogram.data,Go=e=>e.subTabRDNomogram.statusLoading,{setRDNomogrammStatusLoading:Is}=At.actions,Ho=At.reducer,ks={statusLoading:r.idle,wearTrace:null,wearLayout:null},Ft=w({name:"tabWearSlice",initialState:ks,reducers:{setWearTrace:(e,t)=>{e.wearTrace=t.payload},setWearLayout:(e,t)=>{e.wearLayout=t.payload},setWearStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase($e.pending,(t,a)=>{t.statusLoading=r.loading}).addCase($e.rejected,(t,a)=>{t.statusLoading=r.error}).addCase($e.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.wearLayout=s.layout,t.wearTrace=s.traces})}}),$e=v("tabWearSlice/TabChartsOfWearQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),zo=e=>e.tabWear.wearTrace,No=e=>e.tabWear.wearLayout,Uo=e=>e.tabWear.statusLoading,{setWearTrace:Vo,setWearLayout:Qo,setWearStatusLoading:$s}=Ft.actions,qo=Ft.reducer,Ps={statusLoading:r.idle,temperatureTrace:null,temperatureLayout:null},Mt=w({name:"tabTemperatureSlice",initialState:Ps,reducers:{setTemperatureTrace:(e,t)=>{e.temperatureTrace=t.payload},setTemperatureLayout:(e,t)=>{e.temperatureLayout=t.payload},setTemperatureStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Pe.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Pe.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Pe.fulfilled,(t,a)=>{t.statusLoading=r.success,console.log(a.payload);const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.temperatureLayout=s.layout,t.temperatureTrace=s.traces})}}),Pe=v("tabTemperatureSlice/TabChartsOfTemperatureQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),Wo=e=>e.tabTemperature.temperatureTrace,Yo=e=>e.tabTemperature.temperatureLayout,Jo=e=>e.tabTemperature.statusLoading,{setTemperatureTrace:Ko,setTemperatureLayout:Zo,setTemperatureStatusLoading:Rs}=Mt.actions,Xo=Mt.reducer,_s={statusLoading:r.idle,sf6Trace:null,sf6Layout:null},Bt=w({name:"tabSF6Slice",initialState:_s,reducers:{setSF6Trace:(e,t)=>{e.sf6Trace=t.payload},setSF6Layout:(e,t)=>{e.sf6Layout=t.payload},setSF6StatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Re.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Re.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Re.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.sf6Layout=s.layout,t.sf6Trace=s.traces})}}),Re=v("tabSF6Slice/TabChartsOfSF6Query",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),el=e=>e.tabSF6.sf6Trace,tl=e=>e.tabSF6.sf6Layout,al=e=>e.tabSF6.statusLoading,{setSF6Trace:sl,setSF6Layout:nl,setSF6StatusLoading:Es}=Bt.actions,ol=Bt.reducer,Os={statusLoading:r.idle,bushingTrace:null,bushingLayout:null},Gt=w({name:"tabBushingSlice",initialState:Os,reducers:{setBushingTrace:(e,t)=>{e.bushingTrace=t.payload},setBushingLayout:(e,t)=>{e.bushingLayout=t.payload},setBushingStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(_e.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(_e.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(_e.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.bushingLayout=s.layout,t.bushingTrace=s.traces})}}),_e=v("tabBushingSlice/TabChartsOfBushingQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),ll=e=>e.tabBushing.bushingTrace,rl=e=>e.tabBushing.bushingLayout,il=e=>e.tabBushing.statusLoading,{setBushingTrace:cl,setBushingLayout:dl,setBushingStatusLoading:As}=Gt.actions,ul=Gt.reducer,Fs={statusLoading:r.idle,overvoltageTrace:null,overvoltageLayout:null,tableValues:null,tableData11:null,tableData125:null,tableDataPause:null},Ht=w({name:"tabOvervoltageSlice",initialState:Fs,reducers:{setOvervoltageTrace:(e,t)=>{e.overvoltageTrace=t.payload},setOvervoltageLayout:(e,t)=>{e.overvoltageLayout=t.payload},setOvervoltageStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Ee.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Ee.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Ee.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,a.payload.v_lines,a.payload.translate);t.overvoltageLayout=s.layout,t.overvoltageTrace=s.traces,t.tableValues=a.payload.table,t.tableData11=a.payload.table_11,t.tableData125=a.payload.table_125,t.tableDataPause=a.payload.table_pause})}}),Ee=v("tabOvervoltageSlice/TabChartsOfOvervoltageQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),gl=e=>e.tabOvervoltage.overvoltageTrace,pl=e=>e.tabOvervoltage.overvoltageLayout,hl=e=>e.tabOvervoltage.statusLoading,bl=e=>e.tabOvervoltage.tableValues,fl=e=>e.tabOvervoltage.tableData11,ml=e=>e.tabOvervoltage.tableData125,yl=e=>e.tabOvervoltage.tableDataPause,{setOvervoltageTrace:xl,setOvervoltageLayout:Sl,setOvervoltageStatusLoading:Ms}=Ht.actions,Ll=Ht.reducer,Bs={statusLoading:r.idle,pdTrace:null,pdLayout:null},zt=w({name:"tabPartialDischargeSlice",initialState:Bs,reducers:{setPDTrace:(e,t)=>{e.pdTrace=t.payload},setPDLayout:(e,t)=>{e.pdLayout=t.payload},setPDStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Oe.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Oe.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Oe.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.pdLayout=s.layout,t.pdTrace=s.traces})}}),Oe=v("tabPartialDischargeSlice/TabChartsOfPDQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),Tl=e=>e.tabPD.pdTrace,Cl=e=>e.tabPD.pdLayout,vl=e=>e.tabPD.statusLoading,{setPDTrace:jl,setPDLayout:wl,setPDStatusLoading:Gs}=zt.actions,Dl=zt.reducer,Hs={statusLoading:r.idle,hysteresisTrace:null,hysteresisLayout:null},Nt=w({name:"subTabHysteresisSlice",initialState:Hs,reducers:{setHysteresisTrace:(e,t)=>{e.hysteresisTrace=t.payload},setHysteresisLayout:(e,t)=>{e.hysteresisLayout=t.payload},setHysteresisStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Ae.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Ae.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Ae.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactoryXint(a.payload.params,null,a.payload.translate);t.hysteresisLayout=s.layout,t.hysteresisTrace=s.traces})}}),Ae=v("subTabHysteresisSlice/SubTabChartsOfHysteresisQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),Il=e=>e.tabHysteresus.hysteresisTrace,kl=e=>e.tabHysteresus.hysteresisLayout,$l=e=>e.tabHysteresus.statusLoading,{setHysteresisTrace:Pl,setHysteresisLayout:Rl,setHysteresisStatusLoading:zs}=Nt.actions,_l=Nt.reducer,Ns={statusLoading:r.idle,moistureTrace:null,moistureLayout:null},Ut=w({name:"tabMoistureSlice",initialState:Ns,reducers:{setMoistureTrace:(e,t)=>{e.moistureTrace=t.payload},setMoistureLayout:(e,t)=>{e.moistureLayout=t.payload},setMoistureStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Fe.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Fe.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Fe.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.moistureLayout=s.layout,t.moistureTrace=s.traces})}}),Fe=v("tabMoistureSlice/TabChartsOfMoistureQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),El=e=>e.tabMoisture.moistureTrace,Ol=e=>e.tabMoisture.moistureLayout,Al=e=>e.tabMoisture.statusLoading,{setMoistureTrace:Fl,setMoistureLayout:Ml,setMoistureStatusLoading:Us}=Ut.actions,Bl=Ut.reducer,Vs={statusLoading:r.idle,itcTrace:null,itcLayout:null},Vt=w({name:"tabItcSlice",initialState:Vs,reducers:{setItcTrace:(e,t)=>{e.itcTrace=t.payload},setItcLayout:(e,t)=>{e.itcLayout=t.payload},setItcStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Me.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Me.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Me.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.itcLayout=s.layout,t.itcTrace=s.traces})}}),Me=v("tabItcSlice/TabChartsOfItcQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),Gl=e=>e.tabItc.itcTrace,Hl=e=>e.tabItc.itcLayout,zl=e=>e.tabItc.statusLoading,{setItcTrace:Nl,setItcLayout:Ul,setItcStatusLoading:Qs}=Vt.actions,Vl=Vt.reducer,ie="black",qs={title:"",showlegend:!1,xaxis:{showgrid:!1,showline:!1,showticklabels:!1,zeroline:!1},yaxis:{showgrid:!1,showline:!1,showticklabels:!1,zeroline:!1},margin:{l:0,r:0,b:0,t:0}},Ws={statusLoading:r.idle,pentagonTrace:null,pentagonLayout:qs},Qt=w({name:"subTabChartsDuvalPentagon",initialState:Ws,reducers:{setDuvalePentagonStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Be.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Be.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Be.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=a.payload.pentagon,o={x:s.x,y:s.y,showlegend:!1,mode:"markers",marker:{color:s.dates.map((u,g)=>g),size:14,line:{width:1,color:"black"}},text:s.dates.map((u,g)=>`H2: ${s.h2[g]}<br>CH4: ${s.ch4[g]}<br>C2H6: ${s.c2h6[g]}<br>C2H4: ${s.c2h4[g]}<br>C2H2: ${s.c2h2[g]} <br>${u.replace("T"," ")}`),hoverinfo:"text"},l=a.payload.translations;let i=[{x:[-35,0,0,-1,-1,0,0,-38,-35],y:[3,1.5,24.5,24.5,33,33,40,12.4,3],fill:"toself",fillcolor:"#90af9d",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:l.mineralOilGassingLabel,hoverinfo:"text"},{x:[-22.5,-6,-1,0,-35,-23.5,-22.5],y:[-32.4,-4,-2,1.5,3,-32.4,-32.4],fill:"toself",fillcolor:"#f4ecea",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:l.thermalDefectInLowTemperatureRangeLabel,hoverinfo:"text"},{x:[0,38,32,4,0,0],y:[40,12,-6,16,1.5,40],fill:"toself",fillcolor:"#005686",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:l.lowEnergySparkDischargeLabel,hoverinfo:"text"},{x:[0,0,-1,-1,0],y:[24.5,33,33,24.5,24.5],fill:"toself",fillcolor:"#9b8fa4",hoveron:"points+fills",mode:"lines",line:{color:"black",width:1},text:l.pdLabel,hoverinfo:"text"},{x:[1,-6,-22.5,1],y:[-32.4,-4,-32.4,-32.4],fill:"toself",fillcolor:"#f0cac1",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:l.thermalDefectInMiddleTemperatureRangeLabel,hoverinfo:"text"},{x:[24,-1,-6,1,23.5,24],y:[-30,-2,-4,-32.4,-32.4,-30],fill:"toself",fillcolor:"#c89c82",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:l.thermalDefectInHighTemperatureRangeLabel,hoverinfo:"text"},{x:[4,32,24,-1,4],y:[16,-6,-30,-2,16],fill:"toself",fillcolor:"#7fc7e2",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:l.highEnergySparkDischargeLabel,hoverinfo:"text"},{x:["0","41"],y:["0","13"],showlegend:!1,mode:"lines+text",marker:{color:ie},text:["","40% C2H2"],textposition:"top",hoverinfo:"text"},{x:["0","0"],y:["0","41"],showlegend:!1,mode:"lines+text",marker:{color:ie},text:["","40% H2"],textposition:"top",hoverinfo:"text"},{x:["0","-41"],y:["0","13.5"],showlegend:!1,mode:"lines+text",marker:{color:ie},text:["","40% C2H6"],textposition:"top",hoverinfo:"text"},{x:["0","-25.5"],y:["0","-35"],showlegend:!1,mode:"lines+text",marker:{color:ie},text:["","40% CH4"],textposition:"bottom",hoverinfo:"text"},{x:["0","25.5"],y:["0","-35"],showlegend:!1,mode:"lines+text",marker:{color:ie},text:["","40% C2H4"],textposition:"bottom",hoverinfo:"text"}];i.push(o),t.pentagonTrace=i})}}),Be=v("subTabChartsDuvalPentagon/SubTabChartsDuvalPentagonQuery",async(e,t)=>({pentagon:(await fetch(e.url).then(s=>s.json())).pentagon,translations:e.translations})),Ql=e=>e.subTabDuvalePentagon.pentagonTrace,ql=e=>e.subTabDuvalePentagon.pentagonLayout,Wl=e=>e.subTabDuvalePentagon.statusLoading,{setDuvalePentagonStatusLoading:Ys}=Qt.actions,Yl=Qt.reducer,Js={ternary:{sum:100,aaxis:{title:"",titlefont:{size:12},tickangle:0,tickfont:{size:10},tickcolor:"black",ticklen:10,showline:!0,showgrid:!0},baxis:{title:"",titlefont:{size:12},tickangle:0,tickfont:{size:10},tickcolor:"black",ticklen:10,showline:!0,showgrid:!0},caxis:{title:"",titlefont:{size:12},tickangle:0,tickfont:{size:10},tickcolor:"black",ticklen:10,showline:!0,showgrid:!0}},paper_bgcolor:"white",title:{text:""},legend:{visible:!1},autosize:!1,showlegend:!1,margin:{l:25,r:0,b:35,t:80},annotations:[{x:.35,y:.5,text:"CH4",showarrow:!1},{x:.5,y:-.05,text:"C2H2",showarrow:!1},{x:.65,y:.5,text:"C2H4",showarrow:!1}]},Ks={statusLoading:r.idle,triangleTrace:null,triangleLayout:Js},qt=w({name:"subTabChartsDuvalTriangleSlice",initialState:Ks,reducers:{setDuvaleTriangleStatusLoading:(e,t)=>{e.statusLoading=t.payload},addTrace:(e,t)=>{const a=structuredClone(e.triangleTrace);e.triangleTrace=a!=null?[...a,...t.payload]:[...t.payload]}},extraReducers:e=>{e.addCase(Ge.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Ge.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Ge.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=a.payload.triangle,o={name:"",showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"markers",line:{color:"black"},a:s.CH4,b:s.C2H2,c:s.C2H4,marker:{color:s.dates.map((u,g)=>g),size:14,line:{width:1,color:"black"}},text:s.dates.map(u=>u.replace("T"," ")),hovertemplate:"<i>C2H4: %{c} </i><br><i>CH4: %{a} </i><br><i>C2H2: %{b} </i><br><i>%{text}</i>"};let l=a.payload.translations,i=[{name:l.lowEnergySparkDischargeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[.01,13,13,77],c:[0,0,23,23],a:[0,87,64,0],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#005686"},{name:l.highEnergySparkDischargeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[77,13,13,29,29],c:[23,23,40,40,71],a:[0,64,47,31,0],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#7fc7e2"},{name:l.compositionOfElectricalAndThermalDefectsLabel,hoverinfo:"text",showlegend:!1,type:"scatterternary",mode:"lines",line:{color:"black"},b:[29,29,13,13,4,4,15,15],c:[71,40,40,0,0,50,50,85],a:[0,31,47,87,96,46,35,0],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#dccfe2"},{name:l.thermalDefectInHighTemperatureRangeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[15,15,0,0],c:[85,50,50,100],a:[0,35,50,0],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#c89c82"},{name:l.thermalDefectInMiddleTemperatureRangeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[4,0,0,4],c:[50,50,20,20],a:[46,50,80,76],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#f0cac1"},{name:l.thermalDefectInLowTemperatureRangeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[4,0,0,2,4],c:[20,20,2,0,0],a:[76,80,98,98,96],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#f4ecea"},{name:l.pdLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[2,0,0],c:[0,2,0],a:[98,98,100],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#9b8fa4"}];i.push(o),t.triangleTrace=i})}}),Ge=v("subTabChartsDuvalTriangleSlice/SubTabChartsDuvalTriangleQuery",async(e,t)=>({triangle:(await fetch(e.url).then(s=>s.json())).triangle,translations:e.translations})),Jl=e=>e.subTabDuvaleTriangle.triangleTrace,Kl=e=>e.subTabDuvaleTriangle.triangleLayout,Zl=e=>e.subTabDuvaleTriangle.statusLoading,{setDuvaleTriangleStatusLoading:Zs,addTrace:Xl}=qt.actions,er=qt.reducer,Xs={statusLoading:r.idle,loadCapacityTrace:null,loadCapacityLayout:null,coeffTable:null,msg:null,loadTable:null},Wt=w({name:"tabLoadCapacitySlice",initialState:Xs,reducers:{setLoadCapacityTrace:(e,t)=>{e.loadCapacityTrace=t.payload},setLoadCapacityLayout:(e,t)=>{e.loadCapacityLayout=t.payload},setLoadCapacityStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(He.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(He.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(He.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.loadCapacityLayout=s.layout,t.loadCapacityTrace=s.traces,t.coeffTable=a.payload.coeff_table,t.msg=a.payload.message,t.loadTable=a.payload.load_table})}}),He=v("tabLoadCapacitySlice/TabChartsOfLoadCapacityQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),tr=e=>e.tabLoadCapacity.loadCapacityTrace,ar=e=>e.tabLoadCapacity.loadCapacityLayout,sr=e=>e.tabLoadCapacity.statusLoading,nr=e=>e.tabLoadCapacity.coeffTable,or=e=>e.tabLoadCapacity.msg,lr=e=>e.tabLoadCapacity.loadTable,{setLoadCapacityTrace:rr,setLoadCapacityLayout:ir,setLoadCapacityStatusLoading:en}=Wt.actions,cr=Wt.reducer,tn={statusLoading:r.idle,LTCTrace:null,LTCLayout:null},Yt=w({name:"tabLTCSlice",initialState:tn,reducers:{setLTCTrace:(e,t)=>{e.LTCTrace=t.payload},setLTCLayout:(e,t)=>{e.LTCLayout=t.payload},setLTCStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(ze.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(ze.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(ze.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.LTCLayout=s.layout,t.LTCTrace=s.traces})}}),ze=v("tabLTCSlice/TabChartsOfLTCQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),dr=e=>e.tabLTC.LTCTrace,ur=e=>e.tabLTC.LTCLayout,gr=e=>e.tabLTC.statusLoading,{setLTCTrace:pr,setLTCLayout:hr,setLTCStatusLoading:an}=Yt.actions,br=Yt.reducer,sn={statusLoading:r.idle,powerTrace:null,powerLayout:null},Jt=w({name:"tabPowerSlice",initialState:sn,reducers:{setPowerTrace:(e,t)=>{e.powerTrace=t.payload},setPowerLayout:(e,t)=>{e.powerLayout=t.payload},setPowerStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Ne.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Ne.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Ne.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,a.payload.v_lines,a.payload.translate);t.powerLayout=s.layout,t.powerTrace=s.traces})}}),Ne=v("tabPowerSlice/TabChartsOfPowerQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),fr=e=>e.tabPower.powerTrace,mr=e=>e.tabPower.powerLayout,yr=e=>e.tabPower.statusLoading,{setPowerTrace:xr,setPowerLayout:Sr,setPowerStatusLoading:nn}=Jt.actions,Lr=Jt.reducer;class on{async exportToFile(t,a){try{console.log(t),await fetch(t).then(s=>s.json()).then(s=>{const o=document.createElement("a");o.href=ys(a,s.file_name),o.download=`${s.file_name}`,o.click(),o.remove()})}catch(s){console.log(s)}}}Date.prototype.addHours=function(e){return this.setTime(this.getTime()+e*60*60*1e3),this};const We=(e,t)=>`${new Date(e).addHours(t).toISOString()}`.split(".")[0],bt=e=>{let t=new Date(e).toLocaleString().split(","),a=t[0].split(".");return`${a[2]}-${a[1]}-${a[0]}T${t[1].trim()}`},ln={gasesMeasureUnit:{gasesUnit:"(ppm)",rocGasesUnit:"(ppm/сут.)"},alternativeMeasureUnits:!1,statusLoadingLastValues:r.idle,lastValues:null,equpment:null,currentAgeing:null,ageinPerDay:null,image:null,pData:null,modelSettings:null,tciLast:null,outter:null,inner:null,data:null},Kt=w({name:"selectedEquipment",initialState:ln,reducers:{setAlternativeMeasureUnit:(e,t)=>{e.alternativeMeasureUnits=t.payload},setGasesMeasureUnit:(e,t)=>{e.gasesMeasureUnit=t.payload},setSelectedEquipment:(e,t)=>{var a,s,o;e.statusLoadingLastValues=(a=e.equpment)!=null&&a.elementId&&((s=e.equpment)==null?void 0:s.elementId)!==((o=t.payload)==null?void 0:o.elementId)?r.idle:e.statusLoadingLastValues,e.equpment=t.payload},setStatusLoadingLastValues:(e,t)=>{e.statusLoadingLastValues=t.payload},setLastValues:(e,t)=>{e.lastValues=t.payload},setOutter:(e,t)=>{e.outter=t.payload.map(a=>({i:a.i,x:a.x,y:a.y,w:a.w,h:a.h}))},setInner:(e,t)=>{const a=t.payload.map(s=>s.i);e.inner=[...e.inner.filter(s=>!a.includes(s.i)),...t.payload]}},extraReducers:e=>{e.addCase(Ue.pending,(t,a)=>{t.statusLoadingLastValues=r.loading}).addCase(Ue.rejected,(t,a)=>{t.statusLoadingLastValues=r.error}).addCase(Ue.fulfilled,(t,a)=>{t.statusLoadingLastValues=r.success,t.outter=a.payload.outter,t.inner=a.payload.inner,t.data=a.payload.data,t.tciLast=a.payload.tci_last,t.pData=a.payload.p_data??[],t.modelSettings=a.payload.model_settings??[],t.equpment===null&&(t.equpment={asset:a.payload.asset_name,elementId:a.payload.assetId,elementType:a.payload.asset_type,substId:a.payload.object_id})})}}),Ue=v("getLastValuesSelectedEquipmentQuery/selectedEquipment",async(e,t)=>{e.isTimer||t.dispatch(et());const a=t.getState().currentLocale.locale.value,s=await fetch(ps(a,e.id)).then(o=>o.json());return t.dispatch(Ya({subst_id:s.object_id,name:s.object_name})),{...s,assetId:+e.id}}),et=v("resetChartsStatuses/selectedEquipment",async(e,t)=>{console.log("RESET STATUSES CHARTS"),t.dispatch(vs(r.idle)),t.dispatch(ws(r.idle)),t.dispatch(Is(r.idle)),t.dispatch($s(r.idle)),t.dispatch(Rs(r.idle)),t.dispatch(Es(r.idle)),t.dispatch(As(r.idle)),t.dispatch(Ms(r.idle)),t.dispatch(Gs(r.idle)),t.dispatch(zs(r.idle)),t.dispatch(Us(r.idle)),t.dispatch(Qs(r.idle)),t.dispatch(Ys(r.idle)),t.dispatch(Zs(r.idle)),t.dispatch(en(r.idle)),t.dispatch(an(r.idle)),t.dispatch(nn(r.idle)),t.dispatch(Ja(r.idle))}),Tr=v("selectedEquipment/saveInfoBlocks",async(e,t)=>{const a={outter:t.getState().selectedEquipment.outter,inner:t.getState().selectedEquipment.inner};await fetch(hs(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)})}),rn=v("selectedEquipment/DownloadReportFileQuery",async(e,t)=>{try{const a=await t.getState().currentLocale.locale.value,s=new on;switch(e.placeTheCall){case"diagMessages":s.exportToFile(ms(a,e.id,bt(e.dateStart),bt(e.dateEnd),e.msgType,e.search??"",e.format),a);break;case"passpowrtData":s.exportToFile(bs(a,e.id),a);break;case"modelsSettings":s.exportToFile(fs(a,e.id),a);break}}catch{}}),Cr=e=>e.selectedEquipment.alternativeMeasureUnits,vr=e=>e.selectedEquipment.gasesMeasureUnit,jr=e=>e.selectedEquipment.statusLoadingLastValues,wr=e=>e.selectedEquipment.equpment,Dr=e=>e.selectedEquipment.pData,Ir=e=>e.selectedEquipment.modelSettings,kr=e=>e.selectedEquipment.data,$r=e=>e.selectedEquipment.outter,Pr=e=>e.selectedEquipment.inner,Rr=e=>e.selectedEquipment.tciLast,{setGasesMeasureUnit:_r,setSelectedEquipment:cn,setStatusLoadingLastValues:dn,setAlternativeMeasureUnit:Er,setLastValues:Or,setOutter:Ar,setInner:Fr}=Kt.actions,Mr=Kt.reducer,un={codeTab:"",codeSubTab:"",dateStart:We(new Date,-165),dateEnd:We(new Date,3),diagMsgSignals:""},Zt=w({name:"tabsControllerSlice",initialState:un,reducers:{setCodeTab:(e,t)=>{e.codeTab=t.payload},setCodeSubTab:(e,t)=>{e.codeSubTab=t.payload},setDateStart:(e,t)=>{e.dateStart=t.payload},setDateEnd:(e,t)=>{e.dateEnd=t.payload},setDiagMsgSignals:(e,t)=>{e.diagMsgSignals=t.payload}}}),Br=e=>e.tabsController.codeTab,Gr=e=>e.tabsController.codeSubTab,gn=e=>e.tabsController.dateStart,pn=e=>e.tabsController.dateEnd,Hr=e=>e.tabsController.diagMsgSignals,{setCodeTab:hn,setCodeSubTab:bn,setDateStart:Ve,setDateEnd:ft,setDiagMsgSignals:fn}=Zt.actions,zr=Zt.reducer;function Xt(e,t){p.useLayoutEffect(()=>{if(!e||!t)return;const a=setInterval(()=>{e()},1e3*t);return()=>{console.log("Timer clear"),clearInterval(a)}},[e,t])}const Nr=({value:e,dz:t,pdz:a,borderRadius:s})=>{const i="#99B1C9",u="#3B735A",g="#D36613",y="#D02D1C",b=p.useMemo(()=>{let d=null,f=null,m=null,h=null;return typeof t<"u"&&t!==null&&typeof a<"u"&&a!==null?(f=t/a*70,m=70,d=e<=a?e/a*70:100-30*Math.exp((a-e)/(a*5)),h=e<t?u:e>=t&&e<a?g:y):(typeof t>"u"||t===null)&&typeof a<"u"&&a!==null?(m=70,d=e<=a?e/a*70:100-30*Math.exp((a-e)/(a*5)),h=e<a?u:y):typeof t<"u"&&t!==null&&(typeof a>"u"||a===null)&&(f=70,d=e<=t?e/t*70:100-30*Math.exp((t-e)/(a*5)),h=e<t?u:y),e!=null&&e>=0&&(typeof t>"u"||t===null)&&(typeof a>"u"||a===null)&&(d=50,h=u),{fillBar:d,_dz:f,_pdz:m,colorBar:h}},[t,a,e]);return n.jsxs(c,{sx:{width:"100%",position:"relative"},children:[n.jsxs(c,{sx:{position:"relative",background:i,border:`1px solid ${i}`,borderRadius:`${s}px`??"10px",width:"100%",height:"20px"},children:[n.jsx(c,{sx:{position:"absolute",background:b.colorBar,borderRadius:`${s}px`??"10px",width:`${b.fillBar}%`,height:"20px"}}),n.jsx(c,{sx:{position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",fontSize:"1em",color:"white",zIndex:1e4,textShadow:"1px 2px 5px black",height:"20px"},children:e})]}),b._dz!=null?n.jsx(c,{sx:{position:"absolute",left:`${b._dz}%`,top:"-15%",borderLeft:"2px solid rgba(63, 63, 63, 0.8)",height:"130%"}},F()):null,b._pdz!==null?n.jsx(c,{sx:{position:"absolute",left:`${b._pdz}%`,top:"-15%",borderLeft:"2px solid rgba(63, 63, 63, 0.8)",height:"130%"}},F()):null]})};Date.prototype.addHours=function(e){return this.setTime(this.getTime()+e*60*60*1e3),this};const mt=({getValue:e,label:t,placeHolder:a,dateValue:s,colorLable:o,limitDate:l})=>{const[i,u]=p.useState(window.matchMedia(Z).matches);p.useEffect(()=>{const d=window.matchMedia(Z);return d.addEventListener("change",f=>X(u,f.matches)),()=>d.removeEventListener("change",X)},[]);const g=L(N);p.useEffect(()=>{b(new Date(s))},[s]);const[y,b]=p.useState(s==null?new Date:new Date(s));return n.jsx(ye,{styles:{root:{display:"flex",alignItems:"center",width:i?"150px":"",height:i?"35px":""},label:{marginRight:"5px",color:o||"#003274",...P,fontSize:i?"0.8em":"1.2em"},wrapper:{margin:"0 5px"},input:{fontSize:i?"0.7em":"1em"}},maxDate:new Date(l),valueFormat:"DD.MM.YYYY / HH:mm",label:t,placeholder:a,locale:g.value,value:y,dropdownType:"modal",size:"xs",onChange:d=>{var f;b(d),e((f=new Date(d).addHours(3))==null?void 0:f.toISOString().replace("Z","").split(".")[0])}})},mn=()=>{const e=L(as),t=L(N),a=L($),[s,o]=p.useState();return p.useEffect(()=>{if(e!=null&&e!=null){const l=e.map(i=>n.jsxs("tr",{children:[n.jsx("td",{style:{...K,width:"5%",textAlign:"center"},children:i.row}),n.jsx("td",{style:K,children:i.notification}),n.jsx("td",{style:K,children:i.condition})]},F()));o(l)}},[e,a,t]),n.jsxs(Ye,{children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{...K,width:"5%",textAlign:"center"},children:"№"}),n.jsx("th",{style:{...K,textAlign:"center"},children:a.notificationLabel}),n.jsx("th",{style:{...K,textAlign:"center"},children:a.conditionLabel})]})}),n.jsx("tbody",{children:s})]})},K={border:"1px solid #003274",...P,...j};Date.prototype.addHours=function(e){return this.setTime(this.getTime()+e*60*60*1e3),this};const yn=({serachFilter:e,sorting:t,pagination:a,idAsset:s,dateStart:o,dateEnd:l,diagType:i,servicesType:u,locale:g})=>{var f,m;const y=i&&u?"all":i&&!u?"diag":!i&&u?"sys":"",b=t.length===0?{fieldOrder:"",typeOrder:""}:{fieldOrder:t[0].id,typeOrder:t[0].desc?"desc":"asc"},d=Ga(g.value,s,(f=new Date(o).addHours(3))==null?void 0:f.toISOString().replace("Z","").split(".")[0],(m=new Date(l).addHours(3))==null?void 0:m.toISOString().replace("Z","").split(".")[0],`${a.pageIndex*a.pageSize}`,`${a.pageSize}`,y,e??"",b.fieldOrder,b.typeOrder);return fa({queryKey:["msg",e,t,a,s,o,l,i,u,g],queryFn:()=>fetch(d).then(h=>h.json()),keepPreviousData:!0,staleTime:3e4})},xn=()=>{const e=Ct(),t=pa(),a=ee(),s=L(N),o=L($),l=L(gn),i=L(pn),[u,g]=p.useState(!1),y=p.useMemo(()=>[{accessorKey:"timestamp",header:o.dateLabel,size:70},{accessorKey:"asset",header:o.assetLabel,size:30},{accessorKey:"message",header:o.msgLabel,Cell:({cell:T})=>{const D=new String(T.getValue()).split(". ").length-1,ne=new String(T.getValue()).split(". ").map((oe,ca)=>n.jsxs("span",{children:[oe,D==ca?"":".",n.jsx("br",{})]},F()));return n.jsx("span",{style:{color:gs.find(oe=>oe.title===T.row.original.level).color},children:ne})}},{accessorKey:"options",header:o.actionLabel,Cell:()=>n.jsxs(ve,{width:180,position:"left",withArrow:!0,shadow:"md",children:[n.jsx(ve.Target,{children:n.jsx(A,{styles:{root:{background:"transparent",color:"black","&:hover":{background:"transparent",color:"black",transform:"scale(1.5)"}}},children:"•••"})}),n.jsxs(ve.Dropdown,{children:[n.jsxs(A,{styles:{root:{display:"flex",alignItems:"center",width:"100%",...P,marginBottom:"5px",background:"transparent",color:"#003274","&:hover":{background:"#003274",color:"white"}}},onClick:()=>{},children:[n.jsx(ha,{stroke:2}),o.getToWorkLabel]}),n.jsxs(A,{styles:{root:{display:"flex",alignItems:"center",width:"100%",...P,background:"transparent",color:"#003274","&:hover":{background:"#003274",color:"white"}}},onClick:()=>{},children:[n.jsx(ba,{stroke:2}),o.rejectLabel]})]})]}),size:30}],[s,o]),b=L(Wa),d=+t.assetid,f=+t.id,[m,h]=p.useState(""),[S,x]=p.useState([{id:"date",desc:!0}]),[E,R]=p.useState({pageIndex:0,pageSize:100}),[I,H]=p.useState(!0),[ae,sa]=p.useState(!1),{data:Y,isError:na,isFetching:oa,isLoading:la}=yn({serachFilter:m,sorting:S,pagination:E,idAsset:d,dateStart:l,dateEnd:i,diagType:I,servicesType:ae,locale:s}),se=(Y==null?void 0:Y.diag_messages)??[],ra=(Y==null?void 0:Y.count_messages)??0,ot=(T,D)=>{T=="start"?a(Ve(D)):(new Date(l)>new Date(D)&&a(Ve(D)),a(ft(D))),a(et())},ia=Je({columns:y,data:(se==null?void 0:se.length)>0?se.map(T=>({timestamp:T.timestamp.replace("T"," ").split(".")[0],asset:T.asset,message:T.message,level:T.level,tab:T.id_tab,equipmentId:T.asset_id,elementType:T.asset_type,signals:T.signals})):se,localization:o,columnFilterModeOptions:["contains"],initialState:{showColumnFilters:!1},enablePagination:!0,enableColumnActions:!1,enableColumnFilterModes:!1,enableGlobalFilterModes:!0,enableGlobalFilter:!0,enableColumnFilters:!1,enableFullScreenToggle:!0,enableDensityToggle:!1,manualFiltering:!0,manualPagination:!0,manualSorting:!0,onGlobalFilterChange:h,onPaginationChange:R,onSortingChange:x,rowCount:ra,state:{serachFilter:m,isLoading:la,pagination:E,showAlertBanner:na,showProgressBars:oa,sorting:S},mantinePaperProps:{sx:{width:"100%"}},mantineTableProps:{highlightOnHover:!1,withColumnBorders:!1,sx:{"thead > tr > th":{backgroundColor:"inherit",color:"#003274",...V},"tbody > tr > td":{"&:hover":{cursor:"pointer"}}}},mantineTableBodyCellProps:({cell:T})=>({onClick:D=>{if(T.column.id=="options")return;console.log(T.row.original.signals);const ne={...b.find(oe=>oe.asset_id===T.row.original.equipmentId),id:T.row.original.equipmentId};a(cn({asset:ne.name,elementId:ne.asset_id,elementType:ne.asset_type,substId:t.id})),T.column.id==="message"?(console.log(T),a(hn(T.row.original.tab)),a(bn("charts")),a(fn(T.row.original.signals)),a(ft(`${new Date(T.row.original.timestamp).addHours(4).toLocaleDateString().split(".").reverse().join("-")}T${new Date(T.row.original.timestamp).addHours(4).toLocaleTimeString()}`)),a(Ve(`${new Date(T.row.original.timestamp).addHours(-4).toLocaleDateString().split(".").reverse().join("-")}T${new Date(T.row.original.timestamp).addHours(-4).toLocaleTimeString()}`)),e(`/substation/${f}/${T.row.original.elementType}/${T.row.original.equipmentId}/charts`)):e(`/substation/${f}/${T.row.original.elementType}/${T.row.original.equipmentId}`)}}),renderTopToolbarCustomActions:({table:T})=>n.jsxs(c,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[n.jsx(dt,{label:o.diagnosticsCheckBoxLabel,styles:{label:{...j,...P},root:{margin:"5px"}},defaultChecked:!0,value:I,onChange:D=>H(D.currentTarget.checked)}),n.jsx(dt,{label:o.servicesCheckBoxLabel,styles:{label:{...j,...P},root:{margin:"5px"}},value:ae,onChange:D=>sa(D.currentTarget.checked)}),n.jsxs(c,{sx:{display:"flex",alignItems:"center",margin:"0 30px"},children:[n.jsx(mt,{label:"От",colorLable:"white",getValue:D=>ot("start",D),dateValue:l,limitDate:i}),n.jsx(mt,{label:"До",colorLable:"white",getValue:D=>ot("end",D),dateValue:i,limitDate:Date.now()})]}),n.jsxs(c,{sx:{display:"flex"},children:[n.jsx(xe,{label:`${o.expotToLabel} pdf`,color:"#003274",position:"top",withArrow:!0,style:P,children:n.jsxs(c,{sx:yt,onClick:()=>lt("pdf"),children:[n.jsx(qe,{stroke:2}),n.jsx(c,{sx:{margin:"0 5px",...P},children:"pdf"})]})}),n.jsx(xe,{label:`${o.expotToLabel} excel`,color:"#003274",position:"top",withArrow:!0,style:P,children:n.jsxs(c,{sx:yt,onClick:()=>lt("xls"),children:[n.jsx(qe,{stroke:2}),n.jsx(c,{sx:{margin:"0 5px",...P},children:"xls"})]})})]})]})}),lt=T=>{let D="";I&&ae?D="all":I&&!ae?D="diag":!I&&ae?D="sys":D="",a(rn({placeTheCall:"diagMessages",id:f,dateStart:l,dateEnd:i,msgType:D,search:m,format:T}))};return n.jsxs(c,{sx:{height:"100%",width:"100%",overflowY:"auto",borderTop:"1px solid black"},children:[n.jsx(Ke,{table:ia}),n.jsx(Ze,{opened:u,onClose:()=>g(!1),styles:{header:{...V,...j}},title:o.guideNotifications,centered:!0,size:"60%",overlayProps:{color:"black",opacity:.7,blur:5},children:n.jsx(mn,{})})]})},Ur=p.memo(({substationId:e})=>n.jsx(xn,{substationId:e})),yt={boxShadow:"2px 2px 2px black",margin:"0 5px",padding:"0 5px",display:"flex",alignItems:"center",...j,border:"1px solid #003274",borderRadius:"8px","&:hover":{transform:"scale(1.05)",cursor:"pointer"},"&:active":{transform:"scale(0.9)"}},Vr=({height:e})=>{const t=L($);return n.jsx(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:`${e}vh`},children:n.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[n.jsx(te,{color:"#003274"}),n.jsx(c,{sx:V,children:t.loadLabel})]})})},Sn=()=>{const e=ee(),t=L(ls),a=L(N),[s,o]=p.useState();p.useLayoutEffect(()=>{o(a.value)},[a]);const l=i=>{o(i),localStorage.setItem("locale",JSON.stringify(t.find(u=>u.value===i))),e(rs(t.find(u=>u.value===i))),e(fe()),e(be()),e(dn(r.idle)),e(et())};return t?n.jsx(vt,{data:t,value:s,onChange:i=>l(i),transitionProps:{transition:"pop-top-left",duration:100,timingFunction:"ease"},size:"xs"}):n.jsx(c,{children:"Empty"})},O={height:"20vh",width:"100%"},Q={fontSize:"1.1em",margin:"3% 0",display:"flex"};function W(e,t=null){const[a,s]=p.useState(r.idle),[o,l]=p.useState(t);function i(){s(r.idle)}function u(){a!==r.loading&&(s(r.loading),e().then(g=>{l(g),s(r.success)}).catch(()=>{s(r.error)}))}return{error:a===r.error,success:a===r.success,loading:a===r.loading,default:a===r.idle,data:o,setData:l,resetApiCallStatus:i,apiCaller:u}}const Ln=({setIsNexStepAvalible:e,loadParam:t,setLoadParamCb:a})=>{const s=L($),o=W(()=>fetch(Ha()).then(i=>i.json()));p.useEffect(()=>{o.apiCaller()},[]);const l=()=>!!(o.loading||o.data!==null&&o.data.status[0]==="Success");return p.useEffect(()=>{o.data!==null&&o.data.status[0]==="Success"&&(e(!0),a({...t,ip:o.data.ip}))},[o.data]),n.jsxs(c,{sx:{...O,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[n.jsx(c,{children:o.loading?null:o.data!==null?o.data.status[0]==="Error"?n.jsx(c,{children:o.data.status[1].map(i=>n.jsxs(c,{sx:{...Q,color:_.find(u=>u.levelState===2).color},children:[n.jsx(de,{stroke:2,color:_.find(u=>u.levelState===2).color}),n.jsx(c,{children:i})]},F()))}):n.jsxs(c,{sx:{...Q,color:_.find(i=>i.levelState===0).color},children:[n.jsx(jt,{stroke:2,color:_.find(i=>i.levelState===0).color}),n.jsx(c,{children:s.successLabel})]}):null}),n.jsx(A,{disabled:l(),styles:{root:{background:j.color}},onClick:()=>o.apiCaller(),children:o.loading?n.jsx(c,{children:n.jsx(te,{variant:"dots"})}):n.jsx(c,{children:s.doConnectLabel})})]})},Tn=()=>`${C}/assets`,Cn=(e,t,a,s,o=!1)=>`${C}/signalStats?assetGuid=${e}&signal=${t}&dateStart=${a.toJSON()}&dateEnd=${s.toJSON()}&onlyBad=${o}`,Qr=(e,t,a)=>`${C}/asset/${e}/devicesStats?&dateStart=${t.toJSON()}&dateEnd=${a.toJSON()}`,vn=()=>`${Fa}/ping`,jn=e=>`${C}/devices/${e}/connection-params`,qr=()=>`${C}/protocols`,ea=[{value:5*6e4,label:"5 мин"},{value:30*6e4,label:"30 мин"},{value:60*6e4,label:"1 ч"},{value:4*60*6e4,label:"4 ч"},{value:6*60*6e4,label:"6 ч"},{value:24*60*6e4,label:"24 ч"}];function Wr(e){if(!e)return[];let t=[];for(let a=0;a<e.length;a++)t.push({value:e[a].asset_guid,label:e[a].asset_name,group:e[a].substation_name});return t}function wn(e){return typeof e=="number"?new Date(e*1e3):e}function Dn(e){var a,s,o,l,i;let t={protocol:(a=e.protocol)==null?void 0:a.code,asset:`any_asset_${(s=e.access_point)==null?void 0:s.code}`,address:(o=e.access_point)==null?void 0:o.url,host:(l=e.access_point)==null?void 0:l.ip,port:(i=e.access_point)==null?void 0:i.port};return!t.protocol||!t.host||!t.port?null:t}function In(e,t){for(let a=0;a<e.length;a++)if(e[a].name===t)return e[a];return null}const Te="filterStatsSliceState";let q=JSON.parse(window.localStorage.getItem(Te)||"null");q=q||{dtStep:ea[5].value,dt:new Date,onlyBadFlag:!1,selectedDeviceId:null,selectedAssetGuid:null};q.dt=new Date(q.dt);localStorage.setItem(Te,JSON.stringify(q));const ce=(e,t)=>{let a=JSON.parse(window.localStorage.getItem(Te)||JSON.stringify(q));a={...a,[e]:t},localStorage.setItem(Te,JSON.stringify(a))},ta=w({name:"filterStatsSlice",initialState:q,reducers:{setDtStep:(e,t)=>{e.dtStep=t.payload,ce("dtStep",t.payload)},setDt:(e,t)=>{e.dt=t.payload,ce("dt",t.payload)},setOnlyBadFlag:(e,t)=>{e.onlyBadFlag=t.payload,ce("onlyBadFlag",t.payload)},setSelectedDeviceId:(e,t)=>{e.selectedDeviceId=t.payload,ce("selectedDeviceId",t.payload)},setSelectedAssetGuid:(e,t)=>{e.selectedAssetGuid=t.payload,ce("selectedAssetGuid",t.payload)}}}),tt=e=>e.filterStats.dtStep,at=e=>e.filterStats.dt,Yr=ma([at,tt],(e,t)=>new Date(new Date(e).getTime()+t)),kn=e=>e.filterStats.onlyBadFlag,$n=e=>e.filterStats.selectedDeviceId,aa=e=>e.filterStats.selectedAssetGuid,{setDt:Qe,setDtStep:Pn,setOnlyBadFlag:Jr,setSelectedDeviceId:Rn,setSelectedAssetGuid:Kr}=ta.actions,Zr=ta.reducer,Xr=e=>{const t=ee(),a=L(aa),s=L(N),o=L($)||{},l=L(at),i=L(tt);function u(g){g<0?t(Qe(new Date(l.getTime()-i))):t(Qe(new Date(l.getTime()+i)))}return n.jsx(n.Fragment,{children:n.jsxs(c,{sx:{display:"flex",alignItems:"center",margin:"20px 0"},children:[n.jsxs(c,{sx:{display:"flex",alignItems:"center",marginRight:"20px"},children:[n.jsx(ut,{variant:"transparent",sx:{border:"1px solid #ced4da",borderRadius:"0.25rem 0 0 0.25rem",height:"36px"},children:n.jsx(ya,{size:"2rem",color:"#ced4da",onClick:()=>u(-1)})}),n.jsx(ye,{valueFormat:"DD.MM.YYYY / HH:mm",placeholder:"Выберите дату и время",maw:250,miw:250,locale:s.value,value:l,onChange:g=>t(Qe(g)),sx:{"& button":{borderRadius:0,borderLeft:0,borderRight:0}}}),n.jsx(ut,{variant:"transparent",sx:{border:"1px solid #ced4da",borderRadius:"0 0.25rem 0.25rem 0",height:"36px"},children:n.jsx(xa,{size:"2rem",color:"#ced4da",onClick:()=>u(1)})})]}),n.jsx(vt,{data:ea,value:i,onChange:g=>t(Pn(g)),maw:100,sx:{marginRight:"20px"}}),n.jsx(A,{variant:"filled",onClick:e.onApplyClick,disabled:a===null,loading:e.deviceStatsApi.loading,sx:{backgroundColor:"#003274"},children:o.applyLabel||"Apply"})]})})};function _n(e){const[t,a]=p.useState(window.innerWidth),[s,o]=p.useState(window.innerHeight);p.useEffect(()=>(e&&e.current&&e.current.offsetWidth!==null&&(a(e.current.offsetWidth),o(e.current.offsetHeight),window.addEventListener("resize",l)),()=>window.removeEventListener("resize",l)),[e]);const l=()=>{a(e.current.offsetWidth),o(e.current.offsetHeight)};return{width:t,height:s}}const En=e=>{const t=L($)||{},[a,s]=p.useState(!1),[o,l]=p.useState(void 0),i=e.assetGuid,u=L(kn),g=L(at),y=L(tt),b=[{id:"code",header:t.codeLabel||"Code",accessorFn:x=>x.code!==null?n.jsx(c,{px:2,children:x.code}):null},{id:"name",accessorKey:"name",header:t.nameLabel||"Name",minSize:260},{id:"enabled",header:t.enabledLabel||"Enabled",minSize:10,maxSize:20,mantineTableHeadCellProps:{align:"center"},accessorFn:x=>{if(x.enabled!==void 0&&x.enabled!==null){const E=x.enabled?"YES":"NO",R=x.enabled?"green":"grey";return n.jsx(c,{sx:{color:R,display:"flex",alignItems:"center",padding:"5px 10px",justifyContent:"center"},children:E})}return null}},{id:"last_status",header:t.statusLabel||"Status",minSize:20,maxSize:20,mantineTableHeadCellProps:{align:"center"},accessorFn:x=>{const E=Se();if(x.last_status!==void 0&&x.enabled!==null){let R="grey";return x.success_statuses+x.fail_statuses>0&&(x.last_status?R="green":R=E.colors.red[8]),n.jsx(c,{sx:{color:R,display:"flex",alignItems:"center",padding:"5px 10px",justifyContent:"center"},children:n.jsx(wt,{})})}return null}},{id:"last_message",accessorKey:"last_message",header:t.errorMessageLabel||"Error Message"},{id:"last_datetime",header:t.datetimeLabel||"Datetime",minSize:75,accessorFn:x=>x.last_timestamp?wn(x.last_timestamp):null},{id:"period_stats",header:t.statsLabel||"Statistics",minSize:30,maxSize:60,accessorFn:x=>{const E=Se();if(x.success_statuses!==void 0&&x.success_statuses!==null){let R="black";const I=x.success_statuses+x.fail_statuses;let H=null;return I>0&&(H=Math.round(x.success_statuses/I*1e4)/100,H>=90?R="green":H<50?R=E.colors.red[8]:H<90&&(R="orange")),n.jsxs(c,{sx:{color:R,fontWeight:600},children:[`${x.success_statuses} / ${I}`,H!==null&&` (${H} %)`]})}return null}},{id:"chart_button",header:t.chartLabel||"Chart",minSize:10,maxSize:30,accessorFn:x=>n.jsx(A,{onClick:()=>{s(!0),l(x)},sx:{background:"#003274"},children:n.jsx(Sa,{})})}],d=W(()=>fetch(Cn(i,o==null?void 0:o.code,g,new Date(g.getTime()+y),u)).then(x=>x.json()),{});p.useEffect(()=>{a&&d.apiCaller()},[a]);const f=Je({columns:b,data:e.signalsStats||[],enableExpanding:!1,enableExpandAll:!1,enableColumnActions:!1,enableColumnFilters:!1,enablePagination:!1,enableSorting:!1,state:{density:"compact",showLoadingOverlay:e.loading,showSkeletons:e.loading,withTableBorder:!0},withTableBorder:!0,enableTopToolbar:!1,enableBottomToolbar:!1,getRowId:x=>x.code,mantineTableHeadProps:({})=>({sx:{border:"1px solid #dddddd"}}),mantineTableBodyCellProps:({row:x})=>({sx:{background:"none",padding:"0 10px",border:"1px solid #dddddd"}}),mantineTableBodyRowProps:({})=>({onClick:()=>{},sx:{cursor:"pointer"}})}),m=p.useRef(null),h=_n(m),S=p.forwardRef((x,E)=>n.jsxs(Ze,{ref:E,opened:a,onClose:()=>{s(!1),d.setData(null)},title:"Считывания сигнала",centered:!0,size:"calc(100vw - 3rem)",overlayProps:{blur:1},sx:{"& .mantine-Modal-inner":{padding:"5dvh 0"}},children:[d.loading&&n.jsx(te,{size:36,sx:{margin:"auto",display:"block"}}),d.success&&d.data&&o&&d.data[o.code]&&(d.data[o.code].x||[]).length>0&&n.jsx(La,{useResizeHandler:!0,data:[{x:d.data[o.code].x||[],y:d.data[o.code].y||[],text:d.data[o.code].messages||[],mode:"lines+markers",name:"vh",line:{shape:"vh"},type:"scatter"}],layout:{title:`${o.name}, ${o.code}`,width:h.width-100,height:h.height-200,showlegend:!1},config:{...k.GetConfig(),displayModeBar:!1,fluid:!0}}),!d.loading&&o&&d.data&&d.data[o.code]&&(d.data[o.code].x||[]).length===0&&n.jsx(Le,{c:"dimmed",sx:{textAlign:"center"},children:t.notDataLabel||"No data"})]}));return n.jsxs(n.Fragment,{children:[n.jsx(S,{}),n.jsx(Ke,{table:f})]})},On=e=>{const{row:t,deviceId:a}=e;if(!t||!t.protocol||!t.access_point)return n.jsx(Le,{children:"No protocol configuration provided"});const[s,o]=p.useState(t.access_point),[l,i]=p.useState(r.idle),u=b=>{o(b),i(r.idle)},g=()=>{i(r.loading);let b={accessPointData:s,protocolId:t.protocol.id};const d={method:"PUT",body:JSON.stringify(b),headers:{"Content-Type":"application/json"}};fetch(jn(a),d).then(f=>f.json()).then(f=>(i(r.success),gt.show({title:"Изменения сохранены!",color:"green"}),f)).catch(()=>{i(r.error),gt.show({title:"Ошибка!",message:"Не удалось сохранить изменения!",color:"red"})})};let y=null;return t.protocol.code==="modbus_tcp"?y=n.jsx(An,{accessPointData:s,setAccessPointData:u}):t.protocol.code==="modbus_rtu"?y=n.jsx(Fn,{accessPointData:s,setAccessPointData:u}):t.protocol.code==="mms"?y=n.jsx(Mn,{accessPointData:s,setAccessPointData:u}):t.protocol.code==="opc"&&(y=n.jsx(Bn,{accessPointData:s,setAccessPointData:u})),y?n.jsxs(c,{sx:{display:"flex",alignItems:"flex-end",justifyContent:"space-between",width:"100%"},children:[y,n.jsx(c,{sx:{display:"flex",alignItems:"center"},children:n.jsx(A,{sx:{minWidth:"100px",background:"#003274",marginRight:10},onClick:()=>g(),loading:l===r.loading,children:"Сохранить"})})]}):n.jsx(Le,{children:"No protocol configuration provided"})},An=e=>{const{accessPointData:t,setAccessPointData:a}=e;if(!t)return null;const[s,o]=p.useState(t.url||void 0);return n.jsx(n.Fragment,{children:n.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[n.jsx(st,{value:t.ip||"",setValue:l=>a({...t,ip:l})}),n.jsx(nt,{value:t.port||"",setValue:l=>a({...t,port:l})}),n.jsx(Xe,{min:1,placeholder:"Slave ID",label:"Slave ID",withAsterisk:!0,value:s===void 0?void 0:+s,onChange:l=>{a({...t,url:l}),o(l)},sx:{marginRight:15}})]})})},Fn=e=>{const{accessPointData:t,setAccessPointData:a}=e;if(!t)return null;const[s,o]=p.useState(t.com_port||""),[l,i]=p.useState(t.parity||void 0),[u,g]=p.useState(t.parity||void 0),[y,b]=p.useState(t.stop_bits||void 0),[d,f]=p.useState(t.data_bits||void 0);return n.jsx(n.Fragment,{children:n.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[n.jsx(Dt,{label:"COM port",placeholder:"COM port",value:s,onChange:m=>{a({...t,com_port:m.target.value}),o(m.target.value)},withAsterisk:!0,sx:{marginRight:15}}),n.jsx(Xe,{placeholder:"Baud rate",label:"Baud rate",withAsterisk:!0,value:l===void 0?void 0:+l,onChange:m=>{a({...t,baud_rate:m}),i(m)},sx:{marginRight:15}}),n.jsx(pe,{data:[{label:"(E)ven",value:"Even"},{label:"(O)dd",value:"Odd"},{label:"(N)one",value:"None"}],placeholder:"Parity",label:"Parity",withAsterisk:!0,defaultValue:"Even",value:u,onChange:m=>{a({...t,parity:m.target.value}),g(m.target.value)},sx:{marginRight:15}}),n.jsx(pe,{data:["0","1","2"],placeholder:"Stop bits",label:"Stop bits",withAsterisk:!0,defaultValue:"1",value:y,onChange:m=>{a({...t,stop_bits:m.target.value}),b(m.target.value)},sx:{marginRight:15}}),n.jsx(pe,{data:["7","8"],placeholder:"Byte size",label:"Byte size",withAsterisk:!0,defaultValue:"8",value:d,onChange:m=>{a({...t,data_bits:m.target.value}),f(m.target.value)},sx:{marginRight:15}})]})})},Mn=e=>{const{accessPointData:t,setAccessPointData:a}=e;return t?n.jsx(n.Fragment,{children:n.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[n.jsx(st,{value:t.ip||"",setValue:s=>a({...t,ip:s})}),n.jsx(nt,{value:t.port||"",setValue:s=>a({...t,port:s})})]})}):null},Bn=e=>{const{accessPointData:t,setAccessPointData:a}=e;return t?n.jsx(n.Fragment,{children:n.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[n.jsx(st,{value:t.ip||"",setValue:s=>a({...t,ip:s})}),n.jsx(nt,{value:t.port||"",setValue:s=>a({...t,port:s})})]})}):null},st=e=>n.jsx(Dt,{label:"IP",placeholder:"IP",value:e.value,onChange:t=>{e.setValue(t.target.value||null)},withAsterisk:!0,sx:{marginRight:15}}),nt=e=>n.jsx(Xe,{max:65535,min:1,placeholder:"Port",label:"Port",withAsterisk:!0,value:e.value,onChange:t=>{e.setValue(t||null)},sx:{marginRight:15}}),Gn=5e3,ei=e=>{const t=ee(),[a,s]=p.useState([]),o=L($)||{},[l,i]=p.useState(null),u=L(aa),g=L($n),y=[{id:"name",accessorKey:"name",header:o.deviceLabel||"Device",maxSize:100},{id:"enabled",header:o.enabledLabel||"Enabled",minSize:30,maxSize:50,mantineTableHeadCellProps:{align:"center"},accessorFn:d=>{if(d.enabled!==void 0&&d.enabled!==null){const f=d.enabled?"YES":"NO",m=d.enabled?"green":"grey";return n.jsx(c,{sx:{color:m,display:"flex",alignItems:"center",padding:"5px 10px",justifyContent:"center"},children:f})}return null}},{id:"stats",header:o.statsLabel||"Statistics",maxSize:200,accessorFn:d=>{const f=Se();if(d.signals_stats){const m=d.signals_stats.filter(S=>S.last_status).length,h=d.signals_stats.length;return n.jsx(c,{sx:{color:m===h?"green":m===0?f.colors.red[8]:"orange",fontWeight:600},children:`${m} / ${h}`})}return null}},{id:"ping",header:o.pingLabel||"Ping",minSize:15,maxSize:50,mantineTableHeadCellProps:{align:"center"},accessorFn:d=>{const f=Se(),m=d.ping_status===-1||d.ping_status===void 0;if(!d.ping){let h="grey";return d.ping_status===0?h="green":d.ping_status===1&&(h=f.colors.red[8]),n.jsxs(c,{sx:{color:h,background:"none",padding:"1px 10px",display:"flex",alignItems:"center",justifyContent:"center",height:"20px"},children:[!m&&n.jsx(wt,{sx:{margin:"auto"}}),m&&n.jsx(Le,{children:"-"})]})}return null}},{id:"protocol",accessorKey:"protocol.name",header:o.protocolLabel||"Protocol",maxSize:150,accessorFn:d=>{var f;return n.jsx(pe,{onClick:m=>m.stopPropagation(),data:e.protocolsApi.data.map(m=>m.name),value:((f=d.protocol)==null?void 0:f.name)||"",onChange:m=>{const h=m.target.value;for(let S=0;S<e.deviceStatsApi.data.length;S++)if(d.id===e.deviceStatsApi.data[S].id){const x=In(e.protocolsApi.data,h);e.deviceStatsApi.data[S].protocol=x,e.deviceStatsApi.setData(()=>[...e.deviceStatsApi.data]);return}}})}},{id:"proto_params",header:o.connectionParams||"Параметры подключения",mantineTableHeadCellProps:{align:"center"},minSize:600,accessorFn:d=>n.jsx(c,{onClick:f=>{f.stopPropagation()},sx:{background:"none",display:"flex",alignItems:"center",padding:"4px 8px"},children:n.jsx(On,{row:d,deviceId:d.id})})}];p.useEffect(()=>{if(a.length>0){let d=setInterval(()=>{fetch(vn(),{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then(f=>f.json()).then(f=>{f=f.values;const m=e.deviceStatsApi.data.map(h=>{var S;for(let x=0;x<f.length;x++)((S=h.protocol)==null?void 0:S.code)===f[x].protocol&&h.access_point.ip===f[x].host&&h.access_point.port===f[x].port&&f[x].value?h.ping_status=0:h.ping_status=1;return h});e.deviceStatsApi.setData(m)}).catch(()=>{const f=e.deviceStatsApi.data.map(m=>(m.ping_status=-1,m));e.deviceStatsApi.setData(f)})},Gn);return()=>{clearInterval(d)}}},[a]),p.useEffect(()=>{var d,f,m;if((d=e.deviceStatsApi)!=null&&d.data&&s((f=e.deviceStatsApi)==null?void 0:f.data.map(Dn).filter(Boolean)),(m=e.deviceStatsApi)!=null&&m.data&&g){const h=(e.deviceStatsApi.data||[]).find(S=>S.id===g);h&&i(()=>h.signals_stats)}},[e.deviceStatsApi.data]);const b=Je({columns:y,data:e.deviceStatsApi.data||[],enableExpanding:!1,enableExpandAll:!1,enableColumnActions:!1,enableColumnFilters:!1,enablePagination:!1,enableSorting:!1,enableTopToolbar:!1,enableBottomToolbar:!1,enableColumnResizing:!0,state:{showLoadingOverlay:e.deviceStatsApi.loading,showSkeletons:e.deviceStatsApi.loading,density:"compact",withTableBorder:!0},withTableBorder:!0,getRowId:d=>d.id,mantineTableBodyCellProps:({row:d})=>({sx:{background:g===d.id?"#e8e8e8":"none",padding:"0 10px",border:"1px solid #dddddd"}}),mantineTableHeadProps:({})=>({sx:{border:"1px solid #dddddd"}}),mantineTableBodyRowProps:({row:d})=>({onClick:()=>{const f=g===d.id?null:d.id;t(Rn(f)),i(d.original.signals_stats)},sx:{cursor:"pointer"},selected:g===d.id})});return n.jsxs(c,{children:[n.jsx(pt,{order:4,my:10,children:o.devicesLabel||"Devices"}),n.jsx(Ke,{table:b}),g&&n.jsxs(n.Fragment,{children:[n.jsx(pt,{order:5,mt:30,mb:10,children:o.signalsLabel||"Signals"}),n.jsx(En,{signalsStats:l,loading:e.deviceStatsApi.loading,assetGuid:u})]})]})},Hn=({setIsNexStepAvalible:e,loadParam:t,setLoadParamCb:a})=>{const s=L($),o=L(N),l=W(()=>fetch(Tn()).then(S=>S.json())),[i,u]=p.useState(null),[g,y]=p.useState(t.dateStart),[b,d]=p.useState(t.dateEnd);p.useEffect(()=>{y(new Date().addHours(-168)),d(new Date().addHours(0)),a({...t,dateStart:new Date().addHours(-168),dateEnd:new Date().addHours(0)}),e(!1),l.apiCaller()},[]),p.useEffect(()=>{t.dateStart!==null&&t.dateEnd!==null&&t.asset!==null&&e(!0)},[t.dateStart,t.dateEnd]);const f=(S,x)=>{u(x),a({...t,asset:S.asset_guid}),e(!0)},m=S=>{y(new Date(S)),a({...t,dateStart:S})},h=S=>{new Date(S)>new Date(g)?(d(new Date(S)),a({...t,dateEnd:S})):(y(new Date(S)),d(new Date(S)),a({...t,dateStart:S,dateEnd:S}))};return n.jsxs(c,{sx:O,children:[n.jsxs(c,{children:[n.jsx(c,{sx:xt,children:s.chooseAssetLabel}),n.jsx(c,{sx:{display:"flex",justifyContent:"space-around",flexWrap:"wrap"},children:l.data!==null?l.data.assets.map((S,x)=>n.jsx(A,{styles:{root:{background:i===x?"RGB(34, 139, 230)":j.color}},onClick:()=>f(S,x),children:S.asset_name??" "},F())):null})]}),n.jsxs(c,{children:[n.jsx(c,{sx:xt,children:s.selectDataRangeLable}),n.jsxs(c,{sx:{width:"100%",display:"flex",justifyContent:"space-around"},children:[n.jsx(ye,{label:s.fromLabel,styles:St,valueFormat:"DD.MM.YYYY / HH:mm",dropdownType:"modal",locale:o.value,maxDate:new Date(b),onChange:S=>m(S),value:g}),n.jsx(ye,{label:s.fromLabel,styles:St,valueFormat:"DD.MM.YYYY / HH:mm",dropdownType:"modal",locale:o.value,maxDate:new Date,onChange:S=>h(S),value:b})]})]})]})},xt={display:"flex",justifyContent:"center",margin:"2% 0",...j,fontSize:"1.1em"},St={root:{display:"flex",alignItems:"center",width:"50%",height:"35px",justifyContent:"center"},label:{marginRight:"5px",color:"#003274",...P,fontSize:"1em"},wrapper:{margin:"0 5px",width:"50%"},input:{fontSize:"1em"}},zn=({setIsNexStepAvalible:e,loadParam:t})=>{const a=L($),s=W(()=>fetch(za(We(t.dateStart,3),t.asset)).then(o=>o.json()));return p.useEffect(()=>{e(!1),s.apiCaller()},[]),p.useEffect(()=>{s.data!==null&&e(s.data.empty_signals.length===0)},[s.data]),s.loading||s.data===null?n.jsx(c,{sx:O,children:n.jsx(te,{variant:"dots"})}):s.error?n.jsx(c,{sx:O,children:a.errorCheckDataLabel}):s.data.empty_signals.length===0?n.jsx(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",...O},children:n.jsxs(c,{sx:{...Q,color:_.find(o=>o.levelState===0).color},children:[n.jsx(jt,{stroke:2,color:_.find(o=>o.levelState===0).color}),n.jsx(c,{children:a.successLabel})]})}):n.jsxs(c,{sx:{...O,overflowY:"auto"},children:[n.jsx(c,{sx:{...V,...j,color:_.find(o=>o.levelState===2).color},children:a.siganlsMissingLabel}),n.jsxs(Ye,{striped:!0,withColumnBorders:!0,children:[n.jsx("thead",{}),n.jsx("tbody",{children:s.data.empty_signals.map(o=>n.jsxs("tr",{children:[n.jsx("td",{children:o[0]}),n.jsx("td",{children:o[1]})]},F()))})]})]})},Nn=({param:e,nextStep:t,setLoadingId:a})=>{const s=L($),o=W(()=>{var l,i;return fetch(Na((l=new Date(e.dateStart).addHours(3))==null?void 0:l.toISOString().replace("Z","").split(".")[0],(i=new Date(e.dateEnd).addHours(3))==null?void 0:i.toISOString().replace("Z","").split(".")[0],e.asset,e.ip)).then(u=>u.json())});return p.useEffect(()=>{o.apiCaller()},[]),p.useEffect(()=>{o.success&&o.data.status[0].toLowerCase()==="success"&&(a(o.data.loaded_data_id),t())},[o.loading]),o.loading?n.jsxs(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",...O},children:[n.jsx(c,{sx:{...Q,margin:"0",...j,...P},children:s.dataCollectLabel}),n.jsx(c,{children:n.jsx(te,{variant:"dots"})})]}):n.jsx(c,{sx:{display:"flex",justifyContent:"center",...O},children:o.data!==null&&o.data.status[0].toLowerCase()==="error"?o.data.status[1].map(l=>n.jsxs(c,{sx:{...Q,color:_.find(i=>i.levelState===2).color},children:[n.jsx(de,{stroke:2,color:_.find(i=>i.levelState===2).color}),n.jsx(c,{children:l})]},F())):null})},Un=({loadingId:e,nextStep:t})=>{const a=L($),s=W(()=>fetch(Va(e)).then(o=>o.json()));return p.useEffect(()=>{s.apiCaller()},[]),p.useEffect(()=>{s.data!==null&&s.data.loaded_data!==null&&s.data.loaded_data.percent_processed===100&&t()},[s]),Xt(()=>{s.apiCaller()},1),s.data===null?n.jsx(c,{sx:O,children:n.jsx(te,{variant:"dots"})}):s.data.status[0].toLowerCase()==="error"?n.jsx(c,{sx:{...O},children:s.data.status[1].map(o=>n.jsxs(c,{sx:{...Q,color:_.find(l=>l.levelState===2).color},children:[n.jsx(de,{stroke:2,color:_.find(l=>l.levelState===2).color}),n.jsx(c,{children:o})]},nanoid()))}):n.jsxs(c,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",...O},children:[n.jsx(c,{sx:{...P,...j},children:a.diagnosticCalculateLabel}),n.jsx(c,{sx:{width:"80%"},children:n.jsx(Ta,{label:s.data.loaded_data.percent_processed+"%",size:"xl",radius:"xl",value:s.data.loaded_data.percent_processed})})]})},Vn=()=>{const e=L($),[t,a]=p.useState({dateStart:null,dateEnd:null,ip:null,asset:null}),[s,o]=p.useState(null),[l,i]=p.useState(!1),[u,g]=p.useState(0),y=()=>g(d=>d<5?d+1:d),b=()=>g(d=>d>0?d-1:d);return p.useEffect(()=>{s!==null&&getIdLoading(s)},[]),n.jsxs(c,{sx:{height:"100%",width:"100%"},children:[n.jsxs(U,{color:j.color,active:u,onStepClick:g,breakpoint:"sm",allowNextStepsSelect:!1,children:[n.jsx(U.Step,{label:`${e.stepLabel} 1`,description:`${e.connectLabel}`,icon:n.jsx(Ca,{stroke:2}),children:n.jsx(Ln,{setIsNexStepAvalible:i,loadParam:t,setLoadParamCb:a})}),n.jsx(U.Step,{label:`${e.stepLabel} 2`,description:`${e.loadParamsLabel}`,icon:n.jsx(va,{stroke:2}),children:n.jsx(Hn,{setIsNexStepAvalible:i,loadParam:t,setLoadParamCb:a})}),n.jsx(U.Step,{label:`${e.stepLabel} 3`,description:`${e.validationLabel}`,icon:n.jsx(ja,{stroke:2}),children:n.jsx(zn,{setIsNexStepAvalible:i,loadParam:t})}),n.jsx(U.Step,{label:`${e.stepLabel} 4`,description:`${e.dataCollectLabel}`,icon:n.jsx(ht,{stroke:2}),children:n.jsx(Nn,{param:t,nextStep:y,setLoadingId:o})}),n.jsx(U.Step,{label:`${e.stepLabel} 5`,description:`${e.diagosticLabel}`,icon:n.jsx(ht,{stroke:2}),children:n.jsx(Un,{loadingId:s,nextStep:y})}),n.jsx(U.Completed,{children:n.jsx(c,{sx:{...O,...P,...j,display:"flex",justifyContent:"center",alignItems:"center"},children:e.diagProcessComplieate})})]}),n.jsxs(wa,{position:"center",mt:"xl",display:u>=3?"none":"flex",children:[n.jsx(A,{disabled:u===0,variant:"default",onClick:b,children:e.backLabel}),n.jsx(A,{disabled:!l||u===3||u===4,styles:{root:{background:j.color}},onClick:y,children:e.nextLabel})]})]})},Qn=[{status:1,name:"Загружены в шину",translateLabel:"loadedToMessagingBusesLabel",color:{from:"rgba(34, 139, 230, 0.8)",to:"rgba(88, 139, 230, 0.8)"},hasTranslate:!0},{status:2,name:"В обработке",translateLabel:"inProcessLabel",color:{from:"rgba(34, 139, 230, 0.8)",to:"rgba(88, 139, 230, 0.8)"},hasTranslate:!1},{status:3,name:"Обработаны",translateLabel:"processedLabel",color:{from:"RGB(71, 193, 108)",to:"rgba(139, 193, 108, 0.8)"},hasTranslate:!0},{status:4,name:"Нет данных",translateLabel:"notDataLabel",color:{from:"rgba(255, 118, 85, 0.8)",to:"rgba(255, 121, 87, 0.8)"},hasTranslate:!0},{status:5,name:"Ошибка при обработке",translateLabel:"errorOnTheProcessedLabel",color:{from:"rgba(255, 118, 85, 0.8)",to:"rgba(255, 121, 87, 0.8)"},hasTranslate:!0}],qn=({tab:e})=>{const t=L($),a=W(()=>fetch(Ua()).then(s=>s.json()));return Xt(()=>{a.apiCaller()},1),p.useEffect(()=>{e==="history"&&a.apiCaller()},[e]),a.error?n.jsx(c,{sx:{display:"flex",justifyContent:"center"},children:n.jsxs(c,{sx:{display:"flex",justifyContent:"center"},children:[n.jsx(de,{stroke:2,color:_.find(s=>s.levelState===2).color}),n.jsx(c,{children:t.unsuccessLabel})]})}):a.data===null?null:a.data!==null&&a.data.status[0].toLowerCase()==="error"?n.jsx(c,{children:laser.data.status[1].map(s=>n.jsxs(c,{sx:{...Q,color:_.find(o=>o.levelState===2).color},children:[n.jsx(de,{stroke:2,color:_.find(o=>o.levelState===2).color}),n.jsx(c,{children:s})]},F()))}):n.jsx(c,{sx:{width:"100%",height:"35vh",overflowY:"auto"},children:n.jsxs(Ye,{children:[n.jsx("thead",{}),n.jsx("tbody",{children:a.data.loading.map(s=>{const o=Qn.find(l=>l.status===s.status);return o.status===2&&(o.name=s.percent_processed+" %"),n.jsxs("tr",{style:{...j,...P},children:[n.jsx("td",{children:s.asset_name}),n.jsx("td",{children:s.date_start}),n.jsx("td",{children:s.date_end}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx(Da,{variant:"gradient",gradient:o.color,styles:{root:{maxWidth:"70%",width:"70%"}},children:o.hasTranslate?t[o.translateLabel]:o.name})})]},F())})})]})})},Wn=({isOpen:e,close:t})=>{const a=L($),[s,o]=p.useState("dataLoad");return n.jsx(Ze,{opened:e,onClose:()=>t(!1),styles:{header:{...V,...j}},title:a.loadDataLabel,centered:!0,size:"70%",overlayProps:{color:"black",opacity:.8,blur:5},children:n.jsx(c,{sx:{width:"100%"},children:n.jsxs(J,{defaultValue:"gallery",styles:{tabLabel:{...j}},value:s,onTabChange:o,children:[n.jsxs(J.List,{children:[n.jsx(J.Tab,{value:"dataLoad",icon:n.jsx(Ia,{stroke:2,color:j.color}),children:a.loadDataLabel}),n.jsx(J.Tab,{value:"history",icon:n.jsx(ka,{stroke:2,color:j.color}),children:a.historyLabel})]}),n.jsx(J.Panel,{value:"dataLoad",pt:"xs",children:n.jsx(Vn,{})}),n.jsx(J.Panel,{value:"history",pt:"xs",children:n.jsx(qn,{tab:s})})]})})})},Yn=()=>{const[e,t]=p.useState(window.matchMedia(Z).matches);p.useEffect(()=>{const u=window.matchMedia(Z);return u.addEventListener("change",g=>X(t,g.matches)),()=>u.removeEventListener("change",X)},[]);const a=$a("(min-width:800px) and (max-width:1367px)");Ct(),ee();const s=L(N);p.useState(!1);const[o,l]=p.useState(!1),i=L($);if(p.useEffect(()=>{},[s]),i)return n.jsxs(c,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",color:"#003274",justifyContent:"space-between"},children:[n.jsx(me,{to:"/",style:{marginLeft:"1%",color:"#003274",textDecoration:"none",...V,fontSize:a?"1em":"1.5em"},children:i.headerLabelText}),n.jsxs(c,{sx:{display:"flex",marginRight:"1%"},children:[n.jsxs(A,{styles:{root:{background:j.color}},onClick:()=>l(!0),children:[n.jsx(qe,{stroke:2}),n.jsx(c,{sx:{margin:"0 5px"},children:i.doLoadDataLabel})]}),n.jsx(c,{sx:Lt,children:n.jsx("a",{href:`${Ma}`,target:"_blank",children:n.jsx(xe,{label:i.administrationToolTipText,withArrow:!0,styles:Tt,children:n.jsx(c,{sx:ge,children:n.jsx(Pa,{stroke:2,color:j.color,style:ge})})})})}),n.jsx(c,{sx:Lt,children:n.jsx(me,{to:"/about",children:n.jsx(xe,{label:i.aboutToolTipText,withArrow:!0,styles:Tt,children:n.jsx(c,{sx:ge,children:n.jsx(Ra,{stroke:2,color:j.color,style:ge})})})})}),n.jsx(Sn,{})]}),n.jsx(Wn,{isOpen:o,close:l})]})},Lt={margin:"0 10px",display:"flex",alignItems:"center"},Tt={tooltip:{background:"#003274",color:"white",...P}},ge={display:"flex",alignItems:"center","&:hover":{transform:"scale(1.2)"},"&:active":{transform:"scale(0.9)"}},Jn={background:"transparent",height:"100%"},Kn={height:"7%",borderBottom:"1px solid black"},Zn={borderBottom:"1px solid black",boxShadow:"2px 2px 2px gray",paddingLeft:"1%",height:"3%",display:"flex",alignItems:"center",justifyContent:"space-between"},Xn=()=>{const e=L(N),{pathname:t}=_a(),[a,s]=p.useState([]),o=L($);return p.useLayoutEffect(()=>{if(o){const l=[o.mainNavLabel,o.substNavLabel,o.assetNavLabel,o.chartsNavLabel];if(e){const i=[];if(t.length===1)i.push({title:"Главная",href:"/"});else{const g=t.split("/").filter(y=>y!=="");for(let y=0;y<g.length;y++)if(y===0&&i.length===0)i.push({title:"Главная",href:"/"}),y=-1;else if(Number.isInteger(parseInt(g[y])))i[i.length-1].href=`${i[i.length-1].href}/${g[y]}`;else{const b=`/${i[i.length-1].href}/${g[y]}`.split("/").filter(d=>d!=="").join("/");i.push({title:"tmp mock",href:i[i.length-1].href==="/"?`/${g[y]}`:`/${b}`})}}i.forEach((g,y)=>{g.title=g.href==="/about"?o.aboutToolTipText:l[y]});const u=i.map((g,y)=>n.jsx(me,{style:{...V,color:"#003274",textDecoration:"none",marginLeft:y>0?"1%":""},to:g.href,children:n.jsxs(c,{sx:{display:"flex",alignItems:"center","&:hover":{transform:"scale(1.05)",transition:"transform 0.2s ease-in-out"},"&:active":{transform:"scale(0.95)",transition:"transform 0.2s ease-in-out"}},children:[g.title," ",i[y+1]?n.jsx(Ea,{stroke:2}):""]})},F()));s(u)}}},[e,t,o]),n.jsx(n.Fragment,{children:a})},ti=()=>{const e=L($);return n.jsxs(c,{sx:Jn,children:[n.jsx(c,{sx:Kn,children:n.jsx(Yn,{})}),n.jsxs(c,{sx:Zn,children:[n.jsx(c,{sx:{display:"flex",alignItems:"center",width:"80%"},children:n.jsx(Xn,{})}),n.jsx(A,{styles:{root:{maxHeight:"80%",marginRight:"1%",background:j.color}},children:e.albatrosBtnLabel})]}),n.jsx(c,{sx:{height:"calc(90% - 2px)",width:"100%"},children:n.jsx(Oa,{})})]})};export{jr as $,vr as A,yo as B,vo as C,rn as D,wr as E,P as F,$ as G,Rr as H,gs as I,ao as J,Er as K,r as L,mo as M,Cr as N,Nr as O,ie as P,qs as Q,Js as R,fo as S,j as T,Pr as U,_ as V,Fr as W,$r as X,kr as Y,Tr as Z,Ar as _,Lo as a,Ie as a$,Ue as a0,Ur as a1,Br as a2,Gr as a3,Hr as a4,gn as a5,pn as a6,C as a7,mt as a8,De as a9,Gs as aA,Es as aB,an as aC,Po as aD,ko as aE,$o as aF,wo as aG,jo as aH,Io as aI,Do as aJ,Vr as aK,Ro as aL,_o as aM,Ts as aN,Cs as aO,Eo as aP,Zl as aQ,Jl as aR,Kl as aS,Wl as aT,Ql as aU,ql as aV,Go as aW,Bo as aX,ke as aY,Fo as aZ,Ao as a_,Fe as aa,Ae as ab,Ee as ac,Ne as ad,He as ae,Pe as af,Ge as ag,Be as ah,_e as ai,$e as aj,Me as ak,Oe as al,Re as am,ze as an,vs as ao,Zs as ap,Ys as aq,zs as ar,Us as as,Ms as at,nn as au,en as av,Rs as aw,As as ax,$s as ay,Qs as az,cn as b,fr as b$,Co as b0,hl as b1,bl as b2,fl as b3,ml as b4,yl as b5,pl as b6,gl as b7,xl as b8,Sl as b9,cl as bA,dl as bB,vl as bC,Cl as bD,Tl as bE,jl as bF,wl as bG,al as bH,tl as bI,el as bJ,sl as bK,nl as bL,nr as bM,or as bN,lr as bO,sr as bP,ar as bQ,tr as bR,rr as bS,ir as bT,gr as bU,ur as bV,dr as bW,pr as bX,hr as bY,yr as bZ,mr as b_,Al as ba,Ol as bb,El as bc,Fl as bd,Ml as be,$l as bf,kl as bg,Il as bh,Jo as bi,Yo as bj,Wo as bk,Ko as bl,Zo as bm,zl as bn,Hl as bo,Gl as bp,Nl as bq,Ul as br,Uo as bs,No as bt,zo as bu,Vo as bv,Qo as bw,il as bx,rl as by,ll as bz,Ya as c,xr as c0,Sr as c1,go as c2,Wa as c3,so as c4,je as c5,aa as c6,at as c7,Yr as c8,W as c9,Vl as cA,Dl as cB,ol as cC,_l as cD,cr as cE,br as cF,Lr as cG,Zr as cH,So as cI,fe as cJ,we as cK,wn as ca,_n as cb,qr as cc,Qr as cd,Jn as ce,Wr as cf,Xr as cg,ei as ch,Tn as ci,Kr as cj,Rn as ck,ti as cl,oo as cm,Mr as cn,bo as co,Oo as cp,zr as cq,Bl as cr,Ll as cs,Xo as ct,Mo as cu,Ho as cv,er as cw,Yl as cx,ul as cy,qo as cz,is as d,hn as e,X as f,uo as g,bn as h,fn as i,ft as j,Ve as k,io as l,N as m,V as n,co as o,To as p,k as q,ro as r,Z as s,xo as t,Xt as u,be as v,cs as w,lo as x,Dr as y,Ir as z};
