var ia=Object.defineProperty;var ot=e=>{throw TypeError(e)};var ca=(e,t,a)=>t in e?ia(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var lt=(e,t,a)=>ca(e,typeof t!="symbol"?t+"":t,a),rt=(e,t,a)=>t.has(e)||ot("Cannot "+a);var B=(e,t,a)=>(rt(e,t,"read from private field"),a?a.call(e):t.get(e)),se=(e,t,a)=>t.has(e)?ot("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,a);var ne=(e,t,a)=>(rt(e,t,"access private method"),a);import{c as j,a as v,r as p,u as ee,b as L,j as n,B as c,N as he,I as da,n as M,D as be,T as qe,d as Lt,e as ua,P as Te,f as F,g as ga,h as pa,i as We,C as it,k as fe,l as Ve,M as Ye,m as Je,o as ha,L as te,S as Tt,p as re,q as Ct,s as ba,A as ct,t as fa,v as ya,w as ye,x as vt,y as ma,z as xa,E as me,F as dt,G as Ke,H as jt,J as de,K as ut,O as Sa,Q as U,R as La,U as Ta,V as Ca,W as gt,X as va,Y as ja,Z as J,_ as wa,$ as Da,a0 as Ia,a1 as ka,a2 as $a,a3 as Pa,a4 as Ra,a5 as _a}from"./vendor-Dg9ap9Na.js";const Ea="/static/assets/elIcon-ChwglYO6.png",r={idle:"idle",error:"error",loading:"loading",success:"success"},C="",Oa="http://localhost:8085",Aa=`${C}/admin`,Fa=`${C}/ui/settings`,Ma=(e,t,a,s,o,l,i,u,g,m)=>`${C}/asset/${t}/diagmess?lng=${e}&&dateStart=${a}&&dateEnd=${s}&&diagNumStart=${o}&&diagCount=${l}&&diagType=${i}&&search=${u}&&orderField=${g}&&orderType=${m}`,Ba=()=>`${C}/laser/online`,Ga=(e,t)=>`${C}/check-diag-settings?dateStart=${e}&asset=${t}`,Ha=(e,t,a,s)=>`${C}/laser/read-data?dateStart=${e}&dateEnd=${t}&asset=${a}&ip=${s}`,za=()=>`${C}/laser/loadings-info`,Na=e=>`${C}/laser/loaded-data?id=${e}`,Ua=(e,t)=>`${C}/substation/${e}?lng=${t}`,Va={statusLoadingSelectedSubst:r.idle,selectedSubstation:null,psAssets:null},wt=j({name:"selectedSubstationSlice",initialState:Va,reducers:{setSelectedPS:(e,t)=>{try{e.selectedSubstation={subst_id:t.payload.subst_id,name:t.payload.name},e.psAssets=t.payload.assets}catch{e.selectedSubstation=null,e.psAssets=null}},setPSAssets:(e,t)=>{e.selectedSubstation=t.payload},setStatusLoadingSelectedSubts:(e,t)=>{e.statusLoadingSelectedSubst=t.payload}},extraReducers:e=>{e.addCase(Ce.pending,(t,a)=>{t.statusLoadingSelectedSubst=r.loading}).addCase(Ce.rejected,(t,a)=>{t.statusLoadingSelectedSubst=r.error}).addCase(Ce.fulfilled,(t,a)=>{t.psAssets=a.payload.assets,t.selectedSubstation={subst_id:a.payload.id,name:a.payload.name,schema:a.payload.scheme},t.statusLoadingSelectedSubst=r.success})}}),Ce=v("getInfoBySelectedSubstQuery/selectedSubstationSlice",async(e,t)=>{const a=t.getState().currentLocale;return{...await fetch(Ua(e,a.locale.value)).then(o=>o.json())}}),eo=e=>e.selectedSubstation.selectedSubstation,Qa=e=>e.selectedSubstation.psAssets,to=e=>e.selectedSubstation.statusLoadingSelectedSubst,{setSelectedPS:qa,setPSAssets:ao,setStatusLoadingSelectedSubts:Wa}=wt.actions,so=wt.reducer,Z="(min-width:800px) and (max-width:1367px)",X=(e,t)=>e(t),Dt=e=>`${C}/substations?lng=${e}`,Ya=(e,t)=>`${C}/geomap?lng=${e}&hash=${t}`,It=e=>`${C}/org-struct?lng=${e}`,Ja=e=>`${C}/tabs-list?lng=${e}`,Ka=e=>`${C}/diag-messages/last?lng=${e}`;var ie,z,ue,kt,H,Se;const G=class G{static ChartComponentFactory(t,a=null,s){let o=0;const l=.04,i=Object.keys(this.groupBy(t,"measure_unit")),u=[],g={autosize:!1,xaxis:{type:"date",tickformat:"%y-%m-%d %H:%M"},legend:{groupclick:"toggleitem",itemdoubleclick:"toggle"},shapes:B(this,Se).call(this,a)};for(let b=0;b<i.length;b++){let d=!1,f=b===0?"yaxis":`yaxis${b+1}`;t.filter(h=>h.measure_unit===i[b]).forEach(h=>{var E,I;const S=`rgb(${ne(this,z,ue).call(this,100,255)},${ne(this,z,ue).call(this,100,200)},${ne(this,z,ue).call(this,100,200)})`;let x={legendgroup:`${b}`,legendgrouptitle:{text:`${B(this,H).call(this,i[b],20)}`,font:{size:"18"}},y:h.values.length>0?(E=h.values)==null?void 0:E.map(R=>R[1]):[0],x:h.values.length>0?(I=h.values)==null?void 0:I.map(R=>R[0]):[" "],line:ne(this,z,kt).call(this,h.plot_type),name:B(this,H).call(this,h.name).trim(),showlegend:!0,hoverinfo:"all",yaxis:b===0?"y":`y${b+1}`,type:"scatter",visible:h.visible===!1?"legendonly":h.visible,mode:h.mode,hovertemplate:"<i>%{y}</i><br><i>%{x}</i><br>",marker:h.code.includes("_off")?{color:S,symbol:"x",size:12}:{color:S},id:o};if(u.push(x),h.values.length>1&&!h.name.includes("Прогноз")&&!h.name.includes("Forecast")){if(h.dz!==""){let R={customType:B(this,H).call(this,h.name).trim()+"_dz",y:[h.dz,h.dz],x:[h.values[0][0],h.values[h.values.length-1][0]],line:{dash:"dot"},name:`${B(this,H).call(this,h.name)} ${s.lim0Label}`,showlegend:!1,hoverinfo:"all",yaxis:b===0?"y":`y${b+1}`,type:"scatter",visible:!1,mode:"lines+markers",hovertemplate:"<i>%{y}</i><br><i>%{x}</i><br>",marker:{color:S},id:o};u.push(R)}if(h.pdz!==""){let R={customType:B(this,H).call(this,h.name).trim()+"_pdz",y:[h.pdz,h.pdz],x:[h.values[0][0],h.values[h.values.length-1][0]],line:{dash:"dot"},name:`${B(this,H).call(this,h.name)} ${s.lim1Label}`,showlegend:!1,hoverinfo:"all",yaxis:b===0?"y":`y${b+1}`,type:"scatter",visible:!1,mode:"lines+markers",hovertemplate:"<i>%{y}</i><br><i>%{x}</i><br>",marker:{color:S},id:o};u.push(R)}}o++}),g[f]={title:{text:i[b],standoff:0,font:{size:11}},autorange:!0,tickangle:270,tickfont:{size:11},visible:d,automargin:!0,position:l*b},b!==0&&(g[f].overlaying="y")}let m=0;for(const b in g)b.includes("yaxis")&&(g[b].visible?(g[b].position=m===0?0:m*l,m++):g[b].position=1);return g.xaxis.domain=[m*l,1],{layout:g,traces:u}}static ChartComponentFactoryXint(t){const a=[],s={title:null,xaxis:{title:{text:t[0].name_x,font:{size:18,color:"#7f7f7f"}}},yaxis:{title:{text:t[0].name_y,font:{size:18,color:"#7f7f7f"}}}};for(let o=0;o<t.length;o++)a.push({x:t[o].x,y:t[o].y,type:"scatter"});return{layout:s,traces:a}}static GetConfig(){return{responsive:!0,displayModeBar:!1,scrollZoom:!0,scale:1,displaylogo:!1,modeBarButtonsToRemove:["zoom2d","lasso2d","select2d","pan2d","autoScale2d"]}}};ie=new WeakMap,z=new WeakSet,ue=function(t,a){return t=Math.ceil(t),a=Math.floor(a),Math.floor(Math.random()*(a-t+1)+t)},kt=function(t){switch(t){case"stepped":return{shape:"hv"};case"linear":return{shape:"linear"};case"forecast":return{dash:"dash"}}},H=new WeakMap,Se=new WeakMap,se(G,z),se(G,ie,["rgba(0, 157, 25, 0.7)","rgba(0, 74, 157, 0.7)"]),lt(G,"groupBy",function(t,a){return t.reduce((s,o)=>((s[o[a]]=s[o[a]]||[]).push(o),s),{})}),se(G,H,(t,a=35)=>{let s="",o=t.trim().split(" ");for(let l=0;l<o.length;l++)if(s.length===0)s+=o[l]+" ";else{const i=s.split("<br>").length-1;s.length-(s.lastIndexOf("<br>")-i*3)>=a&&(o[l].length===1||o[l].length===2||(s+="<br>")),s+=o[l]+" "}return s}),se(G,Se,t=>{if(t==null)return null;{const a=[];return t.forEach(s=>{const o=s.values.map((l,i)=>({name:s.name,showlegend:i==0,legendgroup:s.measure_unit,legendgrouptitle:{text:s.measure_unit,font:{size:"18"}},visible:"legendonly",group:s.code.includes("110")?"1.1":"1.25",type:"line",x0:l[0],y0:l[1],x1:l[0],y1:l[2],yref:"paper",line:{color:s.code.includes("110")?B(G,ie)[0]:B(G,ie)[1],width:3,dash:"dot"}}));a.push(...o)}),a}});let k=G;const Za={statusLoading:r.idle,allDiagMsg:null,companyStruct:null,mapStatistic:null,substationsInfo:null,tabsList:null},$t=j({name:"substationsSlice",initialState:Za,reducers:{setStatusLoading:(e,t)=>{e.statusLoading=t.payload},addAssetsToTheSubstGeoJson:(e,t)=>{t.payload&&t.payload.forEach(a=>{var o;let s=(o=e.substGeoJson)==null?void 0:o.features.find(l=>l.properties.subst_id==a.id);s&&(s.properties={...s==null?void 0:s.properties,...a})})},setCompanyStruct:(e,t)=>{e.companyStruct=t.payload}},extraReducers:e=>{e.addCase(ge.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(ge.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(ge.fulfilled,(t,a)=>{t.statusLoading=r.success,t.substationsInfo=a.payload.substations,t.mapStatistic=k.groupBy(a.payload.substations.map(s=>s.assets).flat(),"asset_type_name"),t.allDiagMsg=a.payload.diag_msg.map(s=>{var o;return{...s,substId:((o=a.payload.substations.find(l=>l.name===s.substation))==null?void 0:o.id)??""}}),t.companyStruct=a.payload.company_struct,t.tabsList=a.payload.asset_type_tabs})}}),ge=v("getSubstationsQuery/substationsSlice",async(e,t)=>{const a=t.getState().currentLocale,s=await fetch(Dt(a.locale.value)).then(u=>u.json()),o=await fetch(It(a.locale.value)).then(u=>u.json()),l=await fetch(Ka(a.locale.value)).then(u=>u.json()),i=await fetch(Ja(a.locale.value)).then(u=>u.json());return{...s,...o,...l,...i}});v("getOnlySubstationsQuery/substationsSlice",async(e,t)=>{const a=t.getState().currentLocale;return{...await fetch(Dt(a.locale.value)).then(o=>o.json())}});const Xa=v("companyStruct/substationsSlice",async(e,t)=>{const a=t.getState().currentLocale;await fetch(It(a.locale.value)).then(s=>s.json()).then(s=>{t.dispatch(as(s.company_struct))})}),no=v("getMapComponentsQuery/substationsSlice",async(e,t)=>{const a=t.getState().currentLocale;return{...await fetch(Ya(a.locale.value,e.hash)).then(o=>o.json())}}),oo=e=>e.substations.statusLoading,lo=e=>e.substations.allDiagMsg,es=e=>e.substations.guideDiagMessages,ts=e=>e.substations.companyStruct,ro=e=>e.substations.mapStatistic,io=e=>e.substations.substationsInfo,co=e=>e.substations.tabsList,{setStatusLoading:uo,setCompanyStruct:as,addAssetsToTheSubstGeoJson:go}=$t.actions,po=$t.reducer,ho=p.memo(()=>{const[e,t]=p.useState(window.matchMedia(Z).matches);p.useEffect(()=>{const l=window.matchMedia(Z);return l.addEventListener("change",i=>X(t,i.matches)),()=>l.removeEventListener("change",X)},[]);const a=ee(),s=L(ts);p.useLayoutEffect(()=>{s===null&&a(Xa())},[]);const o=p.useMemo(()=>{function l(i){const u=[],g=i.filter(b=>b.parentId==null||b.parentId=="");for(let b=0;b<g.length;b++){let d=m([g[b]]);u.push(d)}function m(b){let d=[];for(const f of b)if(f.typePoint==="node")d.push(n.jsxs("details",{open:!0,style:{marginLeft:"10px",color:"white",fontSize:e?"0.8em":"1em"},children:[n.jsx("summary",{children:f.name}),m(i.filter(y=>y.parentId==f.id))]},f.id));else return b.filter(y=>y.parentId===f.parentId).map(y=>n.jsx(he,{to:`/substation/${y.sustId}`,style:{marginLeft:"10px",marginTop:"5px",width:"80%",color:"white",textDecoration:"none",display:"block"},children:n.jsxs(c,{sx:{display:"flex",alignItems:"center","&:hover":{transform:"scale(1.05)"}},children:[n.jsx(da,{src:Ea,width:15,height:15}),n.jsx(c,{children:y.name})]})},y.id));return d}return u}if(s!==null)return l(s)},[s]);return n.jsx(c,{sx:{background:"#003274",width:"100%",height:"100%",overflowY:"auto"},children:o})}),V={fontFamily:"Roboto-Bold"},P={fontFamily:"Roboto-Regular"},w={color:"#003274"},bo={borderColor:"1px solid rgba(201, 201, 201, 0.8)"},fo=e=>({zIndex:1,height:e?"20px":"",margin:"0 1%",background:"#003274",border:"1px solid #003274","&:hover":{background:"#003274"}}),ss={locale:"",allLocales:null,translation:null,lastValuesRefreshIntervalPerSec:300},Pt=j({name:"localeSlice",initialState:ss,reducers:{setLocale:(e,t)=>{e.locale=t.payload}},extraReducers:e=>{e.addCase(pe.pending,(t,a)=>{t.statusLoadingLocale=r.loading}).addCase(pe.rejected,(t,a)=>{t.statusLoadingLocale=r.error}).addCase(pe.fulfilled,(t,a)=>{t.statusLoadingLocale=r.success;const s=a.payload._allLangs.map(o=>{const l=Object.entries(o);return{value:l[0][0],label:l[0][1]}});t.allLocales=s,t.translation=a.payload._translation,t.locale=s.find(o=>o.value===a.payload._currentLang)}).addCase(ve.pending,(t,a)=>{t.statusLoadingSettings=r.loading}).addCase(ve.rejected,(t,a)=>{t.statusLoadingSettings=r.error,console.error(`Fetch (getAppSettings) error: ${a.payload}`),console.error("Default values applied")}).addCase(ve.fulfilled,(t,a)=>{t.statusLoadingSettings=r.success,t.lastValuesRefreshIntervalPerSec=a.payload.latest_values_refresh_interval})}}),pe=v("localeSlice/GetLocalesInfo",async(e,t)=>{try{const a=await fetch(`${C}/langs`).then(u=>u.json());let s=localStorage.getItem("locale");s==null?s={value:"en",label:"English"}:s=JSON.parse(s);const o=a.langs.map(u=>Object.entries(u)[0][0]);if(!o.includes(s.value)){const u=a.langs.filter(g=>Object.entries(g)[0][0]===o[0]);s={value:o[0],label:u[0][o[0]]}}localStorage.setItem("locale",JSON.stringify(s));const l=await fetch(`${C}/translation/${s.value}`).then(u=>u.json());return{_allLangs:a.langs,_translation:l.translation,_currentLang:l.lang}}catch(a){return console.log(a),t.rejectWithValue("Не удалось получить локализацию от сервера")}}),ve=v("localeSlice/getAppSettings",async(e,{rejectWithValue:t})=>await fetch(Fa).then(s=>s.ok?s.json():t(s.status)).catch(s=>t(524))),N=e=>e.currentLocale.locale,ns=e=>e.currentLocale.allLocales,$=e=>e.currentLocale.translation,yo=e=>e.currentLocale.lastValuesRefreshIntervalPerSec,{setLocale:os}=Pt.actions,mo=Pt.reducer,ls="/static/assets/danger-rFNOzrUc.png",rs="/static/assets/warning-D84hLsZW.png",is="/static/assets/good-DhgS4zZR.png",cs="/static/assets/empty-CgdktBB_.png",xo={undefinedTitle:"Undefined",goodTitle:"Good",warningTitle:"Warning",dangerousTitle:"Dangerous"},So={undefinedColor:"rgba(127, 127, 127, 0.9)",goodColor:"rgba(43, 200, 88, 0.8)",warningColor:"rgba(253, 174, 73, 0.9)",dangerousColor:"rgba(229, 106, 91, 0.9)"},ds=[{title:"Is not designed",icon:"",inerp:"Не расчитано",color:"rgba(39, 144, 245, 0.8)",levelState:0},{title:"Undefined",icon:cs,inerp:"Нет данных",color:"gray",levelState:1},{title:"Dangerous",icon:ls,inerp:"Опасно",levelState:2,color:"rgb(229, 106, 91)"},{title:"Warning",icon:rs,inerp:"Внимание",color:"#fec600",levelState:3},{title:"Good",icon:is,inerp:"Нормально",color:"rgba(43, 200, 88, 0.8)",levelState:4}],_=[{title:"нет данных",color:"gray",levelState:null},{title:"нормально",color:"rgba(43, 200, 88, 0.8)",levelState:0},{title:"внимание",color:"#fec600",levelState:1},{title:"опасность",color:"rgb(229, 106, 91)",levelState:2}],Lo=[{title:"Undefined",color:"gray"},{title:"Good",color:"transparent"},{title:"Warning",color:"#ffa500"},{title:"Dangerous",color:"#cf6868"}],To=[{impotantLevel:"91 - 100%",name:"Dark green",color:"rgba(1, 50, 32, 0.8)"},{impotantLevel:"81 - 90%",name:"Green",color:"rgba(0, 128, 0, 0.8)"},{impotantLevel:"71 - 80%",name:"Light green",color:"rgba(144, 238, 144, 0.8)"},{impotantLevel:"61 - 70%",name:"Light yellow",color:"rgba(255, 255, 0, 0.8)"},{impotantLevel:"51 - 60%",name:"Yellow",color:"rgba(255, 187, 15, 0.8)"},{impotantLevel:"41 - 50%",name:"Orange",color:"rgba(255, 165, 0, 0.8)"},{impotantLevel:"31 - 40%",name:"Light orange",color:"rgba(255, 104, 0, 0.8)"},{impotantLevel:"21 - 30%",name:"Light cherry",color:"rgba(222, 49, 99, 0.8)"},{impotantLevel:"11 - 20%",name:"Crimson",color:"rgba(255, 36, 0, 0.8)"},{impotantLevel:"1 - 10%",name:"Maroon",color:"rgba(155, 45, 48, 0.8)"}],us=(e,t)=>`${C}/asset/${t}/meterings/last?lng=${e}&`,gs=()=>`${C}/blocks/info`,ps=(e,t)=>`${C}/asset/${t}/passport/export/create?lng=${e}`,hs=(e,t)=>`${C}/asset/${t}/diag_settings/export/create?lng=${e}`,bs=(e,t,a,s,o,l,i)=>`${C}/asset/${t}/diagmsg/export/create?lng=${e}&dateStart=${a}&dateEnd=${s}&diagType=${o}&search=${l}&format=${i}`,fs=(e,t)=>`${C}/export/file?lng=${e}&name=${t}`,ys=(e,t)=>`${C}/asset/${t}/3dforecast?lng=${e}`,ms={statusLoading:r.idle,gasesTrace:null,gasesLayout:null,gasesTracePercent:null,gasesLayoutPercent:null,currentGasesUnit:"ppm",volumeForecast:null},Rt=j({name:"subTabChartsOfGasesSlice",initialState:ms,reducers:{setGasesTrace:(e,t)=>{e.gasesTrace=t.payload},setGasesLayout:(e,t)=>{e.gasesLayout=t.payload},setGasesTracePercent:(e,t)=>{t.payload.forEach(s=>{if(s.mode!="none"){const o=e.gasesTrace.filter(l=>l.id===s.id)[0];s.marker=o.marker}}),e.gasesTracePercent=t.payload},setGasesLayoutPercent:(e,t)=>{e.gasesLayoutPercent=t.payload},setCurrentGasesUnit:(e,t)=>{e.currentGasesUnit=t.payload},setGasesChartsStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(je.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(je.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(je.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.gasesLayout=s.layout,t.gasesTrace=s.traces,t.volumeForecast=a.payload.forecast})}}),xs=async(e,t)=>{if(console.log("CONVER DATA called"),e.values.length===0)return;const a=new Worker(new URL("/static/assets/worker-CEwgvsRg.js",import.meta.url));a.onmessage=function(s){const o=k.ChartComponentFactory(s.data.values,null,e.translation);t.dispatch(Ss(o.traces)),t.dispatch(Ls(o.layout)),a.terminate()},a.onerror=function(s){console.error("WOKER ERROR"),console.error(s),a.terminate()},a.postMessage(e)},je=v("subChartsTabGasesSlice/SubTabChartsOfGasesQuery",async(e,t)=>{try{const a=await fetch(e.url).then(l=>l.json()),s=await t.getState(),o=await fetch(ys(s.currentLocale.locale.value,s.selectedEquipment.equpment.elementId)).then(l=>l.json());return xs({values:a.params,translation:e.translations},t),{params:a.params,forecast:o.params,translate:e.translations}}catch(a){console.log(a)}}),Co=e=>e.subChartsTabGases.gasesTrace,vo=e=>e.subChartsTabGases.gasesLayout,jo=e=>e.subChartsTabGases.gasesTracePercent,wo=e=>e.subChartsTabGases.gasesLayoutPercent,Do=e=>e.subChartsTabGases.statusLoading,Io=e=>e.subChartsTabGases.currentGasesUnit,{setGasesTrace:ko,setGasesLayout:$o,setGasesTracePercent:Ss,setGasesLayoutPercent:Ls,setCurrentGasesUnit:Po,setGasesChartsStatusLoading:Ts}=Rt.actions,Ro=Rt.reducer,Cs={statusLoading:r.idle,sourceData:null},_t=j({name:"subTabRDTableSlice",initialState:Cs,reducers:{setRDTableStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(we.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(we.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(we.fulfilled,(t,a)=>{t.statusLoading=r.success,t.sourceData=a.payload.values})}}),we=v("subTabRDTableSlice/SubTabRDTableQuery",async(e,t)=>await fetch(e.url).then(s=>s.json())),_o=e=>e.subTabRD.sourceData,Eo=e=>e.subTabRD.statusLoading,{setRDTableStatusLoading:vs}=_t.actions,Oo=_t.reducer,js={statusLoading:r.idle,data:null},Et=j({name:"subTabChartsRDNomogramSlice",initialState:js,reducers:{setRDNomogrammStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(De.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(De.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(De.fulfilled,(t,a)=>{t.statusLoading=r.success,t.data=a.payload.values})}}),De=v("subTabChartsRDNomogramSlice/SubTabChartsRDNomogramQuery",async(e,t)=>await fetch(e.url).then(s=>s.json())),Ao=e=>e.subTabRDNomogram.data,Fo=e=>e.subTabRDNomogram.statusLoading,{setRDNomogrammStatusLoading:ws}=Et.actions,Mo=Et.reducer,Ds={statusLoading:r.idle,wearTrace:null,wearLayout:null},Ot=j({name:"tabWearSlice",initialState:Ds,reducers:{setWearTrace:(e,t)=>{e.wearTrace=t.payload},setWearLayout:(e,t)=>{e.wearLayout=t.payload},setWearStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Ie.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Ie.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Ie.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.wearLayout=s.layout,t.wearTrace=s.traces})}}),Ie=v("tabWearSlice/TabChartsOfWearQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),Bo=e=>e.tabWear.wearTrace,Go=e=>e.tabWear.wearLayout,Ho=e=>e.tabWear.statusLoading,{setWearTrace:zo,setWearLayout:No,setWearStatusLoading:Is}=Ot.actions,Uo=Ot.reducer,ks={statusLoading:r.idle,temperatureTrace:null,temperatureLayout:null},At=j({name:"tabTemperatureSlice",initialState:ks,reducers:{setTemperatureTrace:(e,t)=>{e.temperatureTrace=t.payload},setTemperatureLayout:(e,t)=>{e.temperatureLayout=t.payload},setTemperatureStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(ke.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(ke.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(ke.fulfilled,(t,a)=>{t.statusLoading=r.success,console.log(a.payload);const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.temperatureLayout=s.layout,t.temperatureTrace=s.traces})}}),ke=v("tabTemperatureSlice/TabChartsOfTemperatureQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),Vo=e=>e.tabTemperature.temperatureTrace,Qo=e=>e.tabTemperature.temperatureLayout,qo=e=>e.tabTemperature.statusLoading,{setTemperatureTrace:Wo,setTemperatureLayout:Yo,setTemperatureStatusLoading:$s}=At.actions,Jo=At.reducer,Ps={statusLoading:r.idle,sf6Trace:null,sf6Layout:null},Ft=j({name:"tabSF6Slice",initialState:Ps,reducers:{setSF6Trace:(e,t)=>{e.sf6Trace=t.payload},setSF6Layout:(e,t)=>{e.sf6Layout=t.payload},setSF6StatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase($e.pending,(t,a)=>{t.statusLoading=r.loading}).addCase($e.rejected,(t,a)=>{t.statusLoading=r.error}).addCase($e.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.sf6Layout=s.layout,t.sf6Trace=s.traces})}}),$e=v("tabSF6Slice/TabChartsOfSF6Query",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),Ko=e=>e.tabSF6.sf6Trace,Zo=e=>e.tabSF6.sf6Layout,Xo=e=>e.tabSF6.statusLoading,{setSF6Trace:el,setSF6Layout:tl,setSF6StatusLoading:Rs}=Ft.actions,al=Ft.reducer,_s={statusLoading:r.idle,bushingTrace:null,bushingLayout:null},Mt=j({name:"tabBushingSlice",initialState:_s,reducers:{setBushingTrace:(e,t)=>{e.bushingTrace=t.payload},setBushingLayout:(e,t)=>{e.bushingLayout=t.payload},setBushingStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Pe.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Pe.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Pe.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.bushingLayout=s.layout,t.bushingTrace=s.traces})}}),Pe=v("tabBushingSlice/TabChartsOfBushingQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),sl=e=>e.tabBushing.bushingTrace,nl=e=>e.tabBushing.bushingLayout,ol=e=>e.tabBushing.statusLoading,{setBushingTrace:ll,setBushingLayout:rl,setBushingStatusLoading:Es}=Mt.actions,il=Mt.reducer,Os={statusLoading:r.idle,overvoltageTrace:null,overvoltageLayout:null,tableValues:null,tableData11:null,tableData125:null,tableDataPause:null},Bt=j({name:"tabOvervoltageSlice",initialState:Os,reducers:{setOvervoltageTrace:(e,t)=>{e.overvoltageTrace=t.payload},setOvervoltageLayout:(e,t)=>{e.overvoltageLayout=t.payload},setOvervoltageStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Re.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Re.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Re.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,a.payload.v_lines,a.payload.translate);t.overvoltageLayout=s.layout,t.overvoltageTrace=s.traces,t.tableValues=a.payload.table,t.tableData11=a.payload.table_11,t.tableData125=a.payload.table_125,t.tableDataPause=a.payload.table_pause})}}),Re=v("tabOvervoltageSlice/TabChartsOfOvervoltageQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),cl=e=>e.tabOvervoltage.overvoltageTrace,dl=e=>e.tabOvervoltage.overvoltageLayout,ul=e=>e.tabOvervoltage.statusLoading,gl=e=>e.tabOvervoltage.tableValues,pl=e=>e.tabOvervoltage.tableData11,hl=e=>e.tabOvervoltage.tableData125,bl=e=>e.tabOvervoltage.tableDataPause,{setOvervoltageTrace:fl,setOvervoltageLayout:yl,setOvervoltageStatusLoading:As}=Bt.actions,ml=Bt.reducer,Fs={statusLoading:r.idle,pdTrace:null,pdLayout:null},Gt=j({name:"tabPartialDischargeSlice",initialState:Fs,reducers:{setPDTrace:(e,t)=>{e.pdTrace=t.payload},setPDLayout:(e,t)=>{e.pdLayout=t.payload},setPDStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(_e.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(_e.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(_e.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.pdLayout=s.layout,t.pdTrace=s.traces})}}),_e=v("tabPartialDischargeSlice/TabChartsOfPDQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),xl=e=>e.tabPD.pdTrace,Sl=e=>e.tabPD.pdLayout,Ll=e=>e.tabPD.statusLoading,{setPDTrace:Tl,setPDLayout:Cl,setPDStatusLoading:Ms}=Gt.actions,vl=Gt.reducer,Bs={statusLoading:r.idle,hysteresisTrace:null,hysteresisLayout:null},Ht=j({name:"subTabHysteresisSlice",initialState:Bs,reducers:{setHysteresisTrace:(e,t)=>{e.hysteresisTrace=t.payload},setHysteresisLayout:(e,t)=>{e.hysteresisLayout=t.payload},setHysteresisStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Ee.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Ee.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Ee.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactoryXint(a.payload.params,null,a.payload.translate);t.hysteresisLayout=s.layout,t.hysteresisTrace=s.traces})}}),Ee=v("subTabHysteresisSlice/SubTabChartsOfHysteresisQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),jl=e=>e.tabHysteresus.hysteresisTrace,wl=e=>e.tabHysteresus.hysteresisLayout,Dl=e=>e.tabHysteresus.statusLoading,{setHysteresisTrace:Il,setHysteresisLayout:kl,setHysteresisStatusLoading:Gs}=Ht.actions,$l=Ht.reducer,Hs={statusLoading:r.idle,moistureTrace:null,moistureLayout:null},zt=j({name:"tabMoistureSlice",initialState:Hs,reducers:{setMoistureTrace:(e,t)=>{e.moistureTrace=t.payload},setMoistureLayout:(e,t)=>{e.moistureLayout=t.payload},setMoistureStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Oe.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Oe.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Oe.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.moistureLayout=s.layout,t.moistureTrace=s.traces})}}),Oe=v("tabMoistureSlice/TabChartsOfMoistureQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),Pl=e=>e.tabMoisture.moistureTrace,Rl=e=>e.tabMoisture.moistureLayout,_l=e=>e.tabMoisture.statusLoading,{setMoistureTrace:El,setMoistureLayout:Ol,setMoistureStatusLoading:zs}=zt.actions,Al=zt.reducer,Ns={statusLoading:r.idle,itcTrace:null,itcLayout:null},Nt=j({name:"tabItcSlice",initialState:Ns,reducers:{setItcTrace:(e,t)=>{e.itcTrace=t.payload},setItcLayout:(e,t)=>{e.itcLayout=t.payload},setItcStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Ae.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Ae.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Ae.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.itcLayout=s.layout,t.itcTrace=s.traces})}}),Ae=v("tabItcSlice/TabChartsOfItcQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),Fl=e=>e.tabItc.itcTrace,Ml=e=>e.tabItc.itcLayout,Bl=e=>e.tabItc.statusLoading,{setItcTrace:Gl,setItcLayout:Hl,setItcStatusLoading:Us}=Nt.actions,zl=Nt.reducer,oe="black",Vs={title:"",showlegend:!1,xaxis:{showgrid:!1,showline:!1,showticklabels:!1,zeroline:!1},yaxis:{showgrid:!1,showline:!1,showticklabels:!1,zeroline:!1},margin:{l:0,r:0,b:0,t:0}},Qs={statusLoading:r.idle,pentagonTrace:null,pentagonLayout:Vs},Ut=j({name:"subTabChartsDuvalPentagon",initialState:Qs,reducers:{setDuvalePentagonStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Fe.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Fe.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Fe.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=a.payload.pentagon,o={x:s.x,y:s.y,showlegend:!1,mode:"markers",marker:{color:s.dates.map((u,g)=>g),size:14,line:{width:1,color:"black"}},text:s.dates.map((u,g)=>`H2: ${s.h2[g]}<br>CH4: ${s.ch4[g]}<br>C2H6: ${s.c2h6[g]}<br>C2H4: ${s.c2h4[g]}<br>C2H2: ${s.c2h2[g]} <br>${u.replace("T"," ")}`),hoverinfo:"text"},l=a.payload.translations;let i=[{x:[-35,0,0,-1,-1,0,0,-38,-35],y:[3,1.5,24.5,24.5,33,33,40,12.4,3],fill:"toself",fillcolor:"#90af9d",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:l.mineralOilGassingLabel,hoverinfo:"text"},{x:[-22.5,-6,-1,0,-35,-23.5,-22.5],y:[-32.4,-4,-2,1.5,3,-32.4,-32.4],fill:"toself",fillcolor:"#f4ecea",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:l.thermalDefectInLowTemperatureRangeLabel,hoverinfo:"text"},{x:[0,38,32,4,0,0],y:[40,12,-6,16,1.5,40],fill:"toself",fillcolor:"#005686",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:l.lowEnergySparkDischargeLabel,hoverinfo:"text"},{x:[0,0,-1,-1,0],y:[24.5,33,33,24.5,24.5],fill:"toself",fillcolor:"#9b8fa4",hoveron:"points+fills",mode:"lines",line:{color:"black",width:1},text:l.pdLabel,hoverinfo:"text"},{x:[1,-6,-22.5,1],y:[-32.4,-4,-32.4,-32.4],fill:"toself",fillcolor:"#f0cac1",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:l.thermalDefectInMiddleTemperatureRangeLabel,hoverinfo:"text"},{x:[24,-1,-6,1,23.5,24],y:[-30,-2,-4,-32.4,-32.4,-30],fill:"toself",fillcolor:"#c89c82",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:l.thermalDefectInHighTemperatureRangeLabel,hoverinfo:"text"},{x:[4,32,24,-1,4],y:[16,-6,-30,-2,16],fill:"toself",fillcolor:"#7fc7e2",hoveron:"points+fills",mode:"lines",line:{color:"black",width:2},text:l.highEnergySparkDischargeLabel,hoverinfo:"text"},{x:["0","41"],y:["0","13"],showlegend:!1,mode:"lines+text",marker:{color:oe},text:["","40% C2H2"],textposition:"top",hoverinfo:"text"},{x:["0","0"],y:["0","41"],showlegend:!1,mode:"lines+text",marker:{color:oe},text:["","40% H2"],textposition:"top",hoverinfo:"text"},{x:["0","-41"],y:["0","13.5"],showlegend:!1,mode:"lines+text",marker:{color:oe},text:["","40% C2H6"],textposition:"top",hoverinfo:"text"},{x:["0","-25.5"],y:["0","-35"],showlegend:!1,mode:"lines+text",marker:{color:oe},text:["","40% CH4"],textposition:"bottom",hoverinfo:"text"},{x:["0","25.5"],y:["0","-35"],showlegend:!1,mode:"lines+text",marker:{color:oe},text:["","40% C2H4"],textposition:"bottom",hoverinfo:"text"}];i.push(o),t.pentagonTrace=i})}}),Fe=v("subTabChartsDuvalPentagon/SubTabChartsDuvalPentagonQuery",async(e,t)=>({pentagon:(await fetch(e.url).then(s=>s.json())).pentagon,translations:e.translations})),Nl=e=>e.subTabDuvalePentagon.pentagonTrace,Ul=e=>e.subTabDuvalePentagon.pentagonLayout,Vl=e=>e.subTabDuvalePentagon.statusLoading,{setDuvalePentagonStatusLoading:qs}=Ut.actions,Ql=Ut.reducer,Ws={ternary:{sum:100,aaxis:{title:"",titlefont:{size:12},tickangle:0,tickfont:{size:10},tickcolor:"black",ticklen:10,showline:!0,showgrid:!0},baxis:{title:"",titlefont:{size:12},tickangle:0,tickfont:{size:10},tickcolor:"black",ticklen:10,showline:!0,showgrid:!0},caxis:{title:"",titlefont:{size:12},tickangle:0,tickfont:{size:10},tickcolor:"black",ticklen:10,showline:!0,showgrid:!0}},paper_bgcolor:"white",title:{text:""},legend:{visible:!1},autosize:!1,showlegend:!1,margin:{l:25,r:0,b:35,t:80},annotations:[{x:.35,y:.5,text:"CH4",showarrow:!1},{x:.5,y:-.05,text:"C2H2",showarrow:!1},{x:.65,y:.5,text:"C2H4",showarrow:!1}]},Ys={statusLoading:r.idle,triangleTrace:null,triangleLayout:Ws},Vt=j({name:"subTabChartsDuvalTriangleSlice",initialState:Ys,reducers:{setDuvaleTriangleStatusLoading:(e,t)=>{e.statusLoading=t.payload},addTrace:(e,t)=>{const a=structuredClone(e.triangleTrace);e.triangleTrace=a!=null?[...a,...t.payload]:[...t.payload]}},extraReducers:e=>{e.addCase(Me.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Me.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Me.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=a.payload.triangle,o={name:"",showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"markers",line:{color:"black"},a:s.CH4,b:s.C2H2,c:s.C2H4,marker:{color:s.dates.map((u,g)=>g),size:14,line:{width:1,color:"black"}},text:s.dates.map(u=>u.replace("T"," ")),hovertemplate:"<i>C2H4: %{c} </i><br><i>CH4: %{a} </i><br><i>C2H2: %{b} </i><br><i>%{text}</i>"};let l=a.payload.translations,i=[{name:l.lowEnergySparkDischargeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[.01,13,13,77],c:[0,0,23,23],a:[0,87,64,0],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#005686"},{name:l.highEnergySparkDischargeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[77,13,13,29,29],c:[23,23,40,40,71],a:[0,64,47,31,0],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#7fc7e2"},{name:l.compositionOfElectricalAndThermalDefectsLabel,hoverinfo:"text",showlegend:!1,type:"scatterternary",mode:"lines",line:{color:"black"},b:[29,29,13,13,4,4,15,15],c:[71,40,40,0,0,50,50,85],a:[0,31,47,87,96,46,35,0],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#dccfe2"},{name:l.thermalDefectInHighTemperatureRangeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[15,15,0,0],c:[85,50,50,100],a:[0,35,50,0],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#c89c82"},{name:l.thermalDefectInMiddleTemperatureRangeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[4,0,0,4],c:[50,50,20,20],a:[46,50,80,76],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#f0cac1"},{name:l.thermalDefectInLowTemperatureRangeLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[4,0,0,2,4],c:[20,20,2,0,0],a:[76,80,98,98,96],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#f4ecea"},{name:l.pdLabel,showlegend:!1,hoverinfo:"text",type:"scatterternary",mode:"lines",line:{color:"black"},b:[2,0,0],c:[0,2,0],a:[98,98,100],marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}},fill:"toself",fillcolor:"#9b8fa4"}];i.push(o),t.triangleTrace=i})}}),Me=v("subTabChartsDuvalTriangleSlice/SubTabChartsDuvalTriangleQuery",async(e,t)=>({triangle:(await fetch(e.url).then(s=>s.json())).triangle,translations:e.translations})),ql=e=>e.subTabDuvaleTriangle.triangleTrace,Wl=e=>e.subTabDuvaleTriangle.triangleLayout,Yl=e=>e.subTabDuvaleTriangle.statusLoading,{setDuvaleTriangleStatusLoading:Js,addTrace:Jl}=Vt.actions,Kl=Vt.reducer,Ks={statusLoading:r.idle,loadCapacityTrace:null,loadCapacityLayout:null,coeffTable:null,msg:null,loadTable:null},Qt=j({name:"tabLoadCapacitySlice",initialState:Ks,reducers:{setLoadCapacityTrace:(e,t)=>{e.loadCapacityTrace=t.payload},setLoadCapacityLayout:(e,t)=>{e.loadCapacityLayout=t.payload},setLoadCapacityStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Be.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Be.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Be.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.loadCapacityLayout=s.layout,t.loadCapacityTrace=s.traces,t.coeffTable=a.payload.coeff_table,t.msg=a.payload.message,t.loadTable=a.payload.load_table})}}),Be=v("tabLoadCapacitySlice/TabChartsOfLoadCapacityQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),Zl=e=>e.tabLoadCapacity.loadCapacityTrace,Xl=e=>e.tabLoadCapacity.loadCapacityLayout,er=e=>e.tabLoadCapacity.statusLoading,tr=e=>e.tabLoadCapacity.coeffTable,ar=e=>e.tabLoadCapacity.msg,sr=e=>e.tabLoadCapacity.loadTable,{setLoadCapacityTrace:nr,setLoadCapacityLayout:or,setLoadCapacityStatusLoading:Zs}=Qt.actions,lr=Qt.reducer,Xs={statusLoading:r.idle,LTCTrace:null,LTCLayout:null},qt=j({name:"tabLTCSlice",initialState:Xs,reducers:{setLTCTrace:(e,t)=>{e.LTCTrace=t.payload},setLTCLayout:(e,t)=>{e.LTCLayout=t.payload},setLTCStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(Ge.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(Ge.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(Ge.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,null,a.payload.translate);t.LTCLayout=s.layout,t.LTCTrace=s.traces})}}),Ge=v("tabLTCSlice/TabChartsOfLTCQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),rr=e=>e.tabLTC.LTCTrace,ir=e=>e.tabLTC.LTCLayout,cr=e=>e.tabLTC.statusLoading,{setLTCTrace:dr,setLTCLayout:ur,setLTCStatusLoading:en}=qt.actions,gr=qt.reducer,tn={statusLoading:r.idle,powerTrace:null,powerLayout:null},Wt=j({name:"tabPowerSlice",initialState:tn,reducers:{setPowerTrace:(e,t)=>{e.powerTrace=t.payload},setPowerLayout:(e,t)=>{e.powerLayout=t.payload},setPowerStatusLoading:(e,t)=>{e.statusLoading=t.payload}},extraReducers:e=>{e.addCase(He.pending,(t,a)=>{t.statusLoading=r.loading}).addCase(He.rejected,(t,a)=>{t.statusLoading=r.error}).addCase(He.fulfilled,(t,a)=>{t.statusLoading=r.success;const s=k.ChartComponentFactory(a.payload.params,a.payload.v_lines,a.payload.translate);t.powerLayout=s.layout,t.powerTrace=s.traces})}}),He=v("tabPowerSlice/TabChartsOfPowerQuery",async(e,t)=>({...await fetch(e.url).then(s=>s.json()),translate:e.translations})),pr=e=>e.tabPower.powerTrace,hr=e=>e.tabPower.powerLayout,br=e=>e.tabPower.statusLoading,{setPowerTrace:fr,setPowerLayout:yr,setPowerStatusLoading:an}=Wt.actions,mr=Wt.reducer;class sn{async exportToFile(t,a){try{console.log(t),await fetch(t).then(s=>s.json()).then(s=>{const o=document.createElement("a");o.href=fs(a,s.file_name),o.download=`${s.file_name}`,o.click(),o.remove()})}catch(s){console.log(s)}}}Date.prototype.addHours=function(e){return this.setTime(this.getTime()+e*60*60*1e3),this};const Qe=(e,t)=>`${new Date(e).addHours(t).toISOString()}`.split(".")[0],pt=e=>{let t=new Date(e).toLocaleString().split(","),a=t[0].split(".");return`${a[2]}-${a[1]}-${a[0]}T${t[1].trim()}`},nn={gasesMeasureUnit:{gasesUnit:"(ppm)",rocGasesUnit:"(ppm/сут.)"},alternativeMeasureUnits:!1,statusLoadingLastValues:r.idle,lastValues:null,equpment:null,currentAgeing:null,ageinPerDay:null,image:null,pData:null,modelSettings:null,tciLast:null,outter:null,inner:null,data:null},Yt=j({name:"selectedEquipment",initialState:nn,reducers:{setAlternativeMeasureUnit:(e,t)=>{e.alternativeMeasureUnits=t.payload},setGasesMeasureUnit:(e,t)=>{e.gasesMeasureUnit=t.payload},setSelectedEquipment:(e,t)=>{var a,s,o;e.statusLoadingLastValues=(a=e.equpment)!=null&&a.elementId&&((s=e.equpment)==null?void 0:s.elementId)!==((o=t.payload)==null?void 0:o.elementId)?r.idle:e.statusLoadingLastValues,e.equpment=t.payload},setStatusLoadingLastValues:(e,t)=>{e.statusLoadingLastValues=t.payload},setLastValues:(e,t)=>{e.lastValues=t.payload},setOutter:(e,t)=>{e.outter=t.payload.map(a=>({i:a.i,x:a.x,y:a.y,w:a.w,h:a.h}))},setInner:(e,t)=>{const a=t.payload.map(s=>s.i);e.inner=[...e.inner.filter(s=>!a.includes(s.i)),...t.payload]}},extraReducers:e=>{e.addCase(ze.pending,(t,a)=>{t.statusLoadingLastValues=r.loading}).addCase(ze.rejected,(t,a)=>{t.statusLoadingLastValues=r.error}).addCase(ze.fulfilled,(t,a)=>{t.statusLoadingLastValues=r.success,t.outter=a.payload.outter,t.inner=a.payload.inner,t.data=a.payload.data,t.tciLast=a.payload.tci_last,t.pData=a.payload.p_data??[],t.modelSettings=a.payload.model_settings??[],t.equpment===null&&(t.equpment={asset:a.payload.asset_name,elementId:a.payload.assetId,elementType:a.payload.asset_type,substId:a.payload.object_id})})}}),ze=v("getLastValuesSelectedEquipmentQuery/selectedEquipment",async(e,t)=>{e.isTimer||t.dispatch(Ze());const a=t.getState().currentLocale.locale.value,s=await fetch(us(a,e.id)).then(o=>o.json());return t.dispatch(qa({subst_id:s.object_id,name:s.object_name})),{...s,assetId:+e.id}}),Ze=v("resetChartsStatuses/selectedEquipment",async(e,t)=>{console.log("RESET STATUSES CHARTS"),t.dispatch(Ts(r.idle)),t.dispatch(vs(r.idle)),t.dispatch(ws(r.idle)),t.dispatch(Is(r.idle)),t.dispatch($s(r.idle)),t.dispatch(Rs(r.idle)),t.dispatch(Es(r.idle)),t.dispatch(As(r.idle)),t.dispatch(Ms(r.idle)),t.dispatch(Gs(r.idle)),t.dispatch(zs(r.idle)),t.dispatch(Us(r.idle)),t.dispatch(qs(r.idle)),t.dispatch(Js(r.idle)),t.dispatch(Zs(r.idle)),t.dispatch(en(r.idle)),t.dispatch(an(r.idle)),t.dispatch(Wa(r.idle))}),xr=v("selectedEquipment/saveInfoBlocks",async(e,t)=>{const a={outter:t.getState().selectedEquipment.outter,inner:t.getState().selectedEquipment.inner};await fetch(gs(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)})}),on=v("selectedEquipment/DownloadReportFileQuery",async(e,t)=>{try{const a=await t.getState().currentLocale.locale.value,s=new sn;switch(e.placeTheCall){case"diagMessages":s.exportToFile(bs(a,e.id,pt(e.dateStart),pt(e.dateEnd),e.msgType,e.search??"",e.format),a);break;case"passpowrtData":s.exportToFile(ps(a,e.id),a);break;case"modelsSettings":s.exportToFile(hs(a,e.id),a);break}}catch{}}),Sr=e=>e.selectedEquipment.alternativeMeasureUnits,Lr=e=>e.selectedEquipment.gasesMeasureUnit,Tr=e=>e.selectedEquipment.statusLoadingLastValues,Cr=e=>e.selectedEquipment.equpment,vr=e=>e.selectedEquipment.pData,jr=e=>e.selectedEquipment.modelSettings,wr=e=>e.selectedEquipment.data,Dr=e=>e.selectedEquipment.outter,Ir=e=>e.selectedEquipment.inner,kr=e=>e.selectedEquipment.tciLast,{setGasesMeasureUnit:$r,setSelectedEquipment:Pr,setStatusLoadingLastValues:ln,setAlternativeMeasureUnit:Rr,setLastValues:_r,setOutter:Er,setInner:Or}=Yt.actions,Ar=Yt.reducer,rn={codeTab:"",codeSubTab:"",dateStart:Qe(new Date,-165),dateEnd:Qe(new Date,3),diagMsgSignals:""},Jt=j({name:"tabsControllerSlice",initialState:rn,reducers:{setCodeTab:(e,t)=>{e.codeTab=t.payload},setCodeSubTab:(e,t)=>{e.codeSubTab=t.payload},setDateStart:(e,t)=>{e.dateStart=t.payload},setDateEnd:(e,t)=>{e.dateEnd=t.payload},setDiagMsgSignals:(e,t)=>{e.diagMsgSignals=t.payload}}}),Fr=e=>e.tabsController.codeTab,Mr=e=>e.tabsController.codeSubTab,cn=e=>e.tabsController.dateStart,dn=e=>e.tabsController.dateEnd,Br=e=>e.tabsController.diagMsgSignals,{setCodeTab:un,setCodeSubTab:gn,setDateStart:Ne,setDateEnd:ht,setDiagMsgSignals:pn}=Jt.actions,Gr=Jt.reducer;function hn(e,t){p.useLayoutEffect(()=>{if(!e||!t)return;const a=setInterval(()=>{e()},1e3*t);return()=>{console.log("Timer clear"),clearInterval(a)}},[e,t])}const Hr=({value:e,dz:t,pdz:a,borderRadius:s})=>{const i="#99B1C9",u="#3B735A",g="#D36613",m="#D02D1C",b=p.useMemo(()=>{let d=null,f=null,y=null,h=null;return typeof t<"u"&&t!==null&&typeof a<"u"&&a!==null?(f=t/a*70,y=70,d=e<=a?e/a*70:100-30*Math.exp((a-e)/(a*5)),h=e<t?u:e>=t&&e<a?g:m):(typeof t>"u"||t===null)&&typeof a<"u"&&a!==null?(y=70,d=e<=a?e/a*70:100-30*Math.exp((a-e)/(a*5)),h=e<a?u:m):typeof t<"u"&&t!==null&&(typeof a>"u"||a===null)&&(f=70,d=e<=t?e/t*70:100-30*Math.exp((t-e)/(a*5)),h=e<t?u:m),e!=null&&e>=0&&(typeof t>"u"||t===null)&&(typeof a>"u"||a===null)&&(d=50,h=u),{fillBar:d,_dz:f,_pdz:y,colorBar:h}},[t,a,e]);return n.jsxs(c,{sx:{width:"100%",position:"relative"},children:[n.jsxs(c,{sx:{position:"relative",background:i,border:`1px solid ${i}`,borderRadius:`${s}px`??"10px",width:"100%",height:"20px"},children:[n.jsx(c,{sx:{position:"absolute",background:b.colorBar,borderRadius:`${s}px`??"10px",width:`${b.fillBar}%`,height:"20px"}}),n.jsx(c,{sx:{position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",fontSize:"1em",color:"white",zIndex:1e4,textShadow:"1px 2px 5px black",height:"20px"},children:e})]}),b._dz!=null?n.jsx(c,{sx:{position:"absolute",left:`${b._dz}%`,top:"-15%",borderLeft:"2px solid rgba(63, 63, 63, 0.8)",height:"130%"}},M()):null,b._pdz!==null?n.jsx(c,{sx:{position:"absolute",left:`${b._pdz}%`,top:"-15%",borderLeft:"2px solid rgba(63, 63, 63, 0.8)",height:"130%"}},M()):null]})};Date.prototype.addHours=function(e){return this.setTime(this.getTime()+e*60*60*1e3),this};const bt=({getValue:e,label:t,placeHolder:a,dateValue:s,colorLable:o,limitDate:l})=>{const[i,u]=p.useState(window.matchMedia(Z).matches);p.useEffect(()=>{const d=window.matchMedia(Z);return d.addEventListener("change",f=>X(u,f.matches)),()=>d.removeEventListener("change",X)},[]);const g=L(N);p.useEffect(()=>{b(new Date(s))},[s]);const[m,b]=p.useState(s==null?new Date:new Date(s));return n.jsx(be,{styles:{root:{display:"flex",alignItems:"center",width:i?"150px":"",height:i?"35px":""},label:{marginRight:"5px",color:o||"#003274",...P,fontSize:i?"0.8em":"1.2em"},wrapper:{margin:"0 5px"},input:{fontSize:i?"0.7em":"1em"}},maxDate:new Date(l),valueFormat:"DD.MM.YYYY / HH:mm",label:t,placeholder:a,locale:g.value,value:m,dropdownType:"modal",size:"xs",onChange:d=>{var f;b(d),e((f=new Date(d).addHours(3))==null?void 0:f.toISOString().replace("Z","").split(".")[0])}})},bn=()=>{const e=L(es),t=L(N),a=L($),[s,o]=p.useState();return p.useEffect(()=>{if(e!=null&&e!=null){const l=e.map(i=>n.jsxs("tr",{children:[n.jsx("td",{style:{...K,width:"5%",textAlign:"center"},children:i.row}),n.jsx("td",{style:K,children:i.notification}),n.jsx("td",{style:K,children:i.condition})]},M()));o(l)}},[e,a,t]),n.jsxs(qe,{children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{...K,width:"5%",textAlign:"center"},children:"№"}),n.jsx("th",{style:{...K,textAlign:"center"},children:a.notificationLabel}),n.jsx("th",{style:{...K,textAlign:"center"},children:a.conditionLabel})]})}),n.jsx("tbody",{children:s})]})},K={border:"1px solid #003274",...P,...w};Date.prototype.addHours=function(e){return this.setTime(this.getTime()+e*60*60*1e3),this};const fn=({serachFilter:e,sorting:t,pagination:a,idAsset:s,dateStart:o,dateEnd:l,diagType:i,servicesType:u,locale:g})=>{var f,y;const m=i&&u?"all":i&&!u?"diag":!i&&u?"sys":"",b=t.length===0?{fieldOrder:"",typeOrder:""}:{fieldOrder:t[0].id,typeOrder:t[0].desc?"desc":"asc"},d=Ma(g.value,s,(f=new Date(o).addHours(3))==null?void 0:f.toISOString().replace("Z","").split(".")[0],(y=new Date(l).addHours(3))==null?void 0:y.toISOString().replace("Z","").split(".")[0],`${a.pageIndex*a.pageSize}`,`${a.pageSize}`,m,e??"",b.fieldOrder,b.typeOrder);return ha({queryKey:["msg",e,t,a,s,o,l,i,u,g],queryFn:()=>fetch(d).then(h=>h.json()),keepPreviousData:!0,staleTime:3e4})},yn=()=>{const e=Lt(),t=ua(),a=ee(),s=L(N),o=L($),l=L(cn),i=L(dn),[u,g]=p.useState(!1),m=p.useMemo(()=>[{accessorKey:"timestamp",header:o.dateLabel,size:70},{accessorKey:"asset",header:o.assetLabel,size:30},{accessorKey:"message",header:o.msgLabel,Cell:({cell:T})=>{const D=new String(T.getValue()).split(". ").length-1,la=new String(T.getValue()).split(". ").map((Le,ra)=>n.jsxs("span",{children:[Le,D==ra?"":".",n.jsx("br",{})]},M()));return n.jsx("span",{style:{color:ds.find(Le=>Le.title===T.row.original.level).color},children:la})}},{accessorKey:"options",header:o.actionLabel,Cell:()=>n.jsxs(Te,{width:180,position:"left",withArrow:!0,shadow:"md",children:[n.jsx(Te.Target,{children:n.jsx(F,{styles:{root:{background:"transparent",color:"black","&:hover":{background:"transparent",color:"black",transform:"scale(1.5)"}}},children:"•••"})}),n.jsxs(Te.Dropdown,{children:[n.jsxs(F,{styles:{root:{display:"flex",alignItems:"center",width:"100%",...P,marginBottom:"5px",background:"transparent",color:"#003274","&:hover":{background:"#003274",color:"white"}}},onClick:()=>{},children:[n.jsx(ga,{stroke:2}),o.getToWorkLabel]}),n.jsxs(F,{styles:{root:{display:"flex",alignItems:"center",width:"100%",...P,background:"transparent",color:"#003274","&:hover":{background:"#003274",color:"white"}}},onClick:()=>{},children:[n.jsx(pa,{stroke:2}),o.rejectLabel]})]})]}),size:30}],[s,o]);L(Qa);const b=+t.assetid,d=+t.id,[f,y]=p.useState(""),[h,S]=p.useState([{id:"date",desc:!0}]),[x,E]=p.useState({pageIndex:0,pageSize:100}),[I,R]=p.useState(!0),[O,ea]=p.useState(!1),{data:Y,isError:ta,isFetching:aa,isLoading:sa}=fn({serachFilter:f,sorting:h,pagination:x,idAsset:b,dateStart:l,dateEnd:i,diagType:I,servicesType:O,locale:s}),ae=(Y==null?void 0:Y.diag_messages)??[],na=(Y==null?void 0:Y.count_messages)??0,st=(T,D)=>{T=="start"?a(Ne(D)):(new Date(l)>new Date(D)&&a(Ne(D)),a(ht(D))),a(Ze())},oa=We({columns:m,data:(ae==null?void 0:ae.length)>0?ae.map(T=>({timestamp:T.timestamp.replace("T"," ").split(".")[0],asset:T.asset,message:T.message,level:T.level,tab:T.id_tab,equipmentId:T.asset_id,elementType:T.asset_type,signals:T.signals})):ae,localization:o,columnFilterModeOptions:["contains"],initialState:{showColumnFilters:!1},enablePagination:!0,enableColumnActions:!1,enableColumnFilterModes:!1,enableGlobalFilterModes:!0,enableGlobalFilter:!0,enableColumnFilters:!1,enableFullScreenToggle:!0,enableDensityToggle:!1,manualFiltering:!0,manualPagination:!0,manualSorting:!0,onGlobalFilterChange:y,onPaginationChange:E,onSortingChange:S,rowCount:na,state:{serachFilter:f,isLoading:sa,pagination:x,showAlertBanner:ta,showProgressBars:aa,sorting:h},mantinePaperProps:{sx:{width:"100%"}},mantineTableProps:{highlightOnHover:!1,withColumnBorders:!1,sx:{"thead > tr > th":{backgroundColor:"inherit",color:"#003274",...V},"tbody > tr > td":{"&:hover":{cursor:"pointer"}}}},mantineTableBodyCellProps:({cell:T})=>({onClick:D=>{T.column.id!="options"&&(T.column.id==="message"?(console.log(T),a(un(T.row.original.tab)),a(gn("charts")),a(pn(T.row.original.signals)),a(ht(`${new Date(T.row.original.timestamp).addHours(4).toLocaleDateString().split(".").reverse().join("-")}T${new Date(T.row.original.timestamp).addHours(4).toLocaleTimeString()}`)),a(Ne(`${new Date(T.row.original.timestamp).addHours(-4).toLocaleDateString().split(".").reverse().join("-")}T${new Date(T.row.original.timestamp).addHours(-4).toLocaleTimeString()}`)),e(`/substation/${d}/${T.row.original.elementType}/${T.row.original.equipmentId}/charts`)):e(`/substation/${d}/${T.row.original.elementType}/${T.row.original.equipmentId}`))}}),renderTopToolbarCustomActions:({table:T})=>n.jsxs(c,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[n.jsx(it,{label:o.diagnosticsCheckBoxLabel,styles:{label:{...w,...P},root:{margin:"5px"}},defaultChecked:!0,value:I,onChange:D=>R(D.currentTarget.checked)}),n.jsx(it,{label:o.servicesCheckBoxLabel,styles:{label:{...w,...P},root:{margin:"5px"}},value:O,onChange:D=>ea(D.currentTarget.checked)}),n.jsxs(c,{sx:{display:"flex",alignItems:"center",margin:"0 30px"},children:[n.jsx(bt,{label:"От",colorLable:"white",getValue:D=>st("start",D),dateValue:l,limitDate:i}),n.jsx(bt,{label:"До",colorLable:"white",getValue:D=>st("end",D),dateValue:i,limitDate:Date.now()})]}),n.jsxs(c,{sx:{display:"flex"},children:[n.jsx(fe,{label:`${o.expotToLabel} pdf`,color:"#003274",position:"top",withArrow:!0,style:P,children:n.jsxs(c,{sx:ft,onClick:()=>nt("pdf"),children:[n.jsx(Ve,{stroke:2}),n.jsx(c,{sx:{margin:"0 5px",...P},children:"pdf"})]})}),n.jsx(fe,{label:`${o.expotToLabel} excel`,color:"#003274",position:"top",withArrow:!0,style:P,children:n.jsxs(c,{sx:ft,onClick:()=>nt("xls"),children:[n.jsx(Ve,{stroke:2}),n.jsx(c,{sx:{margin:"0 5px",...P},children:"xls"})]})})]})]})}),nt=T=>{let D="";I&&O?D="all":I&&!O?D="diag":!I&&O?D="sys":D="",a(on({placeTheCall:"diagMessages",id:b,dateStart:l,dateEnd:i,msgType:D,search:f,format:T}))};return n.jsxs(c,{sx:{height:"100%",width:"100%",overflowY:"auto",borderTop:"1px solid black"},children:[n.jsx(Ye,{table:oa}),n.jsx(Je,{opened:u,onClose:()=>g(!1),styles:{header:{...V,...w}},title:o.guideNotifications,centered:!0,size:"60%",overlayProps:{color:"black",opacity:.7,blur:5},children:n.jsx(bn,{})})]})},zr=p.memo(({substationId:e})=>n.jsx(yn,{substationId:e})),ft={boxShadow:"2px 2px 2px black",margin:"0 5px",padding:"0 5px",display:"flex",alignItems:"center",...w,border:"1px solid #003274",borderRadius:"8px","&:hover":{transform:"scale(1.05)",cursor:"pointer"},"&:active":{transform:"scale(0.9)"}},Nr=({height:e})=>{const t=L($);return n.jsx(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:`${e}vh`},children:n.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[n.jsx(te,{color:"#003274"}),n.jsx(c,{sx:V,children:t.loadLabel})]})})},mn=()=>{const e=ee(),t=L(ns),a=L(N),[s,o]=p.useState();p.useLayoutEffect(()=>{o(a.value)},[a]);const l=i=>{o(i),localStorage.setItem("locale",JSON.stringify(t.find(u=>u.value===i))),e(os(t.find(u=>u.value===i))),e(pe()),e(ge()),e(ln(r.idle)),e(Ze())};return t?n.jsx(Tt,{data:t,value:s,onChange:i=>l(i),transitionProps:{transition:"pop-top-left",duration:100,timingFunction:"ease"},size:"xs"}):n.jsx(c,{children:"Empty"})},A={height:"20vh",width:"100%"},Q={fontSize:"1.1em",margin:"3% 0",display:"flex"};function W(e,t=null){const[a,s]=p.useState(r.idle),[o,l]=p.useState(t);function i(){s(r.idle)}function u(){a!==r.loading&&(s(r.loading),e().then(g=>{l(g),s(r.success)}).catch(()=>{s(r.error)}))}return{error:a===r.error,success:a===r.success,loading:a===r.loading,default:a===r.idle,data:o,setData:l,resetApiCallStatus:i,apiCaller:u}}const xn=({setIsNexStepAvalible:e,loadParam:t,setLoadParamCb:a})=>{const s=L($),o=W(()=>fetch(Ba()).then(i=>i.json()));p.useEffect(()=>{o.apiCaller()},[]);const l=()=>!!(o.loading||o.data!==null&&o.data.status[0]==="Success");return p.useEffect(()=>{o.data!==null&&o.data.status[0]==="Success"&&(e(!0),a({...t,ip:o.data.ip}))},[o.data]),n.jsxs(c,{sx:{...A,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[n.jsx(c,{children:o.loading?null:o.data!==null?o.data.status[0]==="Error"?n.jsx(c,{children:o.data.status[1].map(i=>n.jsxs(c,{sx:{...Q,color:_.find(u=>u.levelState===2).color},children:[n.jsx(re,{stroke:2,color:_.find(u=>u.levelState===2).color}),n.jsx(c,{children:i})]},M()))}):n.jsxs(c,{sx:{...Q,color:_.find(i=>i.levelState===0).color},children:[n.jsx(Ct,{stroke:2,color:_.find(i=>i.levelState===0).color}),n.jsx(c,{children:s.successLabel})]}):null}),n.jsx(F,{disabled:l(),styles:{root:{background:w.color}},onClick:()=>o.apiCaller(),children:o.loading?n.jsx(c,{children:n.jsx(te,{variant:"dots"})}):n.jsx(c,{children:s.doConnectLabel})})]})},Sn=()=>`${C}/assets`,Ln=(e,t,a,s,o=!1)=>`${C}/signalStats?assetGuid=${e}&signal=${t}&dateStart=${a.toJSON()}&dateEnd=${s.toJSON()}&onlyBad=${o}`,Ur=(e,t,a)=>`${C}/asset/${e}/devicesStats?&dateStart=${t.toJSON()}&dateEnd=${a.toJSON()}`,Tn=()=>`${Oa}/ping`,Cn=e=>`${C}/devices/${e}/connection-params`,Vr=()=>`${C}/protocols`,Kt=[{value:5*6e4,label:"5 мин"},{value:30*6e4,label:"30 мин"},{value:60*6e4,label:"1 ч"},{value:4*60*6e4,label:"4 ч"},{value:6*60*6e4,label:"6 ч"},{value:24*60*6e4,label:"24 ч"}];function Qr(e){if(!e)return[];let t=[];for(let a=0;a<e.length;a++)t.push({value:e[a].asset_guid,label:e[a].asset_name,group:e[a].substation_name});return t}function vn(e){return typeof e=="number"?new Date(e*1e3):e}function jn(e){var a,s,o,l,i;let t={protocol:(a=e.protocol)==null?void 0:a.code,asset:`any_asset_${(s=e.access_point)==null?void 0:s.code}`,address:(o=e.access_point)==null?void 0:o.url,host:(l=e.access_point)==null?void 0:l.ip,port:(i=e.access_point)==null?void 0:i.port};return!t.protocol||!t.host||!t.port?null:t}function wn(e,t){for(let a=0;a<e.length;a++)if(e[a].name===t)return e[a];return null}const xe="filterStatsSliceState";let q=JSON.parse(window.localStorage.getItem(xe)||"null");q=q||{dtStep:Kt[5].value,dt:new Date,onlyBadFlag:!1,selectedDeviceId:null,selectedAssetGuid:null};q.dt=new Date(q.dt);localStorage.setItem(xe,JSON.stringify(q));const le=(e,t)=>{let a=JSON.parse(window.localStorage.getItem(xe)||JSON.stringify(q));a={...a,[e]:t},localStorage.setItem(xe,JSON.stringify(a))},Zt=j({name:"filterStatsSlice",initialState:q,reducers:{setDtStep:(e,t)=>{e.dtStep=t.payload,le("dtStep",t.payload)},setDt:(e,t)=>{e.dt=t.payload,le("dt",t.payload)},setOnlyBadFlag:(e,t)=>{e.onlyBadFlag=t.payload,le("onlyBadFlag",t.payload)},setSelectedDeviceId:(e,t)=>{e.selectedDeviceId=t.payload,le("selectedDeviceId",t.payload)},setSelectedAssetGuid:(e,t)=>{e.selectedAssetGuid=t.payload,le("selectedAssetGuid",t.payload)}}}),Xe=e=>e.filterStats.dtStep,et=e=>e.filterStats.dt,qr=ba([et,Xe],(e,t)=>new Date(new Date(e).getTime()+t)),Dn=e=>e.filterStats.onlyBadFlag,In=e=>e.filterStats.selectedDeviceId,Xt=e=>e.filterStats.selectedAssetGuid,{setDt:Ue,setDtStep:kn,setOnlyBadFlag:Wr,setSelectedDeviceId:$n,setSelectedAssetGuid:Yr}=Zt.actions,Jr=Zt.reducer,Kr=e=>{const t=ee(),a=L(Xt),s=L(N),o=L($)||{},l=L(et),i=L(Xe);function u(g){g<0?t(Ue(new Date(l.getTime()-i))):t(Ue(new Date(l.getTime()+i)))}return n.jsx(n.Fragment,{children:n.jsxs(c,{sx:{display:"flex",alignItems:"center",margin:"20px 0"},children:[n.jsxs(c,{sx:{display:"flex",alignItems:"center",marginRight:"20px"},children:[n.jsx(ct,{variant:"transparent",sx:{border:"1px solid #ced4da",borderRadius:"0.25rem 0 0 0.25rem",height:"36px"},children:n.jsx(fa,{size:"2rem",color:"#ced4da",onClick:()=>u(-1)})}),n.jsx(be,{valueFormat:"DD.MM.YYYY / HH:mm",placeholder:"Выберите дату и время",maw:250,miw:250,locale:s.value,value:l,onChange:g=>t(Ue(g)),sx:{"& button":{borderRadius:0,borderLeft:0,borderRight:0}}}),n.jsx(ct,{variant:"transparent",sx:{border:"1px solid #ced4da",borderRadius:"0 0.25rem 0.25rem 0",height:"36px"},children:n.jsx(ya,{size:"2rem",color:"#ced4da",onClick:()=>u(1)})})]}),n.jsx(Tt,{data:Kt,value:i,onChange:g=>t(kn(g)),maw:100,sx:{marginRight:"20px"}}),n.jsx(F,{variant:"filled",onClick:e.onApplyClick,disabled:a===null,loading:e.deviceStatsApi.loading,sx:{backgroundColor:"#003274"},children:o.applyLabel||"Apply"})]})})};function Pn(e){const[t,a]=p.useState(window.innerWidth),[s,o]=p.useState(window.innerHeight);p.useEffect(()=>(e&&e.current&&e.current.offsetWidth!==null&&(a(e.current.offsetWidth),o(e.current.offsetHeight),window.addEventListener("resize",l)),()=>window.removeEventListener("resize",l)),[e]);const l=()=>{a(e.current.offsetWidth),o(e.current.offsetHeight)};return{width:t,height:s}}const Rn=e=>{const t=L($)||{},[a,s]=p.useState(!1),[o,l]=p.useState(void 0),i=e.assetGuid,u=L(Dn),g=L(et),m=L(Xe),b=[{id:"code",header:t.codeLabel||"Code",accessorFn:x=>x.code!==null?n.jsx(c,{px:2,children:x.code}):null},{id:"name",accessorKey:"name",header:t.nameLabel||"Name",minSize:260},{id:"enabled",header:t.enabledLabel||"Enabled",minSize:10,maxSize:20,mantineTableHeadCellProps:{align:"center"},accessorFn:x=>{if(x.enabled!==void 0&&x.enabled!==null){const E=x.enabled?"YES":"NO",I=x.enabled?"green":"grey";return n.jsx(c,{sx:{color:I,display:"flex",alignItems:"center",padding:"5px 10px",justifyContent:"center"},children:E})}return null}},{id:"last_status",header:t.statusLabel||"Status",minSize:20,maxSize:20,mantineTableHeadCellProps:{align:"center"},accessorFn:x=>{const E=ye();if(x.last_status!==void 0&&x.enabled!==null){let I="grey";return x.success_statuses+x.fail_statuses>0&&(x.last_status?I="green":I=E.colors.red[8]),n.jsx(c,{sx:{color:I,display:"flex",alignItems:"center",padding:"5px 10px",justifyContent:"center"},children:n.jsx(vt,{})})}return null}},{id:"last_message",accessorKey:"last_message",header:t.errorMessageLabel||"Error Message"},{id:"last_datetime",header:t.datetimeLabel||"Datetime",minSize:75,accessorFn:x=>x.last_timestamp?vn(x.last_timestamp):null},{id:"period_stats",header:t.statsLabel||"Statistics",minSize:30,maxSize:60,accessorFn:x=>{const E=ye();if(x.success_statuses!==void 0&&x.success_statuses!==null){let I="black";const R=x.success_statuses+x.fail_statuses;let O=null;return R>0&&(O=Math.round(x.success_statuses/R*1e4)/100,O>=90?I="green":O<50?I=E.colors.red[8]:O<90&&(I="orange")),n.jsxs(c,{sx:{color:I,fontWeight:600},children:[`${x.success_statuses} / ${R}`,O!==null&&` (${O} %)`]})}return null}},{id:"chart_button",header:t.chartLabel||"Chart",minSize:10,maxSize:30,accessorFn:x=>n.jsx(F,{onClick:()=>{s(!0),l(x)},sx:{background:"#003274"},children:n.jsx(ma,{})})}],d=W(()=>fetch(Ln(i,o==null?void 0:o.code,g,new Date(g.getTime()+m),u)).then(x=>x.json()),{});p.useEffect(()=>{a&&d.apiCaller()},[a]);const f=We({columns:b,data:e.signalsStats||[],enableExpanding:!1,enableExpandAll:!1,enableColumnActions:!1,enableColumnFilters:!1,enablePagination:!1,enableSorting:!1,state:{density:"compact",showLoadingOverlay:e.loading,showSkeletons:e.loading,withTableBorder:!0},withTableBorder:!0,enableTopToolbar:!1,enableBottomToolbar:!1,getRowId:x=>x.code,mantineTableHeadProps:({})=>({sx:{border:"1px solid #dddddd"}}),mantineTableBodyCellProps:({row:x})=>({sx:{background:"none",padding:"0 10px",border:"1px solid #dddddd"}}),mantineTableBodyRowProps:({})=>({onClick:()=>{},sx:{cursor:"pointer"}})}),y=p.useRef(null),h=Pn(y),S=p.forwardRef((x,E)=>n.jsxs(Je,{ref:E,opened:a,onClose:()=>{s(!1),d.setData(null)},title:"Считывания сигнала",centered:!0,size:"calc(100vw - 3rem)",overlayProps:{blur:1},sx:{"& .mantine-Modal-inner":{padding:"5dvh 0"}},children:[d.loading&&n.jsx(te,{size:36,sx:{margin:"auto",display:"block"}}),d.success&&d.data&&o&&d.data[o.code]&&(d.data[o.code].x||[]).length>0&&n.jsx(xa,{useResizeHandler:!0,data:[{x:d.data[o.code].x||[],y:d.data[o.code].y||[],text:d.data[o.code].messages||[],mode:"lines+markers",name:"vh",line:{shape:"vh"},type:"scatter"}],layout:{title:`${o.name}, ${o.code}`,width:h.width-100,height:h.height-200,showlegend:!1},config:{...k.GetConfig(),displayModeBar:!1,fluid:!0}}),!d.loading&&o&&d.data&&d.data[o.code]&&(d.data[o.code].x||[]).length===0&&n.jsx(me,{c:"dimmed",sx:{textAlign:"center"},children:t.notDataLabel||"No data"})]}));return n.jsxs(n.Fragment,{children:[n.jsx(S,{}),n.jsx(Ye,{table:f})]})},_n=e=>{const{row:t,deviceId:a}=e;if(!t||!t.protocol||!t.access_point)return n.jsx(me,{children:"No protocol configuration provided"});const[s,o]=p.useState(t.access_point),[l,i]=p.useState(r.idle),u=b=>{o(b),i(r.idle)},g=()=>{i(r.loading);let b={accessPointData:s,protocolId:t.protocol.id};const d={method:"PUT",body:JSON.stringify(b),headers:{"Content-Type":"application/json"}};fetch(Cn(a),d).then(f=>f.json()).then(f=>(i(r.success),dt.show({title:"Изменения сохранены!",color:"green"}),f)).catch(()=>{i(r.error),dt.show({title:"Ошибка!",message:"Не удалось сохранить изменения!",color:"red"})})};let m=null;return t.protocol.code==="modbus_tcp"?m=n.jsx(En,{accessPointData:s,setAccessPointData:u}):t.protocol.code==="modbus_rtu"?m=n.jsx(On,{accessPointData:s,setAccessPointData:u}):t.protocol.code==="mms"?m=n.jsx(An,{accessPointData:s,setAccessPointData:u}):t.protocol.code==="opc"&&(m=n.jsx(Fn,{accessPointData:s,setAccessPointData:u})),m?n.jsxs(c,{sx:{display:"flex",alignItems:"flex-end",justifyContent:"space-between",width:"100%"},children:[m,n.jsx(c,{sx:{display:"flex",alignItems:"center"},children:n.jsx(F,{sx:{minWidth:"100px",background:"#003274",marginRight:10},onClick:()=>g(),loading:l===r.loading,children:"Сохранить"})})]}):n.jsx(me,{children:"No protocol configuration provided"})},En=e=>{const{accessPointData:t,setAccessPointData:a}=e;if(!t)return null;const[s,o]=p.useState(t.url||void 0);return n.jsx(n.Fragment,{children:n.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[n.jsx(tt,{value:t.ip||"",setValue:l=>a({...t,ip:l})}),n.jsx(at,{value:t.port||"",setValue:l=>a({...t,port:l})}),n.jsx(Ke,{min:1,placeholder:"Slave ID",label:"Slave ID",withAsterisk:!0,value:s===void 0?void 0:+s,onChange:l=>{a({...t,url:l}),o(l)},sx:{marginRight:15}})]})})},On=e=>{const{accessPointData:t,setAccessPointData:a}=e;if(!t)return null;const[s,o]=p.useState(t.com_port||""),[l,i]=p.useState(t.parity||void 0),[u,g]=p.useState(t.parity||void 0),[m,b]=p.useState(t.stop_bits||void 0),[d,f]=p.useState(t.data_bits||void 0);return n.jsx(n.Fragment,{children:n.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[n.jsx(jt,{label:"COM port",placeholder:"COM port",value:s,onChange:y=>{a({...t,com_port:y.target.value}),o(y.target.value)},withAsterisk:!0,sx:{marginRight:15}}),n.jsx(Ke,{placeholder:"Baud rate",label:"Baud rate",withAsterisk:!0,value:l===void 0?void 0:+l,onChange:y=>{a({...t,baud_rate:y}),i(y)},sx:{marginRight:15}}),n.jsx(de,{data:[{label:"(E)ven",value:"Even"},{label:"(O)dd",value:"Odd"},{label:"(N)one",value:"None"}],placeholder:"Parity",label:"Parity",withAsterisk:!0,defaultValue:"Even",value:u,onChange:y=>{a({...t,parity:y.target.value}),g(y.target.value)},sx:{marginRight:15}}),n.jsx(de,{data:["0","1","2"],placeholder:"Stop bits",label:"Stop bits",withAsterisk:!0,defaultValue:"1",value:m,onChange:y=>{a({...t,stop_bits:y.target.value}),b(y.target.value)},sx:{marginRight:15}}),n.jsx(de,{data:["7","8"],placeholder:"Byte size",label:"Byte size",withAsterisk:!0,defaultValue:"8",value:d,onChange:y=>{a({...t,data_bits:y.target.value}),f(y.target.value)},sx:{marginRight:15}})]})})},An=e=>{const{accessPointData:t,setAccessPointData:a}=e;return t?n.jsx(n.Fragment,{children:n.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[n.jsx(tt,{value:t.ip||"",setValue:s=>a({...t,ip:s})}),n.jsx(at,{value:t.port||"",setValue:s=>a({...t,port:s})})]})}):null},Fn=e=>{const{accessPointData:t,setAccessPointData:a}=e;return t?n.jsx(n.Fragment,{children:n.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[n.jsx(tt,{value:t.ip||"",setValue:s=>a({...t,ip:s})}),n.jsx(at,{value:t.port||"",setValue:s=>a({...t,port:s})})]})}):null},tt=e=>n.jsx(jt,{label:"IP",placeholder:"IP",value:e.value,onChange:t=>{e.setValue(t.target.value||null)},withAsterisk:!0,sx:{marginRight:15}}),at=e=>n.jsx(Ke,{max:65535,min:1,placeholder:"Port",label:"Port",withAsterisk:!0,value:e.value,onChange:t=>{e.setValue(t||null)},sx:{marginRight:15}}),Mn=5e3,Zr=e=>{const t=ee(),[a,s]=p.useState([]),o=L($)||{},[l,i]=p.useState(null),u=L(Xt),g=L(In),m=[{id:"name",accessorKey:"name",header:o.deviceLabel||"Device",maxSize:100},{id:"enabled",header:o.enabledLabel||"Enabled",minSize:30,maxSize:50,mantineTableHeadCellProps:{align:"center"},accessorFn:d=>{if(d.enabled!==void 0&&d.enabled!==null){const f=d.enabled?"YES":"NO",y=d.enabled?"green":"grey";return n.jsx(c,{sx:{color:y,display:"flex",alignItems:"center",padding:"5px 10px",justifyContent:"center"},children:f})}return null}},{id:"stats",header:o.statsLabel||"Statistics",maxSize:200,accessorFn:d=>{const f=ye();if(d.signals_stats){const y=d.signals_stats.filter(S=>S.last_status).length,h=d.signals_stats.length;return n.jsx(c,{sx:{color:y===h?"green":y===0?f.colors.red[8]:"orange",fontWeight:600},children:`${y} / ${h}`})}return null}},{id:"ping",header:o.pingLabel||"Ping",minSize:15,maxSize:50,mantineTableHeadCellProps:{align:"center"},accessorFn:d=>{const f=ye(),y=d.ping_status===-1||d.ping_status===void 0;if(!d.ping){let h="grey";return d.ping_status===0?h="green":d.ping_status===1&&(h=f.colors.red[8]),n.jsxs(c,{sx:{color:h,background:"none",padding:"1px 10px",display:"flex",alignItems:"center",justifyContent:"center",height:"20px"},children:[!y&&n.jsx(vt,{sx:{margin:"auto"}}),y&&n.jsx(me,{children:"-"})]})}return null}},{id:"protocol",accessorKey:"protocol.name",header:o.protocolLabel||"Protocol",maxSize:150,accessorFn:d=>{var f;return n.jsx(de,{onClick:y=>y.stopPropagation(),data:e.protocolsApi.data.map(y=>y.name),value:((f=d.protocol)==null?void 0:f.name)||"",onChange:y=>{const h=y.target.value;for(let S=0;S<e.deviceStatsApi.data.length;S++)if(d.id===e.deviceStatsApi.data[S].id){const x=wn(e.protocolsApi.data,h);e.deviceStatsApi.data[S].protocol=x,e.deviceStatsApi.setData(()=>[...e.deviceStatsApi.data]);return}}})}},{id:"proto_params",header:o.connectionParams||"Параметры подключения",mantineTableHeadCellProps:{align:"center"},minSize:600,accessorFn:d=>n.jsx(c,{onClick:f=>{f.stopPropagation()},sx:{background:"none",display:"flex",alignItems:"center",padding:"4px 8px"},children:n.jsx(_n,{row:d,deviceId:d.id})})}];p.useEffect(()=>{if(a.length>0){let d=setInterval(()=>{fetch(Tn(),{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then(f=>f.json()).then(f=>{f=f.values;const y=e.deviceStatsApi.data.map(h=>{var S;for(let x=0;x<f.length;x++)((S=h.protocol)==null?void 0:S.code)===f[x].protocol&&h.access_point.ip===f[x].host&&h.access_point.port===f[x].port&&f[x].value?h.ping_status=0:h.ping_status=1;return h});e.deviceStatsApi.setData(y)}).catch(()=>{const f=e.deviceStatsApi.data.map(y=>(y.ping_status=-1,y));e.deviceStatsApi.setData(f)})},Mn);return()=>{clearInterval(d)}}},[a]),p.useEffect(()=>{var d,f,y;if((d=e.deviceStatsApi)!=null&&d.data&&s((f=e.deviceStatsApi)==null?void 0:f.data.map(jn).filter(Boolean)),(y=e.deviceStatsApi)!=null&&y.data&&g){const h=(e.deviceStatsApi.data||[]).find(S=>S.id===g);h&&i(()=>h.signals_stats)}},[e.deviceStatsApi.data]);const b=We({columns:m,data:e.deviceStatsApi.data||[],enableExpanding:!1,enableExpandAll:!1,enableColumnActions:!1,enableColumnFilters:!1,enablePagination:!1,enableSorting:!1,enableTopToolbar:!1,enableBottomToolbar:!1,enableColumnResizing:!0,state:{showLoadingOverlay:e.deviceStatsApi.loading,showSkeletons:e.deviceStatsApi.loading,density:"compact",withTableBorder:!0},withTableBorder:!0,getRowId:d=>d.id,mantineTableBodyCellProps:({row:d})=>({sx:{background:g===d.id?"#e8e8e8":"none",padding:"0 10px",border:"1px solid #dddddd"}}),mantineTableHeadProps:({})=>({sx:{border:"1px solid #dddddd"}}),mantineTableBodyRowProps:({row:d})=>({onClick:()=>{const f=g===d.id?null:d.id;t($n(f)),i(d.original.signals_stats)},sx:{cursor:"pointer"},selected:g===d.id})});return n.jsxs(c,{children:[n.jsx(ut,{order:4,my:10,children:o.devicesLabel||"Devices"}),n.jsx(Ye,{table:b}),g&&n.jsxs(n.Fragment,{children:[n.jsx(ut,{order:5,mt:30,mb:10,children:o.signalsLabel||"Signals"}),n.jsx(Rn,{signalsStats:l,loading:e.deviceStatsApi.loading,assetGuid:u})]})]})},Bn=({setIsNexStepAvalible:e,loadParam:t,setLoadParamCb:a})=>{const s=L($),o=L(N),l=W(()=>fetch(Sn()).then(S=>S.json())),[i,u]=p.useState(null),[g,m]=p.useState(t.dateStart),[b,d]=p.useState(t.dateEnd);p.useEffect(()=>{m(new Date().addHours(-168)),d(new Date().addHours(0)),a({...t,dateStart:new Date().addHours(-168),dateEnd:new Date().addHours(0)}),e(!1),l.apiCaller()},[]),p.useEffect(()=>{t.dateStart!==null&&t.dateEnd!==null&&t.asset!==null&&e(!0)},[t.dateStart,t.dateEnd]);const f=(S,x)=>{u(x),a({...t,asset:S.asset_guid}),e(!0)},y=S=>{m(new Date(S)),a({...t,dateStart:S})},h=S=>{new Date(S)>new Date(g)?(d(new Date(S)),a({...t,dateEnd:S})):(m(new Date(S)),d(new Date(S)),a({...t,dateStart:S,dateEnd:S}))};return n.jsxs(c,{sx:A,children:[n.jsxs(c,{children:[n.jsx(c,{sx:yt,children:s.chooseAssetLabel}),n.jsx(c,{sx:{display:"flex",justifyContent:"space-around",flexWrap:"wrap"},children:l.data!==null?l.data.assets.map((S,x)=>n.jsx(F,{styles:{root:{background:i===x?"RGB(34, 139, 230)":w.color}},onClick:()=>f(S,x),children:S.asset_name??" "},M())):null})]}),n.jsxs(c,{children:[n.jsx(c,{sx:yt,children:s.selectDataRangeLable}),n.jsxs(c,{sx:{width:"100%",display:"flex",justifyContent:"space-around"},children:[n.jsx(be,{label:s.fromLabel,styles:mt,valueFormat:"DD.MM.YYYY / HH:mm:ss",withSeconds:!0,dropdownType:"modal",locale:o.value,maxDate:new Date(b),onChange:S=>y(S),value:g}),n.jsx(be,{label:s.fromLabel,styles:mt,valueFormat:"DD.MM.YYYY / HH:mm:ss",withSeconds:!0,dropdownType:"modal",locale:o.value,maxDate:new Date,onChange:S=>h(S),value:b})]})]})]})},yt={display:"flex",justifyContent:"center",margin:"2% 0",...w,fontSize:"1.1em"},mt={root:{display:"flex",alignItems:"center",width:"50%",height:"35px",justifyContent:"center"},label:{marginRight:"5px",color:"#003274",...P,fontSize:"1em"},wrapper:{margin:"0 5px",width:"50%"},input:{fontSize:"1em"}},Gn=({setIsNexStepAvalible:e,loadParam:t})=>{const a=L($),s=W(()=>fetch(Ga(Qe(t.dateStart,3),t.asset)).then(o=>o.json()));return p.useEffect(()=>{e(!1),s.apiCaller()},[]),p.useEffect(()=>{s.data!==null&&e(s.data.empty_signals.length===0)},[s.data]),s.loading||s.data===null?n.jsx(c,{sx:A,children:n.jsx(te,{variant:"dots"})}):s.error?n.jsx(c,{sx:A,children:a.errorCheckDataLabel}):s.data.empty_signals.length===0?n.jsx(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",...A},children:n.jsxs(c,{sx:{...Q,color:_.find(o=>o.levelState===0).color},children:[n.jsx(Ct,{stroke:2,color:_.find(o=>o.levelState===0).color}),n.jsx(c,{children:a.successLabel})]})}):n.jsxs(c,{sx:{...A,overflowY:"auto"},children:[n.jsx(c,{sx:{...V,...w,color:_.find(o=>o.levelState===2).color},children:a.siganlsMissingLabel}),n.jsxs(qe,{striped:!0,withColumnBorders:!0,children:[n.jsx("thead",{}),n.jsx("tbody",{children:s.data.empty_signals.map(o=>n.jsxs("tr",{children:[n.jsx("td",{children:o[0]}),n.jsx("td",{children:o[1]})]},M()))})]})]})},Hn=({param:e,nextStep:t,setLoadingId:a})=>{const s=L($),o=W(()=>{var l,i;return fetch(Ha((l=new Date(e.dateStart).addHours(3))==null?void 0:l.toISOString().replace("Z","").split(".")[0],(i=new Date(e.dateEnd).addHours(3))==null?void 0:i.toISOString().replace("Z","").split(".")[0],e.asset,e.ip)).then(u=>u.json())});return p.useEffect(()=>{o.apiCaller()},[]),p.useEffect(()=>{o.success&&o.data.status[0].toLowerCase()==="success"&&(a(o.data.loaded_data_id),t())},[o.loading]),o.loading?n.jsxs(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",...A},children:[n.jsx(c,{sx:{...Q,margin:"0",...w,...P},children:s.dataCollectLabel}),n.jsx(c,{children:n.jsx(te,{variant:"dots"})})]}):n.jsx(c,{sx:{display:"flex",justifyContent:"center",...A},children:o.data!==null&&o.data.status[0].toLowerCase()==="error"?o.data.status[1].map(l=>n.jsxs(c,{sx:{...Q,color:_.find(i=>i.levelState===2).color},children:[n.jsx(re,{stroke:2,color:_.find(i=>i.levelState===2).color}),n.jsx(c,{children:l})]},M())):null})},zn=({loadingId:e,nextStep:t})=>{const a=L($),s=W(()=>fetch(Na(e)).then(o=>o.json()));return p.useEffect(()=>{s.apiCaller()},[]),p.useEffect(()=>{s.data!==null&&s.data.loaded_data!==null&&s.data.loaded_data.percent_processed===100&&t()},[s]),hn(()=>{s.apiCaller()},1),s.data===null?n.jsx(c,{sx:A,children:n.jsx(te,{variant:"dots"})}):s.data.status[0].toLowerCase()==="error"?n.jsx(c,{sx:{...A},children:s.data.status[1].map(o=>n.jsxs(c,{sx:{...Q,color:_.find(l=>l.levelState===2).color},children:[n.jsx(re,{stroke:2,color:_.find(l=>l.levelState===2).color}),n.jsx(c,{children:o})]},nanoid()))}):n.jsxs(c,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",...A},children:[n.jsx(c,{sx:{...P,...w},children:a.diagnosticCalculateLabel}),n.jsx(c,{sx:{width:"80%"},children:n.jsx(Sa,{label:s.data.loaded_data.percent_processed+"%",size:"xl",radius:"xl",value:s.data.loaded_data.percent_processed})})]})},Nn=()=>{const e=L($),[t,a]=p.useState({dateStart:null,dateEnd:null,ip:null,asset:null}),[s,o]=p.useState(null),[l,i]=p.useState(!1),[u,g]=p.useState(0),m=()=>g(d=>d<5?d+1:d),b=()=>g(d=>d>0?d-1:d);return p.useEffect(()=>{s!==null&&getIdLoading(s)},[]),n.jsxs(c,{sx:{height:"100%",width:"100%"},children:[n.jsxs(U,{color:w.color,active:u,onStepClick:g,breakpoint:"sm",allowNextStepsSelect:!1,children:[n.jsx(U.Step,{label:`${e.stepLabel} 1`,description:`${e.connectLabel}`,icon:n.jsx(La,{stroke:2}),children:n.jsx(xn,{setIsNexStepAvalible:i,loadParam:t,setLoadParamCb:a})}),n.jsx(U.Step,{label:`${e.stepLabel} 2`,description:`${e.loadParamsLabel}`,icon:n.jsx(Ta,{stroke:2}),children:n.jsx(Bn,{setIsNexStepAvalible:i,loadParam:t,setLoadParamCb:a})}),n.jsx(U.Step,{label:`${e.stepLabel} 3`,description:`${e.validationLabel}`,icon:n.jsx(Ca,{stroke:2}),children:n.jsx(Gn,{setIsNexStepAvalible:i,loadParam:t})}),n.jsx(U.Step,{label:`${e.stepLabel} 4`,description:`${e.dataCollectLabel}`,icon:n.jsx(gt,{stroke:2}),children:n.jsx(Hn,{param:t,nextStep:m,setLoadingId:o})}),n.jsx(U.Step,{label:`${e.stepLabel} 5`,description:`${e.diagosticLabel}`,icon:n.jsx(gt,{stroke:2}),children:n.jsx(zn,{loadingId:s,nextStep:m})}),n.jsx(U.Completed,{children:n.jsx(c,{sx:{...A,...P,...w,display:"flex",justifyContent:"center",alignItems:"center"},children:e.diagProcessComplieate})})]}),n.jsxs(va,{position:"center",mt:"xl",display:u>=3?"none":"flex",children:[n.jsx(F,{disabled:u===0,variant:"default",onClick:b,children:e.backLabel}),n.jsx(F,{disabled:!l||u===3||u===4,styles:{root:{background:w.color}},onClick:m,children:e.nextLabel})]})]})},Un=[{status:1,name:"Загружены в шину",translateLabel:"loadedToMessagingBusesLabel",color:{from:"rgba(34, 139, 230, 0.8)",to:"rgba(88, 139, 230, 0.8)"},hasTranslate:!0},{status:2,name:"В обработке",translateLabel:"inProcessLabel",color:{from:"rgba(34, 139, 230, 0.8)",to:"rgba(88, 139, 230, 0.8)"},hasTranslate:!1},{status:3,name:"Обработаны",translateLabel:"processedLabel",color:{from:"RGB(71, 193, 108)",to:"rgba(139, 193, 108, 0.8)"},hasTranslate:!0},{status:4,name:"Нет данных",translateLabel:"notDataLabel",color:{from:"rgba(255, 118, 85, 0.8)",to:"rgba(255, 121, 87, 0.8)"},hasTranslate:!0},{status:5,name:"Ошибка при обработке",translateLabel:"errorOnTheProcessedLabel",color:{from:"rgba(255, 118, 85, 0.8)",to:"rgba(255, 121, 87, 0.8)"},hasTranslate:!0}],Vn=({tab:e})=>{const t=L($),a=W(()=>fetch(za()).then(o=>o.json()));let s=null;return p.useEffect(()=>(e==="history"&&(a.apiCaller(),s=setInterval(()=>a.apiCaller(),1e3)),()=>{s!==null&&clearInterval(s)}),[e]),a.error?n.jsx(c,{sx:{display:"flex",justifyContent:"center"},children:n.jsxs(c,{sx:{display:"flex",justifyContent:"center"},children:[n.jsx(re,{stroke:2,color:_.find(o=>o.levelState===2).color}),n.jsx(c,{children:t.unsuccessLabel})]})}):a.data===null?null:a.data!==null&&a.data.status[0].toLowerCase()==="error"?n.jsx(c,{children:laser.data.status[1].map(o=>n.jsxs(c,{sx:{...Q,color:_.find(l=>l.levelState===2).color},children:[n.jsx(re,{stroke:2,color:_.find(l=>l.levelState===2).color}),n.jsx(c,{children:o})]},M()))}):n.jsx(c,{sx:{width:"100%",height:"35vh",overflowY:"auto"},children:n.jsxs(qe,{children:[n.jsx("thead",{}),n.jsx("tbody",{children:a.data.loading.map(o=>{const l=Un.find(i=>i.status===o.status);return l.status===2&&(l.name=o.percent_processed+" %"),n.jsxs("tr",{style:{...w,...P},children:[n.jsx("td",{children:o.asset_name}),n.jsx("td",{children:o.date_start}),n.jsx("td",{children:o.date_end}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx(ja,{variant:"gradient",gradient:l.color,styles:{root:{maxWidth:"70%",width:"70%"}},children:l.hasTranslate?t[l.translateLabel]:l.name})})]},M())})})]})})},Qn=({isOpen:e,close:t})=>{const a=L($),[s,o]=p.useState("dataLoad");return n.jsx(Je,{opened:e,onClose:()=>t(!1),styles:{header:{...V,...w}},title:a.loadDataLabel,centered:!0,size:"70%",overlayProps:{color:"black",opacity:.8,blur:5},children:n.jsx(c,{sx:{width:"100%"},children:n.jsxs(J,{defaultValue:"gallery",styles:{tabLabel:{...w}},value:s,onTabChange:o,children:[n.jsxs(J.List,{children:[n.jsx(J.Tab,{value:"dataLoad",icon:n.jsx(wa,{stroke:2,color:w.color}),children:a.loadDataLabel}),n.jsx(J.Tab,{value:"history",icon:n.jsx(Da,{stroke:2,color:w.color}),children:a.historyLabel})]}),n.jsx(J.Panel,{value:"dataLoad",pt:"xs",children:n.jsx(Nn,{})}),n.jsx(J.Panel,{value:"history",pt:"xs",children:n.jsx(Vn,{tab:s})})]})})})},qn=()=>{const[e,t]=p.useState(window.matchMedia(Z).matches);p.useEffect(()=>{const u=window.matchMedia(Z);return u.addEventListener("change",g=>X(t,g.matches)),()=>u.removeEventListener("change",X)},[]);const a=Ia("(min-width:800px) and (max-width:1367px)");Lt(),ee();const s=L(N);p.useState(!1);const[o,l]=p.useState(!1),i=L($);if(p.useEffect(()=>{},[s]),i)return n.jsxs(c,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",color:"#003274",justifyContent:"space-between"},children:[n.jsx(he,{to:"/",style:{marginLeft:"1%",color:"#003274",textDecoration:"none",...V,fontSize:a?"1em":"1.5em"},children:i.headerLabelText}),n.jsxs(c,{sx:{display:"flex",marginRight:"1%"},children:[n.jsxs(F,{styles:{root:{background:w.color}},onClick:()=>l(!0),children:[n.jsx(Ve,{stroke:2}),n.jsx(c,{sx:{margin:"0 5px"},children:i.doLoadDataLabel})]}),n.jsx(c,{sx:xt,children:n.jsx("a",{href:`${Aa}`,target:"_blank",children:n.jsx(fe,{label:i.administrationToolTipText,withArrow:!0,styles:St,children:n.jsx(c,{sx:ce,children:n.jsx(ka,{stroke:2,color:w.color,style:ce})})})})}),n.jsx(c,{sx:xt,children:n.jsx(he,{to:"/about",children:n.jsx(fe,{label:i.aboutToolTipText,withArrow:!0,styles:St,children:n.jsx(c,{sx:ce,children:n.jsx($a,{stroke:2,color:w.color,style:ce})})})})}),n.jsx(mn,{})]}),n.jsx(Qn,{isOpen:o,close:l})]})},xt={margin:"0 10px",display:"flex",alignItems:"center"},St={tooltip:{background:"#003274",color:"white",...P}},ce={display:"flex",alignItems:"center","&:hover":{transform:"scale(1.2)"},"&:active":{transform:"scale(0.9)"}},Wn={background:"transparent",height:"100%"},Yn={height:"7%",borderBottom:"1px solid black"},Jn={borderBottom:"1px solid black",boxShadow:"2px 2px 2px gray",paddingLeft:"1%",height:"3%",display:"flex",alignItems:"center",justifyContent:"space-between"},Kn=()=>{const e=L(N),{pathname:t}=Pa(),[a,s]=p.useState([]),o=L($);return p.useLayoutEffect(()=>{if(o){const l=[o.mainNavLabel,o.substNavLabel,o.assetNavLabel,o.chartsNavLabel];if(e){const i=[];if(t.length===1)i.push({title:"Главная",href:"/"});else{const g=t.split("/").filter(m=>m!=="");for(let m=0;m<g.length;m++)if(m===0&&i.length===0)i.push({title:"Главная",href:"/"}),m=-1;else if(Number.isInteger(parseInt(g[m])))i[i.length-1].href=`${i[i.length-1].href}/${g[m]}`;else{const b=`/${i[i.length-1].href}/${g[m]}`.split("/").filter(d=>d!=="").join("/");i.push({title:"tmp mock",href:i[i.length-1].href==="/"?`/${g[m]}`:`/${b}`})}}i.forEach((g,m)=>{g.title=g.href==="/about"?o.aboutToolTipText:l[m]});const u=i.map((g,m)=>n.jsx(he,{style:{...V,color:"#003274",textDecoration:"none",marginLeft:m>0?"1%":""},to:g.href,children:n.jsxs(c,{sx:{display:"flex",alignItems:"center","&:hover":{transform:"scale(1.05)",transition:"transform 0.2s ease-in-out"},"&:active":{transform:"scale(0.95)",transition:"transform 0.2s ease-in-out"}},children:[g.title," ",i[m+1]?n.jsx(Ra,{stroke:2}):""]})},M()));s(u)}}},[e,t,o]),n.jsx(n.Fragment,{children:a})},Xr=()=>(L($),n.jsxs(c,{sx:Wn,children:[n.jsx(c,{sx:Yn,children:n.jsx(qn,{})}),n.jsxs(c,{sx:Jn,children:[n.jsx(c,{sx:{display:"flex",alignItems:"center",width:"80%"},children:n.jsx(Kn,{})}),!1]}),n.jsx(c,{sx:{height:"calc(90% - 2px)",width:"100%"},children:n.jsx(_a,{})})]}));export{Tr as $,Lr as A,fo as B,To as C,on as D,Cr as E,P as F,$ as G,kr as H,ds as I,eo as J,Rr as K,r as L,bo as M,Sr as N,Hr as O,oe as P,Vs as Q,Ws as R,ho as S,w as T,Ir as U,_ as V,Or as W,Dr as X,wr as Y,xr as Z,Er as _,xo as a,Lo as a$,ze as a0,zr as a1,Fr as a2,Mr as a3,Br as a4,cn as a5,dn as a6,C as a7,bt as a8,je as a9,Ms as aA,Rs as aB,en as aC,Do as aD,Io as aE,vo as aF,Co as aG,wo as aH,jo as aI,Nr as aJ,ko as aK,$o as aL,Ss as aM,Ls as aN,Po as aO,Yl as aP,ql as aQ,Wl as aR,Vl as aS,Nl as aT,Ul as aU,Fo as aV,Ao as aW,De as aX,Eo as aY,_o as aZ,we as a_,Oe as aa,Ee as ab,Re as ac,He as ad,Be as ae,ke as af,Me as ag,Fe as ah,Pe as ai,Ie as aj,Ae as ak,_e as al,$e as am,Ge as an,Ts as ao,Js as ap,qs as aq,Gs as ar,zs as as,As as at,an as au,Zs as av,$s as aw,Es as ax,Is as ay,Us as az,Pr as b,fr as b$,ul as b0,gl as b1,pl as b2,hl as b3,bl as b4,dl as b5,cl as b6,fl as b7,yl as b8,_l as b9,rl as bA,Ll as bB,Sl as bC,xl as bD,Tl as bE,Cl as bF,Xo as bG,Zo as bH,Ko as bI,el as bJ,tl as bK,tr as bL,ar as bM,sr as bN,er as bO,Xl as bP,Zl as bQ,nr as bR,or as bS,cr as bT,ir as bU,rr as bV,dr as bW,ur as bX,br as bY,hr as bZ,pr as b_,Rl as ba,Pl as bb,El as bc,Ol as bd,Dl as be,wl as bf,jl as bg,qo as bh,Qo as bi,Vo as bj,Wo as bk,Yo as bl,Bl as bm,Ml as bn,Fl as bo,Gl as bp,Hl as bq,Ho as br,Go as bs,Bo as bt,zo as bu,No as bv,ol as bw,nl as bx,sl as by,ll as bz,qa as c,yr as c0,co as c1,Qa as c2,to as c3,Ce as c4,Xt as c5,et as c6,qr as c7,W as c8,vn as c9,vl as cA,al as cB,$l as cC,lr as cD,gr as cE,mr as cF,Jr as cG,mo as cH,pe as cI,ve as cJ,Pn as ca,Vr as cb,Ur as cc,Wn as cd,Qr as ce,Kr as cf,Zr as cg,Sn as ch,Yr as ci,$n as cj,Xr as ck,so as cl,Ar as cm,po as cn,Ro as co,Gr as cp,Al as cq,ml as cr,Jo as cs,Oo as ct,Mo as cu,Kl as cv,Ql as cw,il as cx,Uo as cy,zl as cz,ls as d,un as e,X as f,io as g,gn as h,pn as i,ht as j,Ne as k,lo as l,N as m,V as n,ro as o,So as p,k as q,oo as r,Z as s,yo as t,hn as u,ge as v,rs as w,no as x,vr as y,jr as z};
